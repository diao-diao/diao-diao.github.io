<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>51nd0re1</title>
  
  <subtitle>我是一只web狗</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2021-03-10T11:37:08.443Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>51nd0re1</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Ajax-2021/3/9</title>
    <link href="http://yoursite.com/2021/03/09/Ajax-2021-3-9/"/>
    <id>http://yoursite.com/2021/03/09/Ajax-2021-3-9/</id>
    <published>2021-03-09T13:26:36.000Z</published>
    <updated>2021-03-10T11:37:08.443Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h1><p>Ajax是一种无需重新加载整个网页的情况下，能够更新部分网页的技术</p><p>增加B/S的体验性<br>B/S：未来的主流，并且会爆发式的持续增长；</p><p>产品链：H5+网页+客户端+手机端(Android，IOS)+小程序</p><h2 id="伪Ajax"><a href="#伪Ajax" class="headerlink" title="伪Ajax"></a>伪Ajax</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>伪造Ajax<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"application/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> myDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"currentTime"</span>).innerText = myDate.getTime();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">loadPage</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> targetURL = <span class="built_in">document</span>.getElementById(<span class="string">"url"</span>).value;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(targetURL);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"iframePosition"</span>).src = targetURL;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>请输入要加载的地址：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"currentTime"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> <span class="attr">onclick</span>=<span class="string">"loadPage()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">        加载页面的位置:</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">"width:1000px;height: 500px"</span> <span class="attr">id</span>=<span class="string">"iframePosition"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过这样一个html  可以实现一个伪Ajax</p><p>网页没有刷新 只需要提交不同的url 就可以显示页面</p><p><del>虚假的Ajax</del></p><h2 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h2><p>ajax需要导入jQuery</p><p>ajax基本参数：</p><ul><li><p>url   待载入页面的URL地址</p></li><li><p>data   待发送key/value参数</p></li><li><p>success   载入成功时回调函数</p></li><li><p>dataType   返回内容格式 xml,json,scrpt,text,html</p></li></ul><p>首先需要写一个AjaxController<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line">@<span class="type">Controller</span></span><br><span class="line">@<span class="type">RequestMapping</span>(<span class="string">"/ajax"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AjaxController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//第一种方式，服务器返回一个字符串，直接使用response</span></span><br><span class="line">    @<span class="type">RequestMapping</span>(<span class="string">"/a1"</span>)</span><br><span class="line">    <span class="keyword">public</span> void ajax(<span class="type">String</span> name, <span class="type">HttpServletResponse</span> httpServletResponse) <span class="keyword">throws</span> <span class="type">IOException</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"admin"</span>.equals(name))&#123;</span><br><span class="line">            httpServletResponse.getWriter().<span class="built_in">println</span>(<span class="string">"ture"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            httpServletResponse.getWriter().<span class="built_in">println</span>(<span class="string">"false"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>再编写对应的前端界面ajax.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">  Created by IntelliJ IDEA.</span></span><br><span class="line"><span class="ruby">  <span class="symbol">User:</span> songf</span></span><br><span class="line"><span class="ruby">  <span class="symbol">Date:</span> <span class="number">2021</span>/<span class="number">3</span>/<span class="number">9</span></span></span><br><span class="line"><span class="ruby">  <span class="symbol">Time:</span> <span class="number">22</span><span class="symbol">:</span><span class="number">32</span></span></span><br><span class="line"><span class="ruby">  To change this template use File <span class="params">| Settings |</span> File Templates.</span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Ajax<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-    需要导入jQuery-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/static/js/jquery-3.6.0.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"application/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    function a1()&#123;</span></span><br><span class="line"><span class="xml">        //ajax默认是GET请求</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-$.ajax(&#123;-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-    <span class="symbol">url:</span><span class="string">"$&#123;pageContext.request.contextPath&#125;/ajax/a1"</span>,-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-    <span class="symbol">data:</span>&#123;<span class="string">"name"</span><span class="symbol">:</span>$(<span class="string">"#txtName"</span>).val()&#125;,-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-    <span class="symbol">success:</span>function (data,status) &#123;-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-        alert(data);-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-        alert(status);-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-    &#125;-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-&#125;);-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">        // ajax post请求</span></span><br><span class="line"><span class="xml">        $.post(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;pageContext.request.contextPath&#125;/ajax/a1",</span></span><br><span class="line"><span class="xml">            data:&#123;"name":$("#txtName").val()&#125;,</span></span><br><span class="line"><span class="xml">            success:function (data,status) &#123;</span></span><br><span class="line"><span class="xml">                alert(data);</span></span><br><span class="line"><span class="xml">                alert(status);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //将文本框输入的值</span></span><br><span class="line"><span class="xml">        //发给服务器</span></span><br><span class="line"><span class="xml">        //接收服务器返回的数据</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-失去焦点产生事件-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">用户名:</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"txtName"</span> <span class="attr">onblur</span>=<span class="string">"a1()"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">鼠标移上去 失去焦点后  产生事件 弹出<span class="literal">false</span> 紧跟着弹出success</span><br><span class="line"></span><br><span class="line">输入<span class="literal">admin</span> 鼠标失去焦点后  产生事件  弹出ture 紧跟着弹出success</span><br></pre></td></tr></table></figure></p><p>还可以实现一个表格的ajax更新<br>修改Controller<br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.pojo.<span class="keyword">User</span>;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping("/ajax")</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> AjaxController &#123;</span><br><span class="line">    //第一种方式，服务器返回一个字符串，直接使用response</span><br><span class="line">    @RequestMapping("/a1")</span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> ajax(String <span class="type">name</span>, HttpServletResponse httpServletResponse) throws IOException &#123;</span><br><span class="line">        <span class="keyword">if</span>("admin".equals(<span class="type">name</span>))&#123;</span><br><span class="line">            httpServletResponse.getWriter().println("ture");</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            httpServletResponse.getWriter().println("false");</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping("/a2")</span><br><span class="line">    @ResponseBody</span><br><span class="line">    <span class="built_in">public</span> List&lt;<span class="keyword">User</span>&gt; ajax2()&#123;</span><br><span class="line">        ArrayList&lt;<span class="keyword">User</span>&gt; list = <span class="built_in">new</span> ArrayList&lt;<span class="keyword">User</span>&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">User</span> user1 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔1",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user2 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔2",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user3 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔3",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user4 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔4",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user5 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔5",<span class="number">3</span>,"男");</span><br><span class="line"></span><br><span class="line">        list.<span class="keyword">add</span>(user1);</span><br><span class="line">        list.<span class="keyword">add</span>(user2);</span><br><span class="line">        list.<span class="keyword">add</span>(user3);</span><br><span class="line">        list.<span class="keyword">add</span>(user4);</span><br><span class="line">        list.<span class="keyword">add</span>(user5);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list; //由于加了@ResponseBody 他会返回一个字符串</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>对应的ajax2.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">  Created by IntelliJ IDEA.</span></span><br><span class="line"><span class="ruby">  <span class="symbol">User:</span> songf</span></span><br><span class="line"><span class="ruby">  <span class="symbol">Date:</span> <span class="number">2021</span>/<span class="number">3</span>/<span class="number">9</span></span></span><br><span class="line"><span class="ruby">  <span class="symbol">Time:</span> <span class="number">23</span><span class="symbol">:</span><span class="number">05</span></span></span><br><span class="line"><span class="ruby">  To change this template use File <span class="params">| Settings |</span> File Templates.</span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">value</span>=<span class="string">"获取数据"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"80%"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/static/js/jquery-3.6.0.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">        $(function ()&#123;</span></span><br><span class="line"><span class="xml">           $("#btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">               $.post("$&#123;pageContext.request.contextPath&#125;/ajax/a2",function (data) &#123;</span></span><br><span class="line"><span class="xml">                   console.log(data);</span></span><br><span class="line"><span class="xml">                   var html = ""</span></span><br><span class="line"><span class="xml">                   for(var i=0;i<span class="tag">&lt;<span class="name">data.length;i++)&#123;</span></span></span></span><br><span class="line"><span class="xml">                       html += "<span class="tag">&lt;<span class="name">tr</span>&gt;</span>" +</span></span><br><span class="line"><span class="xml">                       "<span class="tag">&lt;<span class="name">td</span>&gt;</span>"+data[i].name+"<span class="tag">&lt;/<span class="name">td</span>&gt;</span>"+</span></span><br><span class="line"><span class="xml">                       "<span class="tag">&lt;<span class="name">td</span>&gt;</span>"+data[i].age+"<span class="tag">&lt;/<span class="name">td</span>&gt;</span>"+</span></span><br><span class="line"><span class="xml">                       "<span class="tag">&lt;<span class="name">td</span>&gt;</span>"+data[i].sex+"<span class="tag">&lt;/<span class="name">td</span>&gt;</span>"+</span></span><br><span class="line"><span class="xml">                       "<span class="tag">&lt;/<span class="name">tr</span>&gt;</span>"</span></span><br><span class="line"><span class="xml">                   &#125;</span></span><br><span class="line"><span class="xml">                   $("#content").html(html);</span></span><br><span class="line"><span class="xml">               &#125;)</span></span><br><span class="line"><span class="xml">           &#125;)</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>点击获取数据后，对应的地方会更新数据，这个地方由于是举例，没有使用数据库，所以修改的时候比较麻烦，如果连接数据库，数据库中对应的数据更新时，ajax2.jsp中对应的值也会跟着改变而不用刷新界面</p><p>还有常见的验证用户名和密码的操作<br>修改Controller<br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.pojo.<span class="keyword">User</span>;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping("/ajax")</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> AjaxController &#123;</span><br><span class="line">    //第一种方式，服务器返回一个字符串，直接使用response</span><br><span class="line">    @RequestMapping("/a1")</span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> ajax(String <span class="type">name</span>, HttpServletResponse httpServletResponse) throws IOException &#123;</span><br><span class="line">        <span class="keyword">if</span>("admin".equals(<span class="type">name</span>))&#123;</span><br><span class="line">            httpServletResponse.getWriter().println("ture");</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            httpServletResponse.getWriter().println("false");</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping("/a2")</span><br><span class="line">    @ResponseBody</span><br><span class="line">    <span class="built_in">public</span> List&lt;<span class="keyword">User</span>&gt; ajax2()&#123;</span><br><span class="line">        ArrayList&lt;<span class="keyword">User</span>&gt; list = <span class="built_in">new</span> ArrayList&lt;<span class="keyword">User</span>&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">User</span> user1 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔1",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user2 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔2",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user3 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔3",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user4 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔4",<span class="number">3</span>,"男");</span><br><span class="line">        <span class="keyword">User</span> user5 = <span class="built_in">new</span> <span class="keyword">User</span>("弔弔5",<span class="number">3</span>,"男");</span><br><span class="line"></span><br><span class="line">        list.<span class="keyword">add</span>(user1);</span><br><span class="line">        list.<span class="keyword">add</span>(user2);</span><br><span class="line">        list.<span class="keyword">add</span>(user3);</span><br><span class="line">        list.<span class="keyword">add</span>(user4);</span><br><span class="line">        list.<span class="keyword">add</span>(user5);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list; //由于加了@ResponseBody 他会返回一个字符串</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping("/a3")</span><br><span class="line">    @ResponseBody</span><br><span class="line">    <span class="built_in">public</span> String ajax3(String <span class="type">name</span>,String pwd)&#123;</span><br><span class="line">        String msg = "";</span><br><span class="line">        <span class="keyword">if</span>(<span class="type">name</span>!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>("admin".equals(<span class="type">name</span>))&#123;</span><br><span class="line">                msg = "ok";</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                msg = "用户名有误";</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(pwd!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>("123456".equals(pwd))&#123;</span><br><span class="line">                msg = "ok";</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                msg = "密码有误";</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>对应的ajax3.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">  Created by IntelliJ IDEA.</span></span><br><span class="line"><span class="ruby">  <span class="symbol">User:</span> songf</span></span><br><span class="line"><span class="ruby">  <span class="symbol">Date:</span> <span class="number">2021</span>/<span class="number">3</span>/<span class="number">10</span></span></span><br><span class="line"><span class="ruby">  <span class="symbol">Time:</span> <span class="number">19</span><span class="symbol">:</span><span class="number">17</span></span></span><br><span class="line"><span class="ruby">  To change this template use File <span class="params">| Settings |</span> File Templates.</span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/static/js/jquery-3.6.0.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">        function a1() &#123;</span></span><br><span class="line"><span class="xml">            $.post(&#123;</span></span><br><span class="line"><span class="xml">                url:"$&#123;pageContext.request.contextPath&#125;/ajax/a3",</span></span><br><span class="line"><span class="xml">                data:&#123;"name":$("#name").val()&#125;,</span></span><br><span class="line"><span class="xml">                success:function (data) &#123;</span></span><br><span class="line"><span class="xml">                    if(data.toString()=="ok")&#123; //信息核对成功</span></span><br><span class="line"><span class="xml">                        $('#userInfo').css("color","green");</span></span><br><span class="line"><span class="xml">                    &#125;else&#123;</span></span><br><span class="line"><span class="xml">                        $('#userInfo').css("color","red");</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    $("#userInfo").html(data)</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;)</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        function a2() &#123;</span></span><br><span class="line"><span class="xml">            $.post("$&#123;pageContext.request.contextPath&#125;/ajax/a3",&#123;"pwd":$("#pwd").val()&#125;,function (data) &#123;</span></span><br><span class="line"><span class="xml">                if(data.toString()=="ok")&#123; //信息核对成功</span></span><br><span class="line"><span class="xml">                    $('#pwdInfo').css("color","green");</span></span><br><span class="line"><span class="xml">                &#125;else&#123;</span></span><br><span class="line"><span class="xml">                    $('#pwdInfo').css("color","red");</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">                $("#pwdInfo").html(data)</span></span><br><span class="line"><span class="xml">            &#125;)</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">    用户名:</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">onblur</span>=<span class="string">"a1()"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"userInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">    密码:</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"pwd"</span> <span class="attr">onblur</span>=<span class="string">"a2()"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"pwdInfo"</span> &gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>输入账号不为admin时 会显示用户名错误 为admin时 页面不用刷新 会显示ok<br>密码同理</p><p><a href="/download/Ajax.zip">源码下载</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Ajax&quot;&gt;&lt;a href=&quot;#Ajax&quot; class=&quot;headerlink&quot; title=&quot;Ajax&quot;&gt;&lt;/a&gt;Ajax&lt;/h1&gt;&lt;p&gt;Ajax是一种无需重新加载整个网页的情况下，能够更新部分网页的技术&lt;/p&gt;
&lt;p&gt;增加B/S的体验性&lt;br&gt;B/S：未来的主
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>JSON-2021/3/9</title>
    <link href="http://yoursite.com/2021/03/09/JSON-2021-3-9/"/>
    <id>http://yoursite.com/2021/03/09/JSON-2021-3-9/</id>
    <published>2021-03-09T01:42:35.000Z</published>
    <updated>2021-03-09T10:58:54.086Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><h2 id="Web-1-0-时代"><a href="#Web-1-0-时代" class="headerlink" title="Web 1.0 时代"></a>Web 1.0 时代</h2><p>早期网站，登录，如果失败，需要刷新页面，才能重新登录；不点击提交按钮，就不知道自己密码输错了</p><p>现在大多数的网站，都是局部刷新，不刷新整个页面的情况下，实现页面更新</p><p>注册的时候，发现手机号已经注册过了，但是你只是输入了，没有提交，然后他就提示了手机号已存在</p><h2 id="Web-2-0-时代"><a href="#Web-2-0-时代" class="headerlink" title="Web 2.0 时代"></a>Web 2.0 时代</h2><p>最重要的一个因素就是Ajax</p><h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><p>JSON是一种轻量级的数据交换格式，目前使用极其广泛</p><p>在JS语言中，一切都是对象，因此，任何JS支持的类型都可以通过JSON来表示，例如字符串，数字，对象，数组等。语法格式要求：</p><ul><li>对象表示为键值对</li><li>数据由逗号分隔</li><li>花括号保存对象</li><li>方括号保存数组</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"name"</span>:<span class="string">"QinJiang"</span>&#125;</span><br><span class="line">&#123;<span class="attr">"age"</span>:<span class="string">"3"</span>&#125;</span><br><span class="line">&#123;<span class="attr">"sex"</span>:<span class="string">"男"</span>&#125;</span><br></pre></td></tr></table></figure><p>JSON是JS对象的字符串表示法，它使用文本表示一个JS对象的信息，本质是一个字符串<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;a:<span class="string">'hello'</span>,b:<span class="string">'world'</span>&#125;;  <span class="comment">//这是一个对象</span></span><br><span class="line"><span class="keyword">var</span> json = <span class="string">'&#123;a:'</span>hello<span class="string">',b:'</span>world<span class="string">'&#125;'</span>;  <span class="comment">//这是JSON字符串</span></span><br></pre></td></tr></table></figure></p><h2 id="JSON和JS互转"><a href="#JSON和JS互转" class="headerlink" title="JSON和JS互转"></a>JSON和JS互转</h2><p>实现JSON转JS对象，使用JSON.parse()方法<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var obj</span> = JSON.parse(<span class="string">'&#123;a:'</span>hello<span class="string">',b:'</span>world<span class="string">'&#125;'</span>) ;</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attribute">a</span>:<span class="string">'hello'</span>,b:<span class="string">'world'</span>&#125;</span><br></pre></td></tr></table></figure></p><p>实现JS对象转JSON，使用JSON。stringify()方法<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var json</span> = JSON.stringify(&#123;a:<span class="string">'hello'</span>,b:<span class="string">'world'</span>&#125;);</span><br></pre></td></tr></table></figure></p><p>JSON1.html<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">//编写一个对象</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> user = &#123;</span></span><br><span class="line"><span class="actionscript">            name:<span class="string">"s1nd0re1"</span>,</span></span><br><span class="line">            age:21,</span><br><span class="line"><span class="actionscript">            sex:<span class="string">"男"</span></span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="actionscript">        <span class="comment">//输出这个对象</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(user);</span></span><br><span class="line"><span class="actionscript">        <span class="comment">//将js对象转换成json对象</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> json = <span class="built_in">JSON</span>.stringify(user);</span></span><br><span class="line"><span class="actionscript">        <span class="comment">//输出这个json字符串</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(json);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(json);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(obj)</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h2><p>创建一个web application项目<br>创建springmvc的配置文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span> <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">                    http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.ceit.controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span> <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>创建User实体类<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.experimental.Accessors;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors</span>(chain = <span class="literal">true</span>)</span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>编写控制器 UserController<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(<span class="meta-string">"/json1"</span>)</span></span><br><span class="line">    <span class="comment">//我们正常返回会走视图解析器，而jso返回的是一个字符串</span></span><br><span class="line">    <span class="comment">//市面上有很多的第三方jar包可以实现这个功能，jackson  只需要一个简单的注解就可以实现了</span></span><br><span class="line">    <span class="meta">@ResponseBody</span>  <span class="comment">//将服务器端返回的对象转换为json对象响应回去</span></span><br><span class="line">    <span class="keyword">public</span> String json1() throws JsonProcessingException &#123;</span><br><span class="line">        <span class="comment">//需要一个jackson的对象映射器，就是一个类，使用它可以直接将对象转换为json字符串</span></span><br><span class="line">        ObjectMapper objectMapper = new ObjectMapper();</span><br><span class="line">        <span class="comment">// 创建一个对象</span></span><br><span class="line">        User user = new User(<span class="string">"51nd0re1"</span>,<span class="number">21</span>,<span class="string">"男"</span>);</span><br><span class="line">        System.<span class="keyword">out</span>.println(user);</span><br><span class="line">        <span class="comment">//将Java对象转换为json字符串</span></span><br><span class="line">        String str = objectMapper.writeValueAsString(user);</span><br><span class="line">        System.<span class="keyword">out</span>.println(str);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> str; <span class="comment">//由于使用了@ResponseBody  这里会将str以json格式的字符串返回，十分方便</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>访问/json1就可以了 但是由于编码问题前端会出现乱码<br>可以在@RequestMapping添加produces </p><p>最方便的就是修改配置文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"objectMapper"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"failOnEmptyBeans"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure><br>就可以修改成默认utf-8</p><p>UserController.java<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line">import com.ceit.pojo.User;</span><br><span class="line">import com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line">import com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RequestMapping</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">ResponseBody</span>;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> &#123;</span></span><br><span class="line">    @RequestMapping(value = <span class="string">"/json2"</span>)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public String json2() throws JsonProcessingException &#123;</span><br><span class="line">        User user = new User(<span class="string">"51nd0re1"</span>, <span class="number">21</span>, <span class="string">"男"</span>);</span><br><span class="line">        <span class="keyword">return</span> new ObjectMapper().writeValueAsString(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"name"</span>:<span class="string">"51nd0re1"</span>,<span class="attr">"age"</span>:<span class="number">21</span>,<span class="attr">"sex"</span>:<span class="string">"男"</span>&#125;</span><br></pre></td></tr></table></figure></p><p>还可以用来显示时间 返回的是时间戳的格式:1615286246602<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line">import com.ceit.pojo.User;</span><br><span class="line">import com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line">import com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RequestMapping</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">ResponseBody</span>;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> &#123;</span></span><br><span class="line">    @RequestMapping(value = <span class="string">"/time1"</span>)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public String json3() throws JsonProcessingException &#123;</span><br><span class="line">        Date date = new Date();</span><br><span class="line">        <span class="keyword">return</span> new ObjectMapper().writeValueAsString(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这样显示时间很不方便<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line">@<span class="type">Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    @<span class="type">RequestMapping</span>(value = <span class="string">"/time2"</span>)</span><br><span class="line">    @<span class="type">ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> json5() <span class="keyword">throws</span> <span class="type">JsonProcessingException</span> &#123;</span><br><span class="line">        <span class="type">ObjectMapper</span> mapper = new <span class="type">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.如何让他不返回时间戳:关闭时间戳功能</span></span><br><span class="line">        mapper.configure(<span class="type">SerializationFeature</span>.<span class="type">WRITE_DATES_AS_TIMESTAMPS</span>,<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//2.时间格式化问题</span></span><br><span class="line">        <span class="type">SimpleDateFormat</span> simpleDateFormat = new <span class="type">SimpleDateFormat</span>(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        <span class="comment">//3.让mapper指定时间日期格式为simpleDateFormat</span></span><br><span class="line">        mapper.setDateFormat(simpleDateFormat);</span><br><span class="line">        <span class="comment">//4.写一个日期对象</span></span><br><span class="line">        <span class="type">Date</span> date = new <span class="type">Date</span>();</span><br><span class="line">        <span class="keyword">return</span> mapper.writeValueAsString(date);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"2021<span class="selector-tag">-03-09</span> 18<span class="selector-pseudo">:45</span><span class="selector-pseudo">:10"</span></span><br></pre></td></tr></table></figure></p><h3 id="封装成工具类"><a href="#封装成工具类" class="headerlink" title="封装成工具类"></a>封装成工具类</h3><p>发现问题，重复代码太多，给它编写一个工具类JsonUtils<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getJson(Object object)&#123;</span><br><span class="line">        <span class="keyword">return</span> getJson(object,<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getJson(Object object,<span class="keyword">String</span> dateFormat)&#123;</span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> <span class="type">ObjectMapper</span>();</span><br><span class="line">        <span class="comment">//1.如何让他不返回时间戳:关闭时间戳功能</span></span><br><span class="line">        mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS,<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//2.时间格式化问题</span></span><br><span class="line">        SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> <span class="type">SimpleDateFormat</span>(dateFormat);</span><br><span class="line">        <span class="comment">//3.让mapper指定时间日期格式为simpleDateFormat</span></span><br><span class="line">        mapper.setDateFormat(simpleDateFormat);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> mapper.writeValueAsString(object);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>再修改Controller<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.ceit.utils.JsonUtils;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line">@<span class="type">Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    @<span class="type">RequestMapping</span>(value = <span class="string">"/time3"</span>)</span><br><span class="line">    @<span class="type">ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> json6() <span class="keyword">throws</span> <span class="type">JsonProcessingException</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Date</span> date = new <span class="type">Date</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="type">JsonUtils</span>.getJson(date);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这样代码就非常简洁美观了<br>运行结果<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"2021<span class="selector-tag">-03-09</span> 18<span class="selector-pseudo">:55</span><span class="selector-pseudo">:37"</span></span><br></pre></td></tr></table></figure></p><p><a href="/download/JSON.zip">源码下载</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;h2 id=&quot;Web-1-0-时代&quot;&gt;&lt;a href=&quot;#Web-1-0-时代&quot; class=&quot;headerlink&quot; title=&quot;Web 1
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Python3-2021/2/22-pandas</title>
    <link href="http://yoursite.com/2021/02/24/Python3-2021-2-22-pandas/"/>
    <id>http://yoursite.com/2021/02/24/Python3-2021-2-22-pandas/</id>
    <published>2021-02-24T14:46:44.000Z</published>
    <updated>2021-02-24T15:34:20.997Z</updated>
    
    <content type="html"><![CDATA[<h1 id="选择数据"><a href="#选择数据" class="headerlink" title="选择数据"></a>选择数据</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"A列的数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df[<span class="string">'A'</span>],df.A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"0-3下标，20130102到20130104行"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df[<span class="number">0</span>:<span class="number">3</span>],df[<span class="string">'20130102'</span>:<span class="string">'20130104'</span>])</span></span> #可以通过下标来截取 也可以通过标签来选取</span><br></pre></td></tr></table></figure><p>既可以通过下标来截取 也可以通过标签来选取</p><p>运行结果：<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">df数据</span></span><br><span class="line">             <span class="string">A</span>   <span class="string">B</span>   <span class="string">C</span>   <span class="string">D</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line"><span class="string">A列的数据</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>     <span class="number">4</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>     <span class="number">8</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>    <span class="number">12</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>    <span class="number">16</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">20</span></span><br><span class="line"><span class="attr">Freq:</span> <span class="string">D,</span> <span class="attr">Name:</span> <span class="string">A,</span> <span class="attr">dtype:</span> <span class="string">int32</span> <span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>     <span class="number">4</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>     <span class="number">8</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>    <span class="number">12</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>    <span class="number">16</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">20</span></span><br><span class="line"><span class="attr">Freq:</span> <span class="string">D,</span> <span class="attr">Name:</span> <span class="string">A,</span> <span class="attr">dtype:</span> <span class="string">int32</span></span><br><span class="line"><span class="number">0</span><span class="number">-3</span><span class="string">下标，20130102到20130104行</span></span><br><span class="line">            <span class="string">A</span>  <span class="string">B</span>   <span class="string">C</span>   <span class="string">D</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0</span>  <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">4</span>  <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">8</span>  <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span>              <span class="string">A</span>   <span class="string">B</span>   <span class="string">C</span>   <span class="string">D</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br></pre></td></tr></table></figure></p><h2 id="loc"><a href="#loc" class="headerlink" title="loc"></a>loc</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,<span class="attribute">periods</span>=6)</span><br><span class="line">df = pd.DataFrame(np.arange(24).reshape((6,4)),<span class="attribute">index</span>=dates,columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df数据"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># select by label: loc</span></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"以标签名义选择20130102"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df.loc[<span class="string">'20130102'</span>]) #以标签的名义来选择</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"保留所有行  选取A B两列"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df.loc[:,[<span class="string">'A'</span>,<span class="string">'B'</span>]]) #保留所有行 选取A B两列</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">以标签名义选择<span class="number">20130102</span></span><br><span class="line">A    <span class="number">4</span></span><br><span class="line">B    <span class="number">5</span></span><br><span class="line">C    <span class="number">6</span></span><br><span class="line">D    <span class="number">7</span></span><br><span class="line">Name: <span class="number">2013</span><span class="number">-01</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: <span class="built_in">int</span>32</span><br><span class="line">保留所有行  选取A B两列</span><br><span class="line">             A   B</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span></span><br></pre></td></tr></table></figure></p><h2 id="iloc"><a href="#iloc" class="headerlink" title="iloc"></a>iloc</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,<span class="attribute">periods</span>=6)</span><br><span class="line">df = pd.DataFrame(np.arange(24).reshape((6,4)),<span class="attribute">index</span>=dates,columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df数据"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># select by position: iloc</span></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"以下标选择 下标为3的数据"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df.iloc[3]) #以下标选择</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"选下标3到5行 下标1到3列的数据 左包含右不包含"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df.iloc[3:5,1:3]) #选下标3到5行 下标1到3列的数据 左包含右不包含</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">以下标选择 下标为<span class="number">3</span>的数据</span><br><span class="line">A    <span class="number">12</span></span><br><span class="line">B    <span class="number">13</span></span><br><span class="line">C    <span class="number">14</span></span><br><span class="line">D    <span class="number">15</span></span><br><span class="line">Name: <span class="number">2013</span><span class="number">-01</span><span class="number">-04</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: <span class="built_in">int</span>32</span><br><span class="line">选下标<span class="number">3</span>到<span class="number">5</span>行 下标<span class="number">1</span>到<span class="number">3</span>列的数据 左包含右不包含</span><br><span class="line">             B   C</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">13</span>  <span class="number">14</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">17</span>  <span class="number">18</span></span><br></pre></td></tr></table></figure></p><h2 id="条件选择"><a href="#条件选择" class="headerlink" title="条件选择"></a>条件选择</h2><p>可以通过表达式来进行选择<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,<span class="attribute">periods</span>=6)</span><br><span class="line">df = pd.DataFrame(np.arange(24).reshape((6,4)),<span class="attribute">index</span>=dates,columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df数据"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Boolean indexing</span></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"以条件来筛选 选出df A列中所有大于8的数据 BCD列也会显示出来"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df[df.A &gt; 8]) #以条件来筛选 选出df A列中所有大于8的数据 BCD列也会显示出来</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">以条件来筛选 选出df A列中所有大于<span class="number">8</span>的数据 BCD列也会显示出来</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br></pre></td></tr></table></figure></p><h1 id="设置值"><a href="#设置值" class="headerlink" title="设置值"></a>设置值</h1><p>同样可以用loc和iloc来进行选取 并设置<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"通过iloc选取设置"</span>)</span></span></span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">2</span>,<span class="number">2</span>] = <span class="number">1111</span>  #以下标设置值</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"通过loc选取设置"</span>)</span></span></span><br><span class="line">df<span class="selector-class">.loc</span>[<span class="string">'20130101'</span>,<span class="string">'B'</span>] = <span class="number">222</span>  #以标签设置值</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">通过iloc选取设置</span><br><span class="line">             A   B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>     <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>     <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">1111</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>    <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>    <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>    <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">通过loc选取设置</span><br><span class="line">             A    B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>  <span class="number">222</span>     <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>    <span class="number">5</span>     <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>    <span class="number">9</span>  <span class="number">1111</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>   <span class="number">13</span>    <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>   <span class="number">17</span>    <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>   <span class="number">21</span>    <span class="number">22</span>  <span class="number">23</span></span><br></pre></td></tr></table></figure></p><p>条件语句也同样适用<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"A列大于4的的所有行的数据都变为0"</span>)</span></span></span><br><span class="line">df[df.A&gt;<span class="number">4</span>] = <span class="number">0</span> #A列大于<span class="number">4</span>的的所有行的数据都变为<span class="number">0</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">A列大于<span class="number">4</span>的的所有行的数据都变为<span class="number">0</span></span><br><span class="line">            A  B  C  D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">0</span></span><br></pre></td></tr></table></figure><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"A列大于4的数据都变为0"</span>)</span></span></span><br><span class="line">df<span class="selector-class">.A</span>[df.A&gt;<span class="number">4</span>] = <span class="number">0</span> #A列大于<span class="number">4</span>的所有数据都变为<span class="number">0</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">A列大于<span class="number">4</span>的数据都变为<span class="number">0</span></span><br><span class="line">            A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">0</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">0</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br></pre></td></tr></table></figure><br>注意这两个所选取的范围不同 变化也会不同</p><p>还可以新增一列<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"定义一个新的列F 值都为NAN"</span>)</span></span></span><br><span class="line">df[<span class="string">'F'</span>] = np<span class="selector-class">.nan</span> #定义一个新的列F 值都为NAN</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"设置一个新列E 行的标签要保持一致 赋值"</span>)</span></span></span><br><span class="line">df[<span class="string">'E'</span>] = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],index=pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)) #设置一个新列E 行的标签要保持一致 赋值</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A   B   C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span></span><br><span class="line">定义一个新的列F 值都为NAN</span><br><span class="line">             A   B   C   D   F</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span> NaN</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span> NaN</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span> NaN</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span> NaN</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span> NaN</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span> NaN</span><br><span class="line">设置一个新列E 行的标签要保持一致 赋值</span><br><span class="line">             A   B   C   D   F  E</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span> NaN  <span class="number">1</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span> NaN  <span class="number">2</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span> NaN  <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span> NaN  <span class="number">4</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span> NaN  <span class="number">5</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span> NaN  <span class="number">6</span></span><br></pre></td></tr></table></figure></p><h1 id="导入导出数据"><a href="#导入导出数据" class="headerlink" title="导入导出数据"></a>导入导出数据</h1><p>导入导出数据有很多 直接参考网站 都差不多</p><p><a href="https://www.pypandas.cn/docs/user_guide/io.html#csv-%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6" target="_blank" rel="noopener">pandas_I/O</a></p><h1 id="处理丢失数据"><a href="#处理丢失数据" class="headerlink" title="处理丢失数据"></a>处理丢失数据</h1><h2 id="dropna-丢弃"><a href="#dropna-丢弃" class="headerlink" title="dropna 丢弃"></a>dropna 丢弃</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">0</span>,<span class="number">1</span>] = np<span class="selector-class">.nan</span> #<span class="number">0</span>行<span class="number">1</span>列数据为空</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">1</span>,<span class="number">2</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"丢掉行 1丢掉列  how=&#123;'any','all'&#125; 该行有nan就丢掉"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df.dropna(axis=<span class="number">0</span>,how=<span class="string">'any'</span>)</span></span>) #丢掉行 <span class="number">1</span>丢掉列  how=&#123;<span class="string">'any'</span>,<span class="string">'all'</span>&#125; 该行有nan就丢掉</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"丢掉行 1丢掉列  how=&#123;'any','all'&#125; 只有该行所有数都为nan才丢掉"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df.dropna(axis=<span class="number">0</span>,how=<span class="string">'all'</span>)</span></span>) #丢掉行 <span class="number">1</span>丢掉列  how=&#123;<span class="string">'any'</span>,<span class="string">'all'</span>&#125; 只有该行所有数都为nan才丢掉</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A     B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   NaN   <span class="number">2.0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5.0</span>   NaN   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br><span class="line">丢掉行 <span class="number">1</span>丢掉列  how=&#123;<span class="string">'any'</span>,<span class="string">'all'</span>&#125; 该行有nan就丢掉</span><br><span class="line">             A     B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br><span class="line">丢掉行 <span class="number">1</span>丢掉列  how=&#123;<span class="string">'any'</span>,<span class="string">'all'</span>&#125; 只有该行所有数都为nan才丢掉</span><br><span class="line">             A     B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   NaN   <span class="number">2.0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5.0</span>   NaN   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br></pre></td></tr></table></figure></p><h2 id="fillna-指定填充"><a href="#fillna-指定填充" class="headerlink" title="fillna 指定填充"></a>fillna 指定填充</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">0</span>,<span class="number">1</span>] = np<span class="selector-class">.nan</span> #<span class="number">0</span>行<span class="number">1</span>列数据为空</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">1</span>,<span class="number">2</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"将丢失的数据变为0"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df.fillna(value=<span class="number">0</span>)</span></span>)  #将丢失的数据变为<span class="number">0</span></span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df数据</span><br><span class="line">             A     B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   NaN   <span class="number">2.0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5.0</span>   NaN   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br><span class="line">将丢失的数据变为<span class="number">0</span></span><br><span class="line">             A     B     C   D</span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="number">0.0</span>   <span class="number">2.0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5.0</span>   <span class="number">0.0</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br></pre></td></tr></table></figure></p><h2 id="isnull-判断缺失"><a href="#isnull-判断缺失" class="headerlink" title="isnull 判断缺失"></a>isnull 判断缺失</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">0</span>,<span class="number">1</span>] = np<span class="selector-class">.nan</span> #<span class="number">0</span>行<span class="number">1</span>列数据为空</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">1</span>,<span class="number">2</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"是否有缺失  缺失为True 不缺失为False"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df.isnull()</span></span>) #是否有缺失  缺失为True 不缺失为False</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">df数据</span></span><br><span class="line">             <span class="string">A</span>     <span class="string">B</span>     <span class="string">C</span>   <span class="string">D</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="string">NaN</span>   <span class="number">2.0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5.0</span>   <span class="string">NaN</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br><span class="line"><span class="string">是否有缺失</span>  <span class="string">缺失为True</span> <span class="string">不缺失为False</span></span><br><span class="line">                <span class="string">A</span>      <span class="string">B</span>      <span class="string">C</span>      <span class="string">D</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br></pre></td></tr></table></figure></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(<span class="string">'20130101'</span>,periods=<span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.arange(<span class="number">24</span>).reshape((<span class="number">6</span>,<span class="number">4</span>)),index=dates,<span class="attribute">columns</span>=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>])</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">0</span>,<span class="number">1</span>] = np<span class="selector-class">.nan</span> #<span class="number">0</span>行<span class="number">1</span>列数据为空</span><br><span class="line">df<span class="selector-class">.iloc</span>[<span class="number">1</span>,<span class="number">2</span>] = np.nan</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"df数据"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(df)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"至少有一个为True 就意味着至少丢失了一个数据 True丢失了 False没有丢失"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.any(df.isnull()</span></span>)==True) #至少有一个为True 就意味着至少丢失了一个数据 True丢失了 False没有丢失</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">df数据</span></span><br><span class="line">             <span class="string">A</span>     <span class="string">B</span>     <span class="string">C</span>   <span class="string">D</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-01</span>   <span class="number">0</span>   <span class="string">NaN</span>   <span class="number">2.0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-02</span>   <span class="number">4</span>   <span class="number">5.0</span>   <span class="string">NaN</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-03</span>   <span class="number">8</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-04</span>  <span class="number">12</span>  <span class="number">13.0</span>  <span class="number">14.0</span>  <span class="number">15</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-05</span>  <span class="number">16</span>  <span class="number">17.0</span>  <span class="number">18.0</span>  <span class="number">19</span></span><br><span class="line"><span class="number">2013</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">20</span>  <span class="number">21.0</span>  <span class="number">22.0</span>  <span class="number">23</span></span><br><span class="line"><span class="string">至少有一个为True</span> <span class="string">就意味着至少丢失了一个数据</span> <span class="literal">True</span><span class="string">丢失了</span> <span class="literal">False</span><span class="string">没有丢失</span></span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure></p><h1 id="concat合并"><a href="#concat合并" class="headerlink" title="concat合并"></a>concat合并</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># concatenating</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((3,4))<span class="number">*0</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.ones((3,4))<span class="number">*1</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">df3 = pd.DataFrame(np.ones((3,4))<span class="number">*2</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df1"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df1)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df2"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df2)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df3"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df3)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"res"</span>)</span><br><span class="line">res = pd.concat([df1,df2,df3],<span class="attribute">axis</span>=1,ignore_index=True) #水平合并df1 df2 df3 0为垂直合并 <span class="attribute">ignore_index</span>=<span class="literal">True</span> 就是忽略之前的标签 重新开始排序</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line">df2</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line">df3</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line">res</span><br><span class="line">    <span class="number">0</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>    <span class="number">10</span>   <span class="number">11</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br></pre></td></tr></table></figure></p><h2 id="join参数"><a href="#join参数" class="headerlink" title="join参数"></a>join参数</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># join,['inner','outer']</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((3,4))<span class="number">*0</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>],index=[1,2,3])</span><br><span class="line">df2 = pd.DataFrame(np.ones((3,4))<span class="number">*1</span>,columns=[<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>],index=[2,3,4])</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df1"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df1)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df2"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df2)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"对于标签不一样的 会把彼此没有的标签那一栏用nan填充  join默认outer模式"</span>)</span><br><span class="line">res = pd.concat([df1,df2],<span class="attribute">join</span>=<span class="string">'outer'</span>)  #对于标签不一样的 会把彼此没有的标签那一栏用nan填充  join默认outer模式</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"进行裁剪 将两者标签相同的部分保留"</span>)</span><br><span class="line">res = pd.concat([df1,df2],<span class="attribute">join</span>=<span class="string">'inner'</span>,ignore_index=True)  #进行裁剪 将两者标签相同的部分保留</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"按df1的索引 进行水平合并"</span>)</span><br><span class="line">res = pd.concat([df1,df2.reindex_like(df1)],<span class="attribute">axis</span>=1)  #按df1的索引 进行水平合并</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line">df2</span><br><span class="line">     b    c    d    e</span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">4</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line">对于标签不一样的 会把彼此没有的标签那一栏用nan填充  join默认outer模式</span><br><span class="line">     a    b    c    d    e</span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  NaN</span><br><span class="line"><span class="number">2</span>  NaN  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>  NaN  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">4</span>  NaN  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line">进行裁剪 将两者标签相同的部分保留</span><br><span class="line">     b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">4</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">5</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line">按df1的索引 进行水平合并</span><br><span class="line">     a    b    c    d   a    b    c    d</span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span> NaN  NaN  NaN  NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span> NaN  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span> NaN  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br></pre></td></tr></table></figure></p><h2 id="append方法"><a href="#append方法" class="headerlink" title="append方法"></a>append方法</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># append</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((3,4))<span class="number">*0</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.ones((3,4))<span class="number">*1</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">df3 = pd.DataFrame(np.ones((3,4))<span class="number">*2</span>,columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>],index=[2,3,4])</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df1"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df1)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df2"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df2)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"df3"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(df3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"将df2添加到df1并合并 重新排序"</span>)</span><br><span class="line">res = df1.append(df2,<span class="attribute">ignore_index</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"将df2,df3都添加到df1中  不重新排序"</span>)</span><br><span class="line">res = df1.append([df2,df3])</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"设置一个s1并添加到df1中 重新排序"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"s1"</span>)</span><br><span class="line">s1 = pd.Series([1,2,3,4],index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line"><span class="builtin-name">print</span>(s1)</span><br><span class="line">res = df1.append(s1,<span class="attribute">ignore_index</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line">df2</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line">df3</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">4</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line">将df2添加到df1并合并 重新排序</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">4</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">5</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line">将df2,df3都添加到df1中  不重新排序</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">4</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span>  <span class="number">2.0</span></span><br><span class="line">设置一个s1矩阵并添加到df1中 重新排序</span><br><span class="line">s1</span><br><span class="line">a    <span class="number">1</span></span><br><span class="line">b    <span class="number">2</span></span><br><span class="line">c    <span class="number">3</span></span><br><span class="line">d    <span class="number">4</span></span><br><span class="line">dtype: <span class="built_in">int</span>64</span><br><span class="line">     a    b    c    d</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">3.0</span>  <span class="number">4.0</span></span><br></pre></td></tr></table></figure></p><h1 id="merge合并"><a href="#merge合并" class="headerlink" title="merge合并"></a>merge合并</h1><p>简单的例子<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import numpy <span class="keyword">as</span> np</span><br><span class="line">import pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"># merging two df by key/<span class="built_in">keys</span> (may <span class="keyword">be</span> used in database)</span><br><span class="line"># simple example</span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span> = pd.DataFrame(&#123;<span class="string">'key'</span>:[<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K2'</span>,<span class="string">'K3'</span>],</span><br><span class="line">                     <span class="string">'A'</span>:[<span class="string">'A0'</span>,<span class="string">'A1'</span>,<span class="string">'A2'</span>,<span class="string">'A3'</span>],</span><br><span class="line">                     <span class="string">'B'</span>:[<span class="string">'B0'</span>,<span class="string">'B1'</span>,<span class="string">'B2'</span>,<span class="string">'B3'</span>]&#125;)</span><br><span class="line"><span class="keyword">right</span> = pd.DataFrame(&#123;<span class="string">'key'</span>:[<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K2'</span>,<span class="string">'K3'</span>],</span><br><span class="line">                      <span class="string">'C'</span>:[<span class="string">'C0'</span>,<span class="string">'C1'</span>,<span class="string">'C2'</span>,<span class="string">'C3'</span>],</span><br><span class="line">                      <span class="string">'D'</span>:[<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">left</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">right</span>)</span><br><span class="line"><span class="keyword">res</span> = pd.merge(<span class="keyword">left</span>,<span class="keyword">right</span>,<span class="keyword">on</span>=<span class="string">'key'</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">res</span>)</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  key   A   <span class="keyword">B</span></span><br><span class="line"><span class="keyword">0 </span> K0  A0  <span class="keyword">B0</span></span><br><span class="line"><span class="keyword">1 </span> K1  <span class="built_in">A1</span>  <span class="keyword">B1</span></span><br><span class="line"><span class="keyword">2 </span> K2  <span class="built_in">A2</span>  <span class="keyword">B2</span></span><br><span class="line"><span class="keyword">3 </span> K3  <span class="built_in">A3</span>  <span class="keyword">B3</span></span><br><span class="line"><span class="keyword"> </span> key   C   D</span><br><span class="line"><span class="number">0</span>  K0  <span class="built_in">C0</span>  <span class="built_in">D0</span></span><br><span class="line"><span class="number">1</span>  K1  <span class="built_in">C1</span>  <span class="built_in">D1</span></span><br><span class="line"><span class="number">2</span>  K2  <span class="built_in">C2</span>  <span class="built_in">D2</span></span><br><span class="line"><span class="number">3</span>  K3  <span class="built_in">C3</span>  <span class="built_in">D3</span></span><br><span class="line">  key   A   <span class="keyword">B </span>  C   D</span><br><span class="line"><span class="number">0</span>  K0  A0  <span class="keyword">B0 </span> <span class="built_in">C0</span>  <span class="built_in">D0</span></span><br><span class="line"><span class="number">1</span>  K1  <span class="built_in">A1</span>  <span class="keyword">B1 </span> <span class="built_in">C1</span>  <span class="built_in">D1</span></span><br><span class="line"><span class="number">2</span>  K2  <span class="built_in">A2</span>  <span class="keyword">B2 </span> <span class="built_in">C2</span>  <span class="built_in">D2</span></span><br><span class="line"><span class="number">3</span>  K3  <span class="built_in">A3</span>  <span class="keyword">B3 </span> <span class="built_in">C3</span>  <span class="built_in">D3</span></span><br></pre></td></tr></table></figure></p><h2 id="两个key"><a href="#两个key" class="headerlink" title="两个key"></a>两个key</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import numpy <span class="keyword">as</span> np</span><br><span class="line">import pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"># merging two df by key/<span class="built_in">keys</span> (may <span class="keyword">be</span> used in database)</span><br><span class="line"># consider two <span class="built_in">keys</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span> = pd.DataFrame(&#123;<span class="string">'key1'</span>:[<span class="string">'K0'</span>,<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K2'</span>],</span><br><span class="line">                     <span class="string">'key2'</span>:[<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K0'</span>,<span class="string">'K1'</span>],</span><br><span class="line">                     <span class="string">'A'</span>:[<span class="string">'A0'</span>,<span class="string">'A1'</span>,<span class="string">'A2'</span>,<span class="string">'A3'</span>],</span><br><span class="line">                     <span class="string">'B'</span>:[<span class="string">'B0'</span>,<span class="string">'B1'</span>,<span class="string">'B2'</span>,<span class="string">'B3'</span>]&#125;)</span><br><span class="line"><span class="keyword">right</span> = pd.DataFrame(&#123;<span class="string">'key1'</span>:[<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K1'</span>,<span class="string">'K2'</span>],</span><br><span class="line">                      <span class="string">'key2'</span>:[<span class="string">'K0'</span>,<span class="string">'K0'</span>,<span class="string">'K0'</span>,<span class="string">'K0'</span>],</span><br><span class="line">                      <span class="string">'C'</span>:[<span class="string">'C0'</span>,<span class="string">'C1'</span>,<span class="string">'C2'</span>,<span class="string">'C3'</span>],</span><br><span class="line">                      <span class="string">'D'</span>:[<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">left</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">right</span>)</span><br><span class="line">#how=[<span class="string">'inner'</span>,<span class="string">'outer'</span>,<span class="string">'left'</span>,<span class="string">'right'</span>]</span><br><span class="line"><span class="keyword">res</span> = pd.merge(<span class="keyword">left</span>,<span class="keyword">right</span>,<span class="keyword">on</span>=[<span class="string">'key1'</span>,<span class="string">'key2'</span>],how=<span class="string">'inner'</span>) #默认inner 只合并相同的数据</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">res</span>)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  key1 key2   A   <span class="keyword">B</span></span><br><span class="line"><span class="keyword">0 </span>  <span class="built_in">K0</span>   <span class="built_in">K0</span>  <span class="built_in">A0</span>  <span class="keyword">B0</span></span><br><span class="line"><span class="keyword">1 </span>  <span class="built_in">K0</span>   <span class="built_in">K1</span>  <span class="built_in">A1</span>  <span class="keyword">B1</span></span><br><span class="line"><span class="keyword">2 </span>  <span class="built_in">K1</span>   <span class="built_in">K0</span>  <span class="built_in">A2</span>  <span class="keyword">B2</span></span><br><span class="line"><span class="keyword">3 </span>  K2   <span class="built_in">K1</span>  <span class="built_in">A3</span>  <span class="keyword">B3</span></span><br><span class="line"><span class="keyword"> </span> key1 key2   C   D</span><br><span class="line"><span class="number">0</span>   <span class="built_in">K0</span>   <span class="built_in">K0</span>  C0  D0</span><br><span class="line"><span class="number">1</span>   <span class="built_in">K1</span>   <span class="built_in">K0</span>  C1  D1</span><br><span class="line"><span class="number">2</span>   <span class="built_in">K1</span>   <span class="built_in">K0</span>  C2  D2</span><br><span class="line"><span class="number">3</span>   K2   <span class="built_in">K0</span>  C3  D3</span><br><span class="line">  key1 key2   A   <span class="keyword">B </span>  C   D</span><br><span class="line"><span class="number">0</span>   <span class="built_in">K0</span>   <span class="built_in">K0</span>  <span class="built_in">A0</span>  <span class="keyword">B0 </span> C0  D0</span><br><span class="line"><span class="number">1</span>   <span class="built_in">K1</span>   <span class="built_in">K0</span>  <span class="built_in">A2</span>  <span class="keyword">B2 </span> C1  D1</span><br><span class="line"><span class="number">2</span>   <span class="built_in">K1</span>   <span class="built_in">K0</span>  <span class="built_in">A2</span>  <span class="keyword">B2 </span> C2  D2</span><br></pre></td></tr></table></figure></p><h2 id="indicator-显示以何做标签"><a href="#indicator-显示以何做标签" class="headerlink" title="indicator 显示以何做标签"></a>indicator 显示以何做标签</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># merging two df by key/keys (may be used in database)</span></span><br><span class="line"><span class="comment"># indicator</span></span><br><span class="line">df1 = pd.DataFrame(&#123;<span class="string">'col1'</span>:[<span class="number">0</span>,<span class="number">1</span>],<span class="string">'col_left'</span>:[<span class="string">'a'</span>,<span class="string">'b'</span>]&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">'col1'</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>],<span class="string">'col_right'</span>:[<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(df1)</span><br><span class="line"><span class="built_in">print</span>(df2)</span><br><span class="line"></span><br><span class="line">res = pd.merge(df1,df2,<span class="literal">on</span>=<span class="string">'col1'</span>,how=<span class="string">'outer'</span>,indicator=True)  <span class="comment">#显示合并是以哪一个df作为标签</span></span><br><span class="line"><span class="comment"># give the indicator a custom name</span></span><br><span class="line"><span class="comment"># res = pd.merge(df1,df2,on='col1',how='outer',indicator='indicator_column')</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   col1 col_left</span><br><span class="line"><span class="number">0</span>     <span class="number">0</span>        a</span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>        b</span><br><span class="line">   col1  col_right</span><br><span class="line"><span class="number">0</span>     <span class="number">1</span>          <span class="number">2</span></span><br><span class="line"><span class="number">1</span>     <span class="number">2</span>          <span class="number">2</span></span><br><span class="line"><span class="number">2</span>     <span class="number">2</span>          <span class="number">2</span></span><br><span class="line">   col1 col_left  col_right      _merge</span><br><span class="line"><span class="number">0</span>     <span class="number">0</span>        a        NaN   left_only</span><br><span class="line"><span class="number">1</span>     <span class="number">1</span>        b        <span class="number">2.0</span>        both</span><br><span class="line"><span class="number">2</span>     <span class="number">2</span>      NaN        <span class="number">2.0</span>  right_only</span><br><span class="line"><span class="number">3</span>     <span class="number">2</span>      NaN        <span class="number">2.0</span>  right_only</span><br></pre></td></tr></table></figure></p><h2 id="按索引合并"><a href="#按索引合并" class="headerlink" title="按索引合并"></a>按索引合并</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import numpy <span class="keyword">as</span> np</span><br><span class="line">import pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"># merging two df by key/<span class="built_in">keys</span> (may <span class="keyword">be</span> used in database)</span><br><span class="line"># merged by <span class="built_in">index</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span> = pd.DataFrame(&#123;<span class="string">'A'</span>:[<span class="string">'A0'</span>,<span class="string">'A1'</span>,<span class="string">'A2'</span>],</span><br><span class="line">                     <span class="string">'B'</span>:[<span class="string">'B0'</span>,<span class="string">'B1'</span>,<span class="string">'B2'</span>]&#125;,</span><br><span class="line">                    <span class="built_in">index</span>=[<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K2'</span>])</span><br><span class="line"><span class="keyword">right</span> = pd.DataFrame(&#123;<span class="string">'C'</span>:[<span class="string">'C0'</span>,<span class="string">'C2'</span>,<span class="string">'C3'</span>],</span><br><span class="line">                      <span class="string">'D'</span>:[<span class="string">'D0'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>]&#125;,</span><br><span class="line">                     <span class="built_in">index</span>=[<span class="string">'K0'</span>,<span class="string">'K2'</span>,<span class="string">'K3'</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">left</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">right</span>)</span><br><span class="line">#left_index <span class="built_in">and</span> right_index</span><br><span class="line"><span class="keyword">res</span> = pd.merge(<span class="keyword">left</span>,<span class="keyword">right</span>,left_index=True,right_index=True,how=<span class="string">'outer'</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">res</span>)</span><br><span class="line"><span class="keyword">res</span> = pd.merge(<span class="keyword">left</span>,<span class="keyword">right</span>,left_index=True,right_index=True,how=<span class="string">'inner'</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">res</span>)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">     A   <span class="keyword">B</span></span><br><span class="line"><span class="keyword">K0 </span> A0  <span class="keyword">B0</span></span><br><span class="line"><span class="keyword">K1 </span> <span class="built_in">A1</span>  <span class="keyword">B1</span></span><br><span class="line"><span class="keyword">K2 </span> <span class="built_in">A2</span>  <span class="keyword">B2</span></span><br><span class="line"><span class="keyword"> </span>    C   D</span><br><span class="line"><span class="symbol">K0</span>  <span class="built_in">C0</span>  <span class="built_in">D0</span></span><br><span class="line"><span class="symbol">K2</span>  <span class="built_in">C2</span>  <span class="built_in">D2</span></span><br><span class="line"><span class="symbol">K3</span>  <span class="built_in">C3</span>  <span class="built_in">D3</span></span><br><span class="line">      A    <span class="keyword">B </span>   C    D</span><br><span class="line"><span class="symbol">K0</span>   A0   <span class="keyword">B0 </span>  <span class="built_in">C0</span>   <span class="built_in">D0</span></span><br><span class="line"><span class="symbol">K1</span>   <span class="built_in">A1</span>   <span class="keyword">B1 </span> NaN  NaN</span><br><span class="line"><span class="symbol">K2</span>   <span class="built_in">A2</span>   <span class="keyword">B2 </span>  <span class="built_in">C2</span>   <span class="built_in">D2</span></span><br><span class="line"><span class="symbol">K3</span>  NaN  NaN   <span class="built_in">C3</span>   <span class="built_in">D3</span></span><br><span class="line">     A   <span class="keyword">B </span>  C   D</span><br><span class="line"><span class="symbol">K0</span>  A0  <span class="keyword">B0 </span> <span class="built_in">C0</span>  <span class="built_in">D0</span></span><br><span class="line"><span class="symbol">K2</span>  <span class="built_in">A2</span>  <span class="keyword">B2 </span> <span class="built_in">C2</span>  <span class="built_in">D2</span></span><br></pre></td></tr></table></figure></p><h2 id="处理重叠"><a href="#处理重叠" class="headerlink" title="处理重叠"></a>处理重叠</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># merging two df by key/keys (may be used in database)</span></span><br><span class="line"><span class="comment"># handle overlapping</span></span><br><span class="line">boys = pd.DataFrame(&#123;<span class="string">'k'</span>:[<span class="string">'K0'</span>,<span class="string">'K1'</span>,<span class="string">'K2'</span>],<span class="string">'age'</span>:[1,2,3]&#125;)</span><br><span class="line"><span class="builtin-name">print</span>(boys)</span><br><span class="line"></span><br><span class="line">girls = pd.DataFrame(&#123;<span class="string">'k'</span>:[<span class="string">'K0'</span>,<span class="string">'K0'</span>,<span class="string">'K3'</span>],<span class="string">'age'</span>:[4,5,6]&#125;)</span><br><span class="line"><span class="builtin-name">print</span>(girls)</span><br><span class="line"></span><br><span class="line">res = pd.merge(boys,girls,<span class="attribute">on</span>=<span class="string">'k'</span>,suffixes=[<span class="string">'_boy'</span>,<span class="string">'_girl'</span>],<span class="attribute">how</span>=<span class="string">'inner'</span>)</span><br><span class="line"><span class="builtin-name">print</span>(res)</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    k  age</span><br><span class="line"><span class="number">0</span>  K0    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  K1    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  K2    <span class="number">3</span></span><br><span class="line">    k  age</span><br><span class="line"><span class="number">0</span>  K0    <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  K0    <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  K3    <span class="number">6</span></span><br><span class="line">    k  age_boy  age_girl</span><br><span class="line"><span class="number">0</span>  K0        <span class="number">1</span>         <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  K0        <span class="number">1</span>         <span class="number">5</span></span><br></pre></td></tr></table></figure></p><h1 id="plot画图"><a href="#plot画图" class="headerlink" title="plot画图"></a>plot画图</h1><p>简单举例 详细会单独写一篇<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line"><span class="meta">#plot data</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># Series</span></span><br><span class="line"><span class="meta"># data = pd.Series(np.random.randn(1000),index=np.arange(1000))</span></span><br><span class="line"><span class="meta"># data = data.cumsum() #累加</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#DataFrame</span></span><br><span class="line">data = pd.DataFrame(np.random.randn(<span class="number">1000</span>,<span class="number">4</span>),</span><br><span class="line">                    # index=np.arange(<span class="number">1000</span>),</span><br><span class="line">                    columns=list(<span class="string">"ABCD"</span>))</span><br><span class="line">data = data.cumsum()</span><br><span class="line"><span class="meta"># print(data.head())</span></span><br><span class="line"><span class="meta"># data.plot()</span></span><br><span class="line"><span class="meta"># plot methods:</span></span><br><span class="line"><span class="meta"># 'bar': 柱状图</span></span><br><span class="line"><span class="meta"># 'hist'</span></span><br><span class="line"><span class="meta"># 'box'</span></span><br><span class="line"><span class="meta"># 'kde'</span></span><br><span class="line"><span class="meta"># 'scatter'</span></span><br><span class="line"><span class="meta"># hexbin'</span></span><br><span class="line"><span class="meta"># 'pie'</span></span><br><span class="line">ax = data.plot.scatter(x=<span class="string">'A'</span>,y=<span class="string">'B'</span>,color=<span class="string">'DarkBlue'</span>,label=<span class="string">"Class1"</span>)</span><br><span class="line">data.plot.scatter(x=<span class="string">'A'</span>,y=<span class="string">'C'</span>,color=<span class="string">'DarkGreen'</span>,label=<span class="string">'Class2'</span>,ax=ax)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><br>运行结果</p><p><img src="/img/python3/pandas/0.png" alt="avatar"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;选择数据&quot;&gt;&lt;a href=&quot;#选择数据&quot; class=&quot;headerlink&quot; title=&quot;选择数据&quot;&gt;&lt;/a&gt;选择数据&lt;/h1&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;p
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="Python3" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/Python3/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Python3-2021/2/21-numpy</title>
    <link href="http://yoursite.com/2021/02/21/Python3-2021-2-21-numpy/"/>
    <id>http://yoursite.com/2021/02/21/Python3-2021-2-21-numpy/</id>
    <published>2021-02-21T12:09:40.000Z</published>
    <updated>2021-02-21T12:52:38.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="numpy"><a href="#numpy" class="headerlink" title="numpy"></a>numpy</h1><h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy as np</span><br><span class="line"></span><br><span class="line"><span class="comment">#numpy 属性</span></span><br><span class="line"><span class="keyword">array</span>=np.<span class="keyword">array</span>([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">               ,[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">array</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"number of dim:"</span>,<span class="keyword">array</span>.ndim)  <span class="comment">#维度</span></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"shape:"</span>,<span class="keyword">array</span>.shape) <span class="comment">#多少行多少列</span></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"size"</span>,<span class="keyword">array</span>.size) <span class="comment">#多少个元素</span></span><br></pre></td></tr></table></figure><ul><li>array.ndim 打印维度</li><li>array.shape 打印行列数</li><li>array.size 打印元素个数</li></ul><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]]</span><br><span class="line">number of dim: <span class="number">2</span></span><br><span class="line">shape: (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">size <span class="number">6</span></span><br></pre></td></tr></table></figure></p><h2 id="创建array"><a href="#创建array" class="headerlink" title="创建array"></a>创建array</h2><h3 id="np-array"><a href="#np-array" class="headerlink" title="np.array"></a>np.array</h3><p>使用这种方法创建的数组类似于列表 但是没有逗号<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=np.array([2,3,4],<span class="attribute">dtype</span>=np.int)  #dtype设置显示的类型</span><br><span class="line"><span class="builtin-name">print</span>(a)   #类似于列表 但是没有逗号</span><br></pre></td></tr></table></figure></p><ul><li>dtype 设置显示的类型</li></ul><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br></pre></td></tr></table></figure></p><h3 id="创建全是0的array"><a href="#创建全是0的array" class="headerlink" title="创建全是0的array"></a>创建全是0的array</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=np.zeros((<span class="number">3</span>,<span class="number">4</span>),dtype=np.<span class="built_in">int</span>)  #生成一个<span class="number">3</span>行<span class="number">4</span>列 为<span class="number">0</span>的矩阵</span><br><span class="line">print(a)  #生成全为<span class="number">1</span>的矩阵就是用ones</span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]</span><br><span class="line"> [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]</span><br><span class="line"> [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>]]</span><br></pre></td></tr></table></figure></p><h3 id="指定范围创建array"><a href="#指定范围创建array" class="headerlink" title="指定范围创建array"></a>指定范围创建array</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.arange(<span class="number">10</span>,<span class="number">20</span>,<span class="number">2</span>)  #从<span class="number">10</span>到<span class="number">20</span>  步长为<span class="number">2</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">10</span> <span class="number">12</span> <span class="number">14</span> <span class="number">16</span> <span class="number">18</span>]</span><br></pre></td></tr></table></figure><p>还可以指定行列<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))  #生成<span class="number">3</span>行<span class="number">4</span>列从<span class="number">0</span>到<span class="number">11</span>的矩阵</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><br>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>]</span><br><span class="line"> [ <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>]</span><br><span class="line"> [ <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span>]]</span><br></pre></td></tr></table></figure></p><h2 id="基础运算"><a href="#基础运算" class="headerlink" title="基础运算"></a>基础运算</h2><h3 id="四则运算"><a href="#四则运算" class="headerlink" title="四则运算"></a>四则运算</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np.array([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>])</span><br><span class="line"><span class="selector-tag">b</span> = np.arange(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组a:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(a)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组b:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b)</span></span></span><br><span class="line">c = a-<span class="selector-tag">b</span>  #加减乘除运算都可以</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"运算结果："</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(c)</span></span></span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">数组a:</span><br><span class="line">[<span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">40</span>]</span><br><span class="line">数组b:</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">运算结果：</span><br><span class="line">[<span class="number">10</span> <span class="number">19</span> <span class="number">28</span> <span class="number">37</span>]</span><br></pre></td></tr></table></figure><br>其他类似</p><h3 id="平方"><a href="#平方" class="headerlink" title="平方"></a>平方</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np.array([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>])</span><br><span class="line"><span class="selector-tag">b</span> = np.arange(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组a:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(a)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组b:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"运算结果："</span>)</span></span></span><br><span class="line">c = a**<span class="selector-tag">b</span> #a的b次方</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(c)</span></span></span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">数组a:</span><br><span class="line">[<span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">40</span>]</span><br><span class="line">数组b:</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">运算结果：</span><br><span class="line">[    <span class="number">1</span>    <span class="number">20</span>   <span class="number">900</span> <span class="number">64000</span>]</span><br></pre></td></tr></table></figure></p><h3 id="三角函数"><a href="#三角函数" class="headerlink" title="三角函数"></a>三角函数</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np.array([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>])</span><br><span class="line"><span class="selector-tag">b</span> = np.arange(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组a:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(a)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组b:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"运算结果："</span>)</span></span></span><br><span class="line">c = <span class="number">10</span>*np.sin(a) #对于a的每个值sin 再乘<span class="number">10</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(c)</span></span></span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">数组a:</span><br><span class="line">[<span class="number">10</span> <span class="number">20</span> <span class="number">30</span> <span class="number">40</span>]</span><br><span class="line">数组b:</span><br><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">运算结果：</span><br><span class="line">[<span class="number">-5.44021111</span>  <span class="number">9.12945251</span> <span class="number">-9.88031624</span>  <span class="number">7.4511316</span> ]</span><br></pre></td></tr></table></figure></p><h3 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np.array([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>])</span><br><span class="line"><span class="selector-tag">b</span> = np.arange(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组b:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"运算结果："</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b&lt;<span class="number">3</span>)</span></span> #小于<span class="number">3</span>为true 否则为false</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">数组b:</span></span><br><span class="line"><span class="string">[0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span><span class="string">]</span></span><br><span class="line"><span class="string">运算结果：</span></span><br><span class="line"><span class="string">[</span> <span class="literal">True</span>  <span class="literal">True</span>  <span class="literal">True</span> <span class="literal">False</span><span class="string">]</span></span><br></pre></td></tr></table></figure></p><h3 id="逐个相乘"><a href="#逐个相乘" class="headerlink" title="逐个相乘"></a>逐个相乘</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np.array([[<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">              [<span class="number">0</span>,<span class="number">1</span>]])</span><br><span class="line"><span class="selector-tag">b</span> = np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组a:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(a)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组b:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b)</span></span></span><br><span class="line">c = a*<span class="selector-tag">b</span> #逐个相乘</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"运行结果："</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(c)</span></span></span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">数组a:</span><br><span class="line"><span class="string">[[1 1]</span></span><br><span class="line"><span class="string"> [0 1]]</span></span><br><span class="line">数组b:</span><br><span class="line"><span class="string">[[0 1]</span></span><br><span class="line"><span class="string"> [2 3]]</span></span><br><span class="line">运行结果：</span><br><span class="line"><span class="string">[[0 1]</span></span><br><span class="line"><span class="string"> [0 3]]</span></span><br></pre></td></tr></table></figure></p><h3 id="矩阵乘法"><a href="#矩阵乘法" class="headerlink" title="矩阵乘法"></a>矩阵乘法</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np.array([[<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">              [<span class="number">0</span>,<span class="number">1</span>]])</span><br><span class="line"><span class="selector-tag">b</span> = np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组a:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(a)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组b:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(b)</span></span></span><br><span class="line">c_dot = np.dot(<span class="selector-tag">a</span>,b) #矩阵乘法</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"运行结果："</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(c_dot)</span></span></span><br></pre></td></tr></table></figure><p>运算结果：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">数组a:</span><br><span class="line"><span class="string">[[1 1]</span></span><br><span class="line"><span class="string"> [0 1]]</span></span><br><span class="line">数组b:</span><br><span class="line"><span class="string">[[0 1]</span></span><br><span class="line"><span class="string"> [2 3]]</span></span><br><span class="line">运行结果：</span><br><span class="line"><span class="string">[[2 4]</span></span><br><span class="line"><span class="string"> [2 3]]</span></span><br></pre></td></tr></table></figure></p><h3 id="求和-最大-小-值"><a href="#求和-最大-小-值" class="headerlink" title="求和_最大(小)值"></a>求和_最大(小)值</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> = np<span class="selector-class">.random</span>.random((<span class="number">2</span>,<span class="number">4</span>))  #随机生成<span class="number">2</span>行<span class="number">4</span>列的矩阵</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"数组a:"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(a)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"行求和："</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.sum(a,axis=<span class="number">1</span>)</span></span>)  #axis=<span class="number">1</span>就是行求和</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"列求最小值"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.min(a,axis=<span class="number">0</span>)</span></span>) #axis=<span class="number">0</span>就是每列求最小值</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"求最大值"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.max(a)</span></span>)</span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">数组a:</span><br><span class="line">[[<span class="number">0.43408198</span> <span class="number">0.78606556</span> <span class="number">0.54177785</span> <span class="number">0.1037451</span> ]</span><br><span class="line"> [<span class="number">0.94012845</span> <span class="number">0.88517271</span> <span class="number">0.9114281</span>  <span class="number">0.56670466</span>]]</span><br><span class="line">行求和：</span><br><span class="line">[<span class="number">1.86567049</span> <span class="number">3.30343392</span>]</span><br><span class="line">列求最小值</span><br><span class="line">[<span class="number">0.43408198</span> <span class="number">0.78606556</span> <span class="number">0.54177785</span> <span class="number">0.1037451</span> ]</span><br><span class="line">求最大值</span><br><span class="line"><span class="number">0.9401284531215222</span></span><br></pre></td></tr></table></figure></p><h3 id="求索引"><a href="#求索引" class="headerlink" title="求索引"></a>求索引</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"最小值的索引"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.argmin(A)</span></span>) #求最小值的索引</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"最大值的索引"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.argmax(A)</span></span>)  #求最大值的索引</span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">最小值的索引</span><br><span class="line"><span class="number">0</span></span><br><span class="line">最大值的索引</span><br><span class="line"><span class="number">11</span></span><br></pre></td></tr></table></figure></p><h3 id="平均数-中位数"><a href="#平均数-中位数" class="headerlink" title="平均数_中位数"></a>平均数_中位数</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"平均数"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.mean(A)</span></span>)  #求平均值  A.mean()也可以 average()也是一样的</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"中位数"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.median(A)</span></span>)  #求中位数</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">平均数</span><br><span class="line"><span class="number">7.5</span></span><br><span class="line">中位数</span><br><span class="line"><span class="number">7.5</span></span><br></pre></td></tr></table></figure></p><h3 id="前n项和"><a href="#前n项和" class="headerlink" title="前n项和"></a>前n项和</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"前n项和"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.cumsum(A)</span></span>) #逐步累加 前n项和</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">前n项和</span><br><span class="line">[ <span class="number">2</span>  <span class="number">5</span>  <span class="number">9</span> <span class="number">14</span> <span class="number">20</span> <span class="number">27</span> <span class="number">35</span> <span class="number">44</span> <span class="number">54</span> <span class="number">65</span> <span class="number">77</span> <span class="number">90</span>]</span><br></pre></td></tr></table></figure></p><h3 id="逐差"><a href="#逐差" class="headerlink" title="逐差"></a>逐差</h3><p>就是前一个数减后一个数<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"逐步差"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.diff(A)</span></span>) #逐步差</span><br></pre></td></tr></table></figure><br>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">逐步差</span><br><span class="line">[[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]]</span><br></pre></td></tr></table></figure></p><h3 id="非0的数"><a href="#非0的数" class="headerlink" title="非0的数"></a>非0的数</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"非0的数"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.nonzero(A)</span></span>) #第一个array输出行数 第二个array输出列数 求非<span class="number">0</span>的数</span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">非<span class="number">0</span>的数</span><br><span class="line">(<span class="built_in">array</span>([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>], dtype=<span class="built_in">int</span>64), <span class="built_in">array</span>([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line"><span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], dtype=<span class="built_in">int</span>64))</span><br></pre></td></tr></table></figure><br>第一个array返回的是行的下标  第二个array返回的是列的下标</p><p>如果为0 则不返回</p><h3 id="逐行排序"><a href="#逐行排序" class="headerlink" title="逐行排序"></a>逐行排序</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A = [[<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>],</span><br><span class="line">     [<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>],</span><br><span class="line">     [<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]]</span><br><span class="line">print(A)</span><br><span class="line">print(<span class="string">"逐行排序"</span>)</span><br><span class="line">print(np.sort(A))  #排序 逐行排序</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>], [<span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]]</span><br><span class="line">逐行排序</span><br><span class="line">[[<span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]</span><br><span class="line"> [<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]</span><br></pre></td></tr></table></figure></p><h3 id="转置"><a href="#转置" class="headerlink" title="转置"></a>转置</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"矩阵的转置"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.transpose(A)</span></span>) #矩阵反向  也可以写成A<span class="selector-class">.T</span>  行变列 列变行 矩阵的转置</span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">矩阵的转置</span><br><span class="line">[[ <span class="number">2</span>  <span class="number">6</span> <span class="number">10</span>]</span><br><span class="line"> [ <span class="number">3</span>  <span class="number">7</span> <span class="number">11</span>]</span><br><span class="line"> [ <span class="number">4</span>  <span class="number">8</span> <span class="number">12</span>]</span><br><span class="line"> [ <span class="number">5</span>  <span class="number">9</span> <span class="number">13</span>]]</span><br></pre></td></tr></table></figure></p><h3 id="填充"><a href="#填充" class="headerlink" title="填充"></a>填充</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">print(A)</span><br><span class="line">print(<span class="string">"所有小于5的数都变成5 所有大于9的数都变成9  中间的数就正常保留"</span>)</span><br><span class="line">print(np.clip(A,<span class="number">5</span>,<span class="number">9</span>)) #所有小于<span class="number">5</span>的数都变成<span class="number">5</span> 所有大于<span class="number">9</span>的数都变成<span class="number">9</span>  中间的数就正常保留</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">所有小于<span class="number">5</span>的数都变成<span class="number">5</span> 所有大于<span class="number">9</span>的数都变成<span class="number">9</span>  中间的数就正常保留</span><br><span class="line">[[<span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span>]</span><br><span class="line"> [<span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]</span><br><span class="line"> [<span class="number">9</span> <span class="number">9</span> <span class="number">9</span> <span class="number">9</span>]]</span><br></pre></td></tr></table></figure></p><h3 id="对列平均运算"><a href="#对列平均运算" class="headerlink" title="对列平均运算"></a>对列平均运算</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">2</span>,<span class="number">14</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"对于列进行平均运算"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.mean(A,axis=<span class="number">0</span>)</span></span>) #对于列进行平均运算</span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>]</span><br><span class="line"> [ <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span>]</span><br><span class="line"> [<span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span>]]</span><br><span class="line">对于列进行平均运算</span><br><span class="line">[<span class="number">6.</span> <span class="number">7.</span> <span class="number">8.</span> <span class="number">9.</span>]</span><br></pre></td></tr></table></figure></p><h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">3</span>,<span class="number">15</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"输出第2行"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[<span class="number">2</span>])</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"输出第2行第1个元素"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[<span class="number">2</span>,<span class="number">1</span>])</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"输出第1行第1个元素"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[<span class="number">1</span>][<span class="number">1</span>])</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"输出第2行的所有数"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[<span class="number">2</span>,:])</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"输出第1列的所有数"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[:,<span class="number">1</span>])</span></span></span><br></pre></td></tr></table></figure><p>运行结果<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>]</span><br><span class="line"> [ <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span>]</span><br><span class="line"> [<span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]]</span><br><span class="line">输出第<span class="number">2</span>行</span><br><span class="line">[<span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]</span><br><span class="line">输出第<span class="number">2</span>行第<span class="number">1</span>个元素</span><br><span class="line"><span class="number">12</span></span><br><span class="line">输出第<span class="number">1</span>行第<span class="number">1</span>个元素</span><br><span class="line"><span class="number">8</span></span><br><span class="line">输出第<span class="number">2</span>行的所有数</span><br><span class="line">[<span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]</span><br><span class="line">输出第<span class="number">1</span>列的所有数</span><br><span class="line">[ <span class="number">4</span>  <span class="number">8</span> <span class="number">12</span>]</span><br></pre></td></tr></table></figure></p><h3 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">3</span>,<span class="number">15</span>).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"转置后输出列"</span>)</span></span></span><br><span class="line"><span class="keyword">for</span> column <span class="keyword">in</span> A<span class="selector-class">.T</span>:  #利用转置来输出</span><br><span class="line">    print(column)  #输出列</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"输出行"</span>)</span></span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> A:</span><br><span class="line">    print(row)  #输出行</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"迭代每一个元素以列表形式返回"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A.flatten()</span></span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"迭代每个元素"</span>)</span></span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> A<span class="selector-class">.flat</span>:</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>]</span><br><span class="line"> [ <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span>]</span><br><span class="line"> [<span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]]</span><br><span class="line">转置后输出列</span><br><span class="line">[ <span class="number">3</span>  <span class="number">7</span> <span class="number">11</span>]</span><br><span class="line">[ <span class="number">4</span>  <span class="number">8</span> <span class="number">12</span>]</span><br><span class="line">[ <span class="number">5</span>  <span class="number">9</span> <span class="number">13</span>]</span><br><span class="line">[ <span class="number">6</span> <span class="number">10</span> <span class="number">14</span>]</span><br><span class="line">输出行</span><br><span class="line">[<span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line">[ <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span>]</span><br><span class="line">[<span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]</span><br><span class="line">迭代每一个元素以列表形式返回</span><br><span class="line">[ <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]</span><br><span class="line">迭代每个元素</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">11</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="number">13</span></span><br><span class="line"><span class="number">14</span></span><br></pre></td></tr></table></figure></p><h2 id="array的合并"><a href="#array的合并" class="headerlink" title="array的合并"></a>array的合并</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">A = np.array([<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>])</span><br><span class="line">B = np.array([<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"垂直合并"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.vstack((A,B)</span></span>))  #数组上下合并</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"水平合并"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(np.hstack((A,B)</span></span>)) #数组左右合并</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"行方面加了一个维度"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[np.newaxis,:])</span></span> #在行方面加了一个维度</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[np.newaxis,:].shape)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"列方面加了一个维度"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[:,np.newaxis])</span></span> #在列方面加了一个维度</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(A[:,np.newaxis].shape)</span></span></span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">垂直合并</span><br><span class="line">[[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">2</span> <span class="number">2</span>]]</span><br><span class="line">水平合并</span><br><span class="line">[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span>]</span><br><span class="line">行方面加了一个维度</span><br><span class="line">[[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]]</span><br><span class="line">(<span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">列方面加了一个维度</span><br><span class="line">[[<span class="number">1</span>]</span><br><span class="line"> [<span class="number">1</span>]</span><br><span class="line"> [<span class="number">1</span>]]</span><br><span class="line">(<span class="number">3</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure></p><h3 id="多array合并"><a href="#多array合并" class="headerlink" title="多array合并"></a>多array合并</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A = np.<span class="built_in">array</span>([<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>])[:,np.newaxis]</span><br><span class="line">B = np.<span class="built_in">array</span>([<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>])[:,np.newaxis]</span><br><span class="line"></span><br><span class="line">C = np.concatenate((A,B,B,A),axis=<span class="number">1</span>) #多个<span class="built_in">array</span>合并  axis=<span class="number">0</span>垂直合并  axis=<span class="number">1</span>水平合并</span><br><span class="line">print(C)</span><br></pre></td></tr></table></figure><p>运行结果:<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span>]]</span><br></pre></td></tr></table></figure></p><h2 id="array分割"><a href="#array分割" class="headerlink" title="array分割"></a>array分割</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(12).reshape((3,4))</span><br><span class="line"><span class="builtin-name">print</span>(A)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"垂直分割"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(np.split(A,2,<span class="attribute">axis</span>=1)) #<span class="attribute">axis</span>=1 垂直分割</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"水平分割"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(np.split(A,3,<span class="attribute">axis</span>=0)) # <span class="attribute">axis</span>=0 水平分割</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"水平分割"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(np.vsplit(A,3)) #水平分割</span><br><span class="line"><span class="builtin-name">print</span>(<span class="string">"垂直分割"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(np.hsplit(A,2)) #垂直分割</span><br></pre></td></tr></table></figure><p>运行结果：<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>]</span><br><span class="line"> [ <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>]</span><br><span class="line"> [ <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span>]]</span><br><span class="line">垂直分割</span><br><span class="line">[<span class="built_in">array</span>([[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">       [<span class="number">8</span>, <span class="number">9</span>]]), <span class="built_in">array</span>([[ <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">       [<span class="number">10</span>, <span class="number">11</span>]])]</span><br><span class="line">水平分割</span><br><span class="line">[<span class="built_in">array</span>([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]), <span class="built_in">array</span>([[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]]), <span class="built_in">array</span>([[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]])]</span><br><span class="line">水平分割</span><br><span class="line">[<span class="built_in">array</span>([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]), <span class="built_in">array</span>([[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]]), <span class="built_in">array</span>([[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]])]</span><br><span class="line">垂直分割</span><br><span class="line">[<span class="built_in">array</span>([[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">       [<span class="number">8</span>, <span class="number">9</span>]]), <span class="built_in">array</span>([[ <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">       [<span class="number">10</span>, <span class="number">11</span>]])]</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;numpy&quot;&gt;&lt;a href=&quot;#numpy&quot; class=&quot;headerlink&quot; title=&quot;numpy&quot;&gt;&lt;/a&gt;numpy&lt;/h1&gt;&lt;h2 id=&quot;属性&quot;&gt;&lt;a href=&quot;#属性&quot; class=&quot;headerlink&quot; title=&quot;属性&quot;&gt;&lt;/a&gt;属
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="Python3" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/Python3/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2021/2/21-图形验证码</title>
    <link href="http://yoursite.com/2021/02/21/Shiro-2020-2-21-%E5%9B%BE%E5%BD%A2%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
    <id>http://yoursite.com/2021/02/21/Shiro-2020-2-21-%E5%9B%BE%E5%BD%A2%E9%AA%8C%E8%AF%81%E7%A0%81/</id>
    <published>2021-02-21T08:11:01.000Z</published>
    <updated>2021-02-21T12:09:11.329Z</updated>
    
    <content type="html"><![CDATA[<p><del>我是一只鸽子 咕咕咕</del></p><h1 id="图形验证码"><a href="#图形验证码" class="headerlink" title="图形验证码"></a>图形验证码</h1><p>图片验证码就不多介绍了<br>修改login.jsp<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@page</span> <span class="attr">contentType</span>=<span class="string">"text/html; UTF-8"</span> <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!doctype html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span></span><br><span class="line"><span class="xml">          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>用户登录<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageContext.request.contextPath&#125;</span><span class="xml"><span class="tag"><span class="string">/user/login"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> &gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        密码  : <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        请输入验证码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"code"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageContext.request.contextPath&#125;</span><span class="xml"><span class="tag"><span class="string">/user/getImage"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>接下来就需要构建验证码的工具类<br>在utils下新建VerifyCodeUtils.java<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.utils;</span><br><span class="line"></span><br><span class="line">import javax.imageio.ImageIO;</span><br><span class="line">import java.awt.*;</span><br><span class="line">import java.awt.geom.AffineTransform;</span><br><span class="line">import java.awt.image.BufferedImage;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *@创建人  cx</span></span><br><span class="line"><span class="comment"> *@创建时间  2018/11/27 17:36</span></span><br><span class="line"><span class="comment"> *@描述   验证码生成</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="keyword">class</span> VerifyCodeUtils&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用到Algerian字体，系统里没有的话需要安装字体，字体只显示大写，去掉了1,0,i,o几个容易混淆的字符</span></span><br><span class="line">    public static final String VERIFY_CODES = <span class="string">"23456789ABCDEFGHJKLMNPQRSTUVWXYZ"</span>;</span><br><span class="line">    <span class="keyword">private</span> static Random random = <span class="keyword">new</span> <span class="constructor">Random()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用系统默认字符源生成验证码</span></span><br><span class="line"><span class="comment">     * @param verifySize    验证码长度</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public static String generate<span class="constructor">VerifyCode(<span class="params">int</span> <span class="params">verifySize</span>)</span>&#123;</span><br><span class="line">        return generate<span class="constructor">VerifyCode(<span class="params">verifySize</span>, VERIFY_CODES)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用指定源生成验证码</span></span><br><span class="line"><span class="comment">     * @param verifySize    验证码长度</span></span><br><span class="line"><span class="comment">     * @param sources   验证码字符源</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public static String generate<span class="constructor">VerifyCode(<span class="params">int</span> <span class="params">verifySize</span>, String <span class="params">sources</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(sources<span class="operator"> == </span>null<span class="operator"> || </span>sources.length<span class="literal">()</span><span class="operator"> == </span><span class="number">0</span>)&#123;</span><br><span class="line">            sources = VERIFY_CODES;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> codesLen = sources.length<span class="literal">()</span>;</span><br><span class="line">        Random rand = <span class="keyword">new</span> <span class="constructor">Random(System.<span class="params">currentTimeMillis</span>()</span>);</span><br><span class="line">        StringBuilder verifyCode = <span class="keyword">new</span> <span class="constructor">StringBuilder(<span class="params">verifySize</span>)</span>;</span><br><span class="line">        for(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; verifySize; i++)&#123;</span><br><span class="line">            verifyCode.append(sources.<span class="built_in">char</span><span class="constructor">At(<span class="params">rand</span>.<span class="params">nextInt</span>(<span class="params">codesLen</span>-1)</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        return verifyCode.<span class="keyword">to</span><span class="constructor">String()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成随机验证码文件,并返回验证码值</span></span><br><span class="line"><span class="comment">     * @param w</span></span><br><span class="line"><span class="comment">     * @param h</span></span><br><span class="line"><span class="comment">     * @param outputFile</span></span><br><span class="line"><span class="comment">     * @param verifySize</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     * @throws IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public static String output<span class="constructor">VerifyImage(<span class="params">int</span> <span class="params">w</span>, <span class="params">int</span> <span class="params">h</span>, File <span class="params">outputFile</span>, <span class="params">int</span> <span class="params">verifySize</span>)</span> throws IOException&#123;</span><br><span class="line">        String verifyCode = generate<span class="constructor">VerifyCode(<span class="params">verifySize</span>)</span>;</span><br><span class="line">        output<span class="constructor">Image(<span class="params">w</span>, <span class="params">h</span>, <span class="params">outputFile</span>, <span class="params">verifyCode</span>)</span>;</span><br><span class="line">        return verifyCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出随机验证码图片流,并返回验证码值</span></span><br><span class="line"><span class="comment">     * @param w</span></span><br><span class="line"><span class="comment">     * @param h</span></span><br><span class="line"><span class="comment">     * @param os</span></span><br><span class="line"><span class="comment">     * @param verifySize</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     * @throws IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public static String output<span class="constructor">VerifyImage(<span class="params">int</span> <span class="params">w</span>, <span class="params">int</span> <span class="params">h</span>, OutputStream <span class="params">os</span>, <span class="params">int</span> <span class="params">verifySize</span>)</span> throws IOException&#123;</span><br><span class="line">        String verifyCode = generate<span class="constructor">VerifyCode(<span class="params">verifySize</span>)</span>;</span><br><span class="line">        output<span class="constructor">Image(<span class="params">w</span>, <span class="params">h</span>, <span class="params">os</span>, <span class="params">verifyCode</span>)</span>;</span><br><span class="line">        return verifyCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成指定验证码图像文件</span></span><br><span class="line"><span class="comment">     * @param w</span></span><br><span class="line"><span class="comment">     * @param h</span></span><br><span class="line"><span class="comment">     * @param outputFile</span></span><br><span class="line"><span class="comment">     * @param code</span></span><br><span class="line"><span class="comment">     * @throws IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public static void output<span class="constructor">Image(<span class="params">int</span> <span class="params">w</span>, <span class="params">int</span> <span class="params">h</span>, File <span class="params">outputFile</span>, String <span class="params">code</span>)</span> throws IOException&#123;</span><br><span class="line">        <span class="keyword">if</span>(outputFile<span class="operator"> == </span>null)&#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        File dir = outputFile.get<span class="constructor">ParentFile()</span>;</span><br><span class="line">        <span class="keyword">if</span>(!dir.exists<span class="literal">()</span>)&#123;</span><br><span class="line">            dir.mkdirs<span class="literal">()</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            outputFile.create<span class="constructor">NewFile()</span>;</span><br><span class="line">            FileOutputStream fos = <span class="keyword">new</span> <span class="constructor">FileOutputStream(<span class="params">outputFile</span>)</span>;</span><br><span class="line">            output<span class="constructor">Image(<span class="params">w</span>, <span class="params">h</span>, <span class="params">fos</span>, <span class="params">code</span>)</span>;</span><br><span class="line">            fos.close<span class="literal">()</span>;</span><br><span class="line">        &#125; catch(IOException e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 输出指定验证码图片流</span></span><br><span class="line"><span class="comment">     * @param w</span></span><br><span class="line"><span class="comment">     * @param h</span></span><br><span class="line"><span class="comment">     * @param os</span></span><br><span class="line"><span class="comment">     * @param code</span></span><br><span class="line"><span class="comment">     * @throws IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public static void output<span class="constructor">Image(<span class="params">int</span> <span class="params">w</span>, <span class="params">int</span> <span class="params">h</span>, OutputStream <span class="params">os</span>, String <span class="params">code</span>)</span> throws IOException&#123;</span><br><span class="line">        <span class="built_in">int</span> verifySize = code.length<span class="literal">()</span>;</span><br><span class="line">        BufferedImage image = <span class="keyword">new</span> <span class="constructor">BufferedImage(<span class="params">w</span>, <span class="params">h</span>, BufferedImage.TYPE_INT_RGB)</span>;</span><br><span class="line">        Random rand = <span class="keyword">new</span> <span class="constructor">Random()</span>;</span><br><span class="line">        Graphics2D g2 = image.create<span class="constructor">Graphics()</span>;</span><br><span class="line">        g2.set<span class="constructor">RenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON)</span>;</span><br><span class="line">        Color<span class="literal">[]</span> colors = <span class="keyword">new</span> Color<span class="literal">[<span class="number">5</span>]</span>;</span><br><span class="line">        Color<span class="literal">[]</span> colorSpaces = <span class="keyword">new</span> Color<span class="literal">[]</span> &#123; Color.WHITE, Color.CYAN,</span><br><span class="line">                Color.GRAY, Color.LIGHT_GRAY, Color.MAGENTA, Color.ORANGE,</span><br><span class="line">                Color.PINK, Color.YELLOW &#125;;</span><br><span class="line">        <span class="built_in">float</span><span class="literal">[]</span> fractions = <span class="keyword">new</span> <span class="built_in">float</span><span class="literal">[<span class="identifier">colors</span>.<span class="identifier">length</span>]</span>;</span><br><span class="line">        for(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; colors.length; i++)&#123;</span><br><span class="line">            colors<span class="literal">[<span class="identifier">i</span>]</span> = colorSpaces<span class="literal">[<span class="identifier">rand</span>.<span class="identifier">nextInt</span>(<span class="identifier">colorSpaces</span>.<span class="identifier">length</span>)]</span>;</span><br><span class="line">            fractions<span class="literal">[<span class="identifier">i</span>]</span> = rand.next<span class="constructor">Float()</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">Arrays</span>.</span></span>sort(fractions);</span><br><span class="line"></span><br><span class="line">        g2.set<span class="constructor">Color(Color.GRAY)</span>;<span class="comment">// 设置边框色</span></span><br><span class="line">        g2.fill<span class="constructor">Rect(0, 0, <span class="params">w</span>, <span class="params">h</span>)</span>;</span><br><span class="line"></span><br><span class="line">        Color c = get<span class="constructor">RandColor(200, 250)</span>;</span><br><span class="line">        g2.set<span class="constructor">Color(<span class="params">c</span>)</span>;<span class="comment">// 设置背景色</span></span><br><span class="line">        g2.fill<span class="constructor">Rect(0, 2, <span class="params">w</span>, <span class="params">h</span>-4)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘制干扰线</span></span><br><span class="line">        Random random = <span class="keyword">new</span> <span class="constructor">Random()</span>;</span><br><span class="line">        g2.set<span class="constructor">Color(<span class="params">getRandColor</span>(160, 200)</span>);<span class="comment">// 设置线条的颜色</span></span><br><span class="line">        for (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            <span class="built_in">int</span> x = random.next<span class="constructor">Int(<span class="params">w</span> - 1)</span>;</span><br><span class="line">            <span class="built_in">int</span> y = random.next<span class="constructor">Int(<span class="params">h</span> - 1)</span>;</span><br><span class="line">            <span class="built_in">int</span> xl = random.next<span class="constructor">Int(6)</span> + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">int</span> yl = random.next<span class="constructor">Int(12)</span> + <span class="number">1</span>;</span><br><span class="line">            g2.draw<span class="constructor">Line(<span class="params">x</span>, <span class="params">y</span>, <span class="params">x</span> + <span class="params">xl</span> + 40, <span class="params">y</span> + <span class="params">yl</span> + 20)</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加噪点</span></span><br><span class="line">        <span class="built_in">float</span> yawpRate = <span class="number">0.05</span>f;<span class="comment">// 噪声率</span></span><br><span class="line">        <span class="built_in">int</span> area = (<span class="built_in">int</span>) (yawpRate<span class="operator"> * </span>w<span class="operator"> * </span>h);</span><br><span class="line">        for (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; area; i++) &#123;</span><br><span class="line">            <span class="built_in">int</span> x = random.next<span class="constructor">Int(<span class="params">w</span>)</span>;</span><br><span class="line">            <span class="built_in">int</span> y = random.next<span class="constructor">Int(<span class="params">h</span>)</span>;</span><br><span class="line">            <span class="built_in">int</span> rgb = get<span class="constructor">RandomIntColor()</span>;</span><br><span class="line">            image.set<span class="constructor">RGB(<span class="params">x</span>, <span class="params">y</span>, <span class="params">rgb</span>)</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        shear(g2, w, h, c);<span class="comment">// 使图片扭曲</span></span><br><span class="line"></span><br><span class="line">        g2.set<span class="constructor">Color(<span class="params">getRandColor</span>(100, 160)</span>);</span><br><span class="line">        <span class="built_in">int</span> fontSize = h-<span class="number">4</span>;</span><br><span class="line">        Font font = <span class="keyword">new</span> <span class="constructor">Font(<span class="string">"Algerian"</span>, Font.ITALIC, <span class="params">fontSize</span>)</span>;</span><br><span class="line">        g2.set<span class="constructor">Font(<span class="params">font</span>)</span>;</span><br><span class="line">        <span class="built_in">char</span><span class="literal">[]</span> chars = code.<span class="keyword">to</span><span class="constructor">CharArray()</span>;</span><br><span class="line">        for(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; verifySize; i++)&#123;</span><br><span class="line">            AffineTransform affine = <span class="keyword">new</span> <span class="constructor">AffineTransform()</span>;</span><br><span class="line">            affine.set<span class="constructor">ToRotation(Math.PI <span class="operator">/</span> 4 <span class="operator">*</span> <span class="params">rand</span>.<span class="params">nextDouble</span>()</span><span class="operator"> * </span>(rand.next<span class="constructor">Boolean()</span> ? <span class="number">1</span> : -<span class="number">1</span>), (w<span class="operator"> / </span>verifySize)<span class="operator"> * </span>i + fontSize/<span class="number">2</span>, h/<span class="number">2</span>);</span><br><span class="line">            g2.set<span class="constructor">Transform(<span class="params">affine</span>)</span>;</span><br><span class="line">            g2.draw<span class="constructor">Chars(<span class="params">chars</span>, <span class="params">i</span>, 1, ((<span class="params">w</span>-10)</span><span class="operator"> / </span>verifySize)<span class="operator"> * </span>i + <span class="number">5</span>, h/<span class="number">2</span> + fontSize/<span class="number">2</span> - <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        g2.dispose<span class="literal">()</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">ImageIO</span>.</span></span>write(image, <span class="string">"jpg"</span>, os);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> static Color get<span class="constructor">RandColor(<span class="params">int</span> <span class="params">fc</span>, <span class="params">int</span> <span class="params">bc</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (fc &gt; <span class="number">255</span>)</span><br><span class="line">            fc = <span class="number">255</span>;</span><br><span class="line">        <span class="keyword">if</span> (bc &gt; <span class="number">255</span>)</span><br><span class="line">            bc = <span class="number">255</span>;</span><br><span class="line">        <span class="built_in">int</span> r = fc + random.next<span class="constructor">Int(<span class="params">bc</span> - <span class="params">fc</span>)</span>;</span><br><span class="line">        <span class="built_in">int</span> g = fc + random.next<span class="constructor">Int(<span class="params">bc</span> - <span class="params">fc</span>)</span>;</span><br><span class="line">        <span class="built_in">int</span> b = fc + random.next<span class="constructor">Int(<span class="params">bc</span> - <span class="params">fc</span>)</span>;</span><br><span class="line">        return <span class="keyword">new</span> <span class="constructor">Color(<span class="params">r</span>, <span class="params">g</span>, <span class="params">b</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> static <span class="built_in">int</span> get<span class="constructor">RandomIntColor()</span> &#123;</span><br><span class="line">        <span class="built_in">int</span><span class="literal">[]</span> rgb = get<span class="constructor">RandomRgb()</span>;</span><br><span class="line">        <span class="built_in">int</span> color = <span class="number">0</span>;</span><br><span class="line">        for (<span class="built_in">int</span> c : rgb) &#123;</span><br><span class="line">            color = color &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            color = color <span class="pattern-match">| c;</span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br><span class="line"><span class="pattern-match">        return color;</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">private</span> static <span class="built_in">int</span>[] get<span class="constructor">RandomRgb()</span> &#123;</span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span>[] rgb = <span class="keyword">new</span> <span class="built_in">int</span>[3];</span></span><br><span class="line"><span class="pattern-match">        for (<span class="built_in">int</span> i = 0; i &lt; 3; i<span class="operator">++</span>) &#123;</span></span><br><span class="line"><span class="pattern-match">            rgb[i] = random.next<span class="constructor">Int(255)</span>;</span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br><span class="line"><span class="pattern-match">        return rgb;</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">private</span> static void shear(<span class="constructor">Graphics</span> g, <span class="built_in">int</span> w1, <span class="built_in">int</span> h1, <span class="constructor">Color</span> color) &#123;</span></span><br><span class="line"><span class="pattern-match">        shear<span class="constructor">X(<span class="params">g</span>, <span class="params">w1</span>, <span class="params">h1</span>, <span class="params">color</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        shear<span class="constructor">Y(<span class="params">g</span>, <span class="params">w1</span>, <span class="params">h1</span>, <span class="params">color</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">private</span> static void shear<span class="constructor">X(Graphics <span class="params">g</span>, <span class="params">int</span> <span class="params">w1</span>, <span class="params">int</span> <span class="params">h1</span>, Color <span class="params">color</span>)</span> &#123;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> period = random.next<span class="constructor">Int(2)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        boolean border<span class="constructor">Gap</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> frames = 1;</span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> phase = random.next<span class="constructor">Int(2)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        for (<span class="built_in">int</span> i = 0; i &lt; h1; i<span class="operator">++</span>) &#123;</span></span><br><span class="line"><span class="pattern-match">            double d = (double) (period &gt;&gt; 1)</span></span><br><span class="line"><span class="pattern-match">                    <span class="operator">*</span> <span class="constructor">Math</span>.sin((double) i <span class="operator">/</span> (double) period</span></span><br><span class="line"><span class="pattern-match">                    + (6.2831853071795862<span class="constructor">D</span> <span class="operator">*</span> (double) phase)</span></span><br><span class="line"><span class="pattern-match">                    <span class="operator">/</span> (double) frames);</span></span><br><span class="line"><span class="pattern-match">            g.copy<span class="constructor">Area(0, <span class="params">i</span>, <span class="params">w1</span>, 1, (<span class="params">int</span>)</span> d, 0);</span></span><br><span class="line"><span class="pattern-match">            <span class="keyword">if</span> (border<span class="constructor">Gap</span>) &#123;</span></span><br><span class="line"><span class="pattern-match">                g.set<span class="constructor">Color(<span class="params">color</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">                g.draw<span class="constructor">Line((<span class="params">int</span>)</span> d, i, 0, i);</span></span><br><span class="line"><span class="pattern-match">                g.draw<span class="constructor">Line((<span class="params">int</span>)</span> d + w1, i, w1, i);</span></span><br><span class="line"><span class="pattern-match">            &#125;</span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">private</span> static void shear<span class="constructor">Y(Graphics <span class="params">g</span>, <span class="params">int</span> <span class="params">w1</span>, <span class="params">int</span> <span class="params">h1</span>, Color <span class="params">color</span>)</span> &#123;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> period = random.next<span class="constructor">Int(40)</span> + 10; <span class="operator">/</span><span class="operator">/</span> 50;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        boolean border<span class="constructor">Gap</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> frames = 20;</span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> phase = 7;</span></span><br><span class="line"><span class="pattern-match">        for (<span class="built_in">int</span> i = 0; i &lt; w1; i<span class="operator">++</span>) &#123;</span></span><br><span class="line"><span class="pattern-match">            double d = (double) (period &gt;&gt; 1)</span></span><br><span class="line"><span class="pattern-match">                    <span class="operator">*</span> <span class="constructor">Math</span>.sin((double) i <span class="operator">/</span> (double) period</span></span><br><span class="line"><span class="pattern-match">                    + (6.2831853071795862<span class="constructor">D</span> <span class="operator">*</span> (double) phase)</span></span><br><span class="line"><span class="pattern-match">                    <span class="operator">/</span> (double) frames);</span></span><br><span class="line"><span class="pattern-match">            g.copy<span class="constructor">Area(<span class="params">i</span>, 0, 1, <span class="params">h1</span>, 0, (<span class="params">int</span>)</span> d);</span></span><br><span class="line"><span class="pattern-match">            <span class="keyword">if</span> (border<span class="constructor">Gap</span>) &#123;</span></span><br><span class="line"><span class="pattern-match">                g.set<span class="constructor">Color(<span class="params">color</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">                g.draw<span class="constructor">Line(<span class="params">i</span>, (<span class="params">int</span>)</span> d, i, 0);</span></span><br><span class="line"><span class="pattern-match">                g.draw<span class="constructor">Line(<span class="params">i</span>, (<span class="params">int</span>)</span> d + h1, i, h1);</span></span><br><span class="line"><span class="pattern-match">            &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match">    public static void main(<span class="constructor">String</span>[] args) throws <span class="constructor">IOException</span> &#123;</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span>获取验证码</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">String</span> s = generate<span class="constructor">VerifyCode(4)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span>将验证码放入图片中</span></span><br><span class="line"><span class="pattern-match">        output<span class="constructor">Image(260,60,<span class="params">new</span> File(<span class="string">"/Users/chenyannan/Desktop/安工资料/aa.jpg"</span>)</span>,s);</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">System</span>.out.println(s);</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match">&#125;</span></span><br></pre></td></tr></table></figure><br>这样就做好了</p><p>到这里shiro就全部结束了 <del>虽然还有一个thymeleaf 但是我不想学了</del></p><p><a href="/download/springboot_jsp_shiro.zip">源码下载</a></p><p>🌸🌸🌸完结撒花🌸🌸🌸</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;del&gt;我是一只鸽子 咕咕咕&lt;/del&gt;&lt;/p&gt;
&lt;h1 id=&quot;图形验证码&quot;&gt;&lt;a href=&quot;#图形验证码&quot; class=&quot;headerlink&quot; title=&quot;图形验证码&quot;&gt;&lt;/a&gt;图形验证码&lt;/h1&gt;&lt;p&gt;图片验证码就不多介绍了&lt;br&gt;修改login.jsp&lt;br
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/12/9-缓存</title>
    <link href="http://yoursite.com/2020/12/09/Shiro-2020-12-9-EhCache%E5%AE%9E%E7%8E%B0/"/>
    <id>http://yoursite.com/2020/12/09/Shiro-2020-12-9-EhCache%E5%AE%9E%E7%8E%B0/</id>
    <published>2020-12-09T05:11:47.000Z</published>
    <updated>2021-02-21T08:22:21.501Z</updated>
    
    <content type="html"><![CDATA[<h1 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h1><p>页面中权限的数据每次访问都会与数据库进行一次交互 这样就导致用户数量多的时候 访问量大的时候  就会导致数据库压力过大</p><p>所以为了避免这种问题  就需要给权限的数据加缓存  这样需要权限的时候对于已经授权的用户就不用与数据库交互  直接在缓存中去找对应的权限就好了  可以尽量减轻数据库的压力</p><h2 id="CacheManager"><a href="#CacheManager" class="headerlink" title="CacheManager"></a>CacheManager</h2><h3 id="Cache作用"><a href="#Cache作用" class="headerlink" title="Cache作用"></a>Cache作用</h3><ul><li><p>Cache缓存：计算机内存中一段数据 内存条</p></li><li><p>作用：用来减轻DB的访问压力，从而提高系统的查询效率</p></li><li><p>流程：<br><img src="/img/JavaWeb/12-9学习日记/0.png" alt="avatar"></p></li></ul><p>这里要注意 只有查询次数多并且增删改极少的数据才适合存入缓存中</p><h3 id="EhCache实现缓存"><a href="#EhCache实现缓存" class="headerlink" title="EhCache实现缓存"></a>EhCache实现缓存</h3><ol><li>引入依赖</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--        shiro-ehcache--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>开启缓存管理</li></ol><p>在ShiroConfig中开启缓存管理<br>添加代码<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开启缓存管理</span></span><br><span class="line">customerRealm.set<span class="constructor">CacheManager(<span class="params">new</span> RedisCacheManager()</span>);</span><br><span class="line">customerRealm.set<span class="constructor">CachingEnabled(<span class="params">true</span>)</span>;<span class="comment">//开启全局缓存</span></span><br><span class="line">customerRealm.set<span class="constructor">AuthenticationCachingEnabled(<span class="params">true</span>)</span>;<span class="comment">//认证认证缓存</span></span><br><span class="line">customerRealm.set<span class="constructor">AuthenticationCacheName(<span class="string">"authenticationCache"</span>)</span>;</span><br><span class="line">customerRealm.set<span class="constructor">AuthorizationCachingEnabled(<span class="params">true</span>)</span>;<span class="comment">//开启授权缓存</span></span><br><span class="line">customerRealm.set<span class="constructor">AuthorizationCacheName(<span class="string">"authorizationCache"</span>)</span>;</span><br></pre></td></tr></table></figure><br>开启之后 只有第一次会操作我们的数据库 之后就不会操作数据库了 因为已经存到了缓存当中<br>但是使用这样的方法会有个缺点，就是如果当服务器断电或宕机时，重新访问依然会操作数据库，所以可以使用Redis来实现一个分布式缓存</p><h3 id="Redis实现缓存"><a href="#Redis实现缓存" class="headerlink" title="Redis实现缓存"></a>Redis实现缓存</h3><ol><li>引入redis依赖<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--redis整合springboot--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>配置redis连接<br>注意进行这步之前 需要先安装redis 确保正常运行<br>在application.properties添加<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.redis.port</span>=<span class="number">6379</span></span><br><span class="line"><span class="attr">spring.redis.host</span>=localhost</span><br><span class="line"><span class="attr">spring.redis.database</span>=<span class="number">0</span></span><br></pre></td></tr></table></figure></li><li>自定义缓存管理器</li></ol><p>先在shiro下创建一个新的包cache<br>新建一个RedisCacheManager.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.shiro.cache;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.Cache;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.CacheException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.CacheManager;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义shiro缓存管理器</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisCacheManager</span> <span class="keyword">implements</span> <span class="title">CacheManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//参数1:认证或者是授权缓存的统一名称</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;K, V&gt; <span class="function">Cache&lt;K, V&gt; <span class="title">getCache</span><span class="params">(String cacheName)</span> <span class="keyword">throws</span> CacheException </span>&#123;</span><br><span class="line">        System.out.println(cacheName);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RedisCache&lt;K,V&gt;(cacheName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个时候就可以修改ShiroConfig的缓存管理器指定我们自定义的Redis管理器<br>ShiroConfig<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">customerRealm.setCacheManager(<span class="keyword">new</span> <span class="type">RedisCacheManager</span>());</span><br></pre></td></tr></table></figure><br>再写一个RedisCache.java  这个才是真正实现缓存的操作</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.shiro.cache;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.utils.ApplicationContextUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.Cache;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.CacheException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.<span class="keyword">data</span>.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.<span class="keyword">data</span>.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义redis缓存的实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisCache</span>&lt;<span class="type">k,v</span>&gt; <span class="title">implements</span> <span class="title">Cache</span>&lt;<span class="type">k,v</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String cacheName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> RedisCache() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> RedisCache(String cacheName) &#123;</span><br><span class="line">        <span class="keyword">this</span>.cacheName = cacheName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> v <span class="keyword">get</span>(k k) throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"get key:"</span>+k);</span><br><span class="line">        <span class="keyword">return</span> (v) getRedisTemplate().opsForHash().<span class="keyword">get</span>(<span class="keyword">this</span>.cacheName,k.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> v put(k k, v v) throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"put key: "</span>+k);</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"put value:"</span>+v);</span><br><span class="line">        getRedisTemplate().opsForHash().put(<span class="keyword">this</span>.cacheName,k.toString(),v);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> v remove(k k) throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"=============remove============="</span>);</span><br><span class="line">        <span class="keyword">return</span> (v) getRedisTemplate().opsForHash().delete(<span class="keyword">this</span>.cacheName,k.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> void clear() throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"=============clear=============="</span>);</span><br><span class="line">        getRedisTemplate().delete(<span class="keyword">this</span>.cacheName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> int size() &#123;</span><br><span class="line">        <span class="keyword">return</span> getRedisTemplate().opsForHash().size(<span class="keyword">this</span>.cacheName).intValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;k&gt; keys() &#123;</span><br><span class="line">        <span class="keyword">return</span> getRedisTemplate().opsForHash().keys(<span class="keyword">this</span>.cacheName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;v&gt; values() &#123;</span><br><span class="line">        <span class="keyword">return</span> getRedisTemplate().opsForHash().values(<span class="keyword">this</span>.cacheName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate getRedisTemplate()&#123;</span><br><span class="line">        RedisTemplate redisTemplate = (RedisTemplate) ApplicationContextUtils.getBean(<span class="string">"redisTemplate"</span>);</span><br><span class="line">        redisTemplate.setKeySerializer(new StringRedisSerializer());</span><br><span class="line">        redisTemplate.setHashKeySerializer(new StringRedisSerializer());</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.shiro.cache;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.utils.ApplicationContextUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.Cache;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.cache.CacheException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.<span class="keyword">data</span>.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.<span class="keyword">data</span>.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义redis缓存的实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisCache</span>&lt;<span class="type">k,v</span>&gt; <span class="title">implements</span> <span class="title">Cache</span>&lt;<span class="type">k,v</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String cacheName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> RedisCache() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> RedisCache(String cacheName) &#123;</span><br><span class="line">        <span class="keyword">this</span>.cacheName = cacheName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> v <span class="keyword">get</span>(k k) throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"get key:"</span>+k);</span><br><span class="line">        <span class="keyword">return</span> (v) getRedisTemplate().opsForHash().<span class="keyword">get</span>(<span class="keyword">this</span>.cacheName,k.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> v put(k k, v v) throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"put key: "</span>+k);</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"put value:"</span>+v);</span><br><span class="line">        getRedisTemplate().opsForHash().put(<span class="keyword">this</span>.cacheName,k.toString(),v);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> v remove(k k) throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"=============remove============="</span>);</span><br><span class="line">        <span class="keyword">return</span> (v) getRedisTemplate().opsForHash().delete(<span class="keyword">this</span>.cacheName,k.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> void clear() throws CacheException &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"=============clear=============="</span>);</span><br><span class="line">        getRedisTemplate().delete(<span class="keyword">this</span>.cacheName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> int size() &#123;</span><br><span class="line">        <span class="keyword">return</span> getRedisTemplate().opsForHash().size(<span class="keyword">this</span>.cacheName).intValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;k&gt; keys() &#123;</span><br><span class="line">        <span class="keyword">return</span> getRedisTemplate().opsForHash().keys(<span class="keyword">this</span>.cacheName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;v&gt; values() &#123;</span><br><span class="line">        <span class="keyword">return</span> getRedisTemplate().opsForHash().values(<span class="keyword">this</span>.cacheName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate getRedisTemplate()&#123;</span><br><span class="line">        RedisTemplate redisTemplate = (RedisTemplate) ApplicationContextUtils.getBean(<span class="string">"redisTemplate"</span>);</span><br><span class="line">        redisTemplate.setKeySerializer(new StringRedisSerializer());</span><br><span class="line">        redisTemplate.setHashKeySerializer(new StringRedisSerializer());</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;缓存&quot;&gt;&lt;a href=&quot;#缓存&quot; class=&quot;headerlink&quot; title=&quot;缓存&quot;&gt;&lt;/a&gt;缓存&lt;/h1&gt;&lt;p&gt;页面中权限的数据每次访问都会与数据库进行一次交互 这样就导致用户数量多的时候 访问量大的时候  就会导致数据库压力过大&lt;/p&gt;
&lt;p&gt;所以为
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/12/7-授权数据持久化</title>
    <link href="http://yoursite.com/2020/12/07/Shiro-2020-12-7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/12/07/Shiro-2020-12-7-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-12-07T05:11:00.000Z</published>
    <updated>2021-02-21T04:59:35.458Z</updated>
    
    <content type="html"><![CDATA[<h1 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h1><h2 id="授权方式"><a href="#授权方式" class="headerlink" title="授权方式"></a>授权方式</h2><ul><li><p>编程式</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Subject subject = <span class="module-access"><span class="module"><span class="identifier">SecurityUtils</span>.</span></span>get<span class="constructor">Subject()</span>;</span><br><span class="line"><span class="keyword">if</span>(subject.has<span class="constructor">Role(<span class="string">"admin"</span>)</span>)&#123;</span><br><span class="line"><span class="comment">//有权限</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//无权限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>注解式</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiresRoles</span>(<span class="string">"admin"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//有权限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>标签式</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JSP/GSP 标签：在JSP/GSP 页面通过相应的标签完成：</span><br><span class="line"><span class="tag">&lt;<span class="name">shiro:hasRole</span> <span class="attr">name</span>=<span class="string">"admin"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 有权限 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">shiro:hasRole</span>&gt;</span></span><br><span class="line">注意：Thymeleaf 中使用shiro需要额外集成!</span><br></pre></td></tr></table></figure></li></ul><h2 id="授权实现"><a href="#授权实现" class="headerlink" title="授权实现"></a>授权实现</h2><p>首先模拟一下假数据，不操作数据库</p><p>在CustomerRealm下有一个doGetAuthorizationInfo方法</p><p>这里就负责授权的操作</p><p>现在就假设普通用户能看到用户管理  admin可以看到所有的菜单</p><p>标签式：<br>shiro标签引入<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@taglib <span class="attribute">prefix</span>=<span class="string">"shiro"</span> <span class="attribute">uri</span>=<span class="string">"http://shiro.apache.org/tags"</span>%&gt;</span><br></pre></td></tr></table></figure></p><p>在index.jsp添加上shiro标签<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">shiro:hasAnyRoles</span> <span class="attr">name</span>=<span class="string">"user,admin"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">shiro:hasPermission</span> <span class="attr">name</span>=<span class="string">"user:add:*"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">shiro:hasPermission</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">shiro:hasPermission</span> <span class="attr">name</span>=<span class="string">"user:delete:*"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">shiro:hasPermission</span>&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">shiro:hasPermission</span> <span class="attr">name</span>=<span class="string">"user:update:*"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">shiro:hasPermission</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">shiro:hasPermission</span> <span class="attr">name</span>=<span class="string">"user:find:*"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">shiro:hasPermission</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">shiro:hasAnyRoles</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">shiro:hasRole</span> <span class="attr">name</span>=<span class="string">"admin"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>商品管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>订单管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>物流管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">shiro:hasRole</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>CustomerRealm中写上对应的授权方法<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected AuthorizationInfo <span class="keyword">do</span><span class="constructor">GetAuthorizationInfo(PrincipalCollection <span class="params">principalCollection</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//获取身份信息</span></span><br><span class="line">    String primaryPrincipal = (String) principalCollection.get<span class="constructor">PrimaryPrincipal()</span>;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"调用授权验证："</span>+primaryPrincipal);</span><br><span class="line">    <span class="comment">//根据主身份信息获取角色和权限信息</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"xiaochen"</span>.equals(primaryPrincipal))&#123;</span><br><span class="line">        SimpleAuthorizationInfo simpleAuthorizationInfo = <span class="keyword">new</span> <span class="constructor">SimpleAuthorizationInfo()</span>;</span><br><span class="line"></span><br><span class="line">        simpleAuthorizationInfo.add<span class="constructor">Role(<span class="string">"user"</span>)</span>;</span><br><span class="line"></span><br><span class="line">        simpleAuthorizationInfo.add<span class="constructor">StringPermission(<span class="string">"user:find:*"</span>)</span>;</span><br><span class="line">        simpleAuthorizationInfo.add<span class="constructor">StringPermission(<span class="string">"user:update:*"</span>)</span>;</span><br><span class="line"></span><br><span class="line">        return simpleAuthorizationInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>现在xiaochen这个账号就是个普通用户 可以看到用户管理  并且对所有文件都具有修改和查找的操作权力 他只能看见修改和查找的功能  看到不添加删除功能</p><p>这就完成了通过标签的方式完成了授权的操作，实际开发中一般不会使用这种方式去完成授权操作</p><p>代码式：<br>创建一个OrderController<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(<span class="meta-string">"order"</span>)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(<span class="meta-string">"save"</span>)</span></span><br><span class="line">    <span class="keyword">public</span> String save()&#123;</span><br><span class="line">        <span class="comment">//获取主体对象</span></span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        <span class="comment">//代码方式</span></span><br><span class="line">        <span class="keyword">if</span> (subject.hasRole(<span class="string">"admin"</span>)) &#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">"保存订单"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">"无权访问"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//基于权限字符串</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这是个简单的演示  如果xiaochen是admin  那就控制台输出保存订单</p><p>注解式：<br>将上面的代码添加上一个注解即可<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@RequestMapping</span>(<span class="string">"save"</span>)</span><br><span class="line"><span class="variable">@RequiresRoles</span>(<span class="string">"admin"</span>)<span class="comment">//用来判断角色</span></span><br></pre></td></tr></table></figure><br>如果要判断多个角色<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiresRoles(value=&#123;<span class="meta-string">"admin"</span>,<span class="meta-string">"user"</span>&#125;)</span><span class="comment">//用来判断角色  同时具有admin和user身份</span></span><br></pre></td></tr></table></figure></p><p>还有判断权限字符串的注解<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiresPermissions(<span class="meta-string">"user:update:01"</span>)</span> <span class="comment">//用来判断权限字符串</span></span><br></pre></td></tr></table></figure></p><h2 id="授权数据持久化"><a href="#授权数据持久化" class="headerlink" title="授权数据持久化"></a>授权数据持久化</h2><h3 id="角色信息获取"><a href="#角色信息获取" class="headerlink" title="角色信息获取"></a>角色信息获取</h3><p>首先要完成通过数据库授权的操作，自然是先要去设计一下库表了</p><p>这里就不讲过程了 直接贴sql文件<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Navicat MySQL Data Transfer</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Source Server         : localhost</span></span><br><span class="line"><span class="comment">Source Server Version : 80020</span></span><br><span class="line"><span class="comment">Source Host           : localhost:3306</span></span><br><span class="line"><span class="comment">Source Database       : shiro_spring</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Target Server Type    : MYSQL</span></span><br><span class="line"><span class="comment">Target Server Version : 80020</span></span><br><span class="line"><span class="comment">File Encoding         : 65001</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Date: 2020-12-07 17:40:29</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_pers</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`t_pers`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_pers`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">80</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`url`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`t_role`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_role`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">60</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_role_perms</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`t_role_perms`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_role_perms`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`roleid`</span> <span class="built_in">int</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`permsid`</span> <span class="built_in">int</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`t_user`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`username`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`salt`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">5</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_user_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`t_user_role`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_user_role`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`userid`</span> <span class="built_in">int</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`roleid`</span> <span class="built_in">int</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></p><p>t_role表内容:</p><div class="table-container"><table><thead><tr><th>id</th><th>name</th></tr></thead><tbody><tr><td>1</td><td>admin</td></tr><tr><td>2</td><td>user</td></tr><tr><td>3</td><td>product</td></tr></tbody></table></div><p>t_user_role表内容：</p><div class="table-container"><table><thead><tr><th>id</th><th>userid</th><th>roleid</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>1</td></tr><tr><td>2</td><td>2</td><td>2</td></tr><tr><td>3</td><td>2</td><td>3</td></tr></tbody></table></div><p><img src="/img/JavaWeb/12-7学习日记/0.png" alt="avatar"></p><p>接着就是构建实体类Perms 和 Role</p><p>Role:<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.experimental.Accessors;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Accessors(chain = <span class="literal">true</span>)</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@NoArgsConstructor</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Role</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">String</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Perms:<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.experimental.Accessors;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Accessors(chain = <span class="literal">true</span>)</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@NoArgsConstructor</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Perms</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> url;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">String</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(<span class="keyword">String</span> url)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>User实体类中也应该添加上一个roles<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义角色集合</span></span><br><span class="line"><span class="keyword">private</span> List&lt;Role&gt; roles;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Role&gt; <span class="title">getRoles</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> roles;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoles</span>(<span class="params">List&lt;Role&gt; roles</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.roles = roles;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>UserDAO中开发一个查询方法<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//根据用户名查询所有角色</span><br><span class="line"><span class="keyword">User</span> <span class="title">findRolesByUserName</span>(<span class="keyword">String</span> username);</span><br></pre></td></tr></table></figure></p><p>对应的Service一样<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//根据用户名查询所有角色</span><br><span class="line"><span class="keyword">User</span> <span class="title">findRolesByUserName</span>(<span class="keyword">String</span> username);</span><br></pre></td></tr></table></figure></p><p>接着在UserDAOMapper.xml中添加select方法<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap <span class="built_in">id</span>=<span class="string">"userMap"</span> type=<span class="string">"User"</span>&gt;</span><br><span class="line">        &lt;<span class="built_in">id</span> column=<span class="string">"uid"</span> <span class="keyword">property</span>=<span class="string">"id"</span> /&gt;</span><br><span class="line">        &lt;<span class="literal">result</span> column=<span class="string">"username"</span> <span class="keyword">property</span>=<span class="string">"username"</span> /&gt;</span><br><span class="line">&lt;!<span class="comment">--        角色信息--&gt;</span></span><br><span class="line">        &lt;collection <span class="keyword">property</span>=<span class="string">"roles"</span> javaType=<span class="string">"list"</span> ofType=<span class="string">"Role"</span>&gt;</span><br><span class="line">            &lt;<span class="built_in">id</span> column=<span class="string">"id"</span> <span class="keyword">property</span>=<span class="string">"id"</span> /&gt;</span><br><span class="line">            &lt;<span class="literal">result</span> column=<span class="string">"rname"</span> <span class="keyword">property</span>=<span class="string">"name"</span> /&gt;</span><br><span class="line">        &lt;/collection&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select <span class="built_in">id</span>=<span class="string">"findRolesByUserName"</span> parameterType=<span class="string">"String"</span> resultMap=<span class="string">"userMap"</span>&gt;</span><br><span class="line">        select u.<span class="built_in">id</span> uid,u.username,r.<span class="built_in">id</span>,r.<span class="built_in">name</span> rname</span><br><span class="line">        <span class="keyword">from</span> t_user u</span><br><span class="line">        left join t_user_role ur</span><br><span class="line">        <span class="keyword">on</span> u.<span class="built_in">id</span>=ur.userid</span><br><span class="line">        left join t_role r</span><br><span class="line">        <span class="keyword">on</span> ur.roleid=r.<span class="built_in">id</span></span><br><span class="line">        <span class="keyword">where</span> u.username=<span class="comment">#&#123;username&#125;;</span></span><br><span class="line">    &lt;/select&gt;</span><br></pre></td></tr></table></figure></p><p>接下来就是业务层的实现了<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">User <span class="title">findRolesByUserName</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">return</span> userDAO.<span class="title">findRolesByUserName</span><span class="params">(username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>都做好了 就可以回到我们的自定义Realm了<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    @Override</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取身份信息</span></span><br><span class="line">        <span class="keyword">String</span> primaryPrincipal = (<span class="keyword">String</span>) principalCollection.getPrimaryPrincipal();</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"调用授权验证："</span>+primaryPrincipal);</span><br><span class="line">        <span class="comment">//根据主身份信息获取角色和权限信息</span></span><br><span class="line"><span class="comment">//        if("xiaochen".equals(primaryPrincipal))&#123;</span></span><br><span class="line"><span class="comment">//            SimpleAuthorizationInfo simpleAuthorizationInfo = new SimpleAuthorizationInfo();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            simpleAuthorizationInfo.addRole("user");</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            simpleAuthorizationInfo.addStringPermission("user:find:*");</span></span><br><span class="line"><span class="comment">//            simpleAuthorizationInfo.addStringPermission("user:update:*");</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            return simpleAuthorizationInfo;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        UserService userService = (UserService) ApplicationContextUtils.getBean(<span class="string">"userService"</span>);</span><br><span class="line">        User user = userService.findRolesByUserName(primaryPrincipal);</span><br><span class="line">        <span class="comment">//授权角色信息</span></span><br><span class="line">        <span class="keyword">if</span>(!CollectionUtils.isEmpty(user.getRoles()))&#123;</span><br><span class="line">            SimpleAuthorizationInfo simpleAuthorizationInfo = <span class="keyword">new</span> SimpleAuthorizationInfo();</span><br><span class="line">            user.getRoles().forEach(role -&gt;&#123;</span><br><span class="line">                simpleAuthorizationInfo.addRole(role.getName());</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> simpleAuthorizationInfo;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>这样就完成了从写死数据到连接数据库的授权操作了</p><h3 id="权限信息获取"><a href="#权限信息获取" class="headerlink" title="权限信息获取"></a>权限信息获取</h3><p>获取权限信息在数据库就比较麻烦了  因为我们既需要查到他的角色信息还要查到他的权限信息</p><p>现在需要定义一个权限集合  但权限是绑定角色的 所以就需要在Role实体类中定义一个权限的集合<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义权限集合</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">List</span>&lt;Perms&gt; perms;</span><br></pre></td></tr></table></figure></p><p>UserDAO中也添加上方法<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据角色id查询权限集合的方法</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Perms&gt; findPermsByRoleId(<span class="built_in">String</span> id);</span><br></pre></td></tr></table></figure></p><p>Service也加上<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据角色id查询权限集合的方法</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Perms&gt; findPermsByRoleId(<span class="built_in">String</span> id);</span><br></pre></td></tr></table></figure></p><p>Servicelmpl业务层实现一下<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Perms&gt; findPermsByRoleId(String id) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">return</span> userDAO.<span class="title">findPermsByRoleId</span><span class="params">(id)</span></span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>对应的Mapper添加上select<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;select <span class="built_in">id</span>=<span class="string">"findPermsByRoleId"</span> parameterType=<span class="string">"String"</span> resultType=<span class="string">"Perms"</span>&gt;</span><br><span class="line">    select p.<span class="built_in">id</span>,p.<span class="built_in">name</span>,p.url,r.<span class="built_in">name</span></span><br><span class="line">    <span class="keyword">from</span> t_role r</span><br><span class="line">    left join t_role_perms rp</span><br><span class="line">    <span class="keyword">on</span> r.<span class="built_in">id</span> = rp.roleid</span><br><span class="line">    left join t_perms p</span><br><span class="line">    <span class="keyword">on</span> rp.permsid = p.<span class="built_in">id</span></span><br><span class="line">    <span class="keyword">where</span> r.<span class="built_in">id</span>=<span class="comment">#&#123;id&#125;;</span></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></p><p>这些都做完了 就可以去自定义Realm中添加获取权限信息了</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">    @Override</span><br><span class="line">    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123;</span><br><span class="line">        //获取身份信息</span><br><span class="line">        String primaryPrincipal = (String) principalCollection.getPrimaryPrincipal();</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println("调用授权验证："+primaryPrincipal);</span><br><span class="line">        //根据主身份信息获取角色和权限信息</span><br><span class="line">//        <span class="keyword">if</span>("xiaochen".equals(primaryPrincipal))&#123;</span><br><span class="line">//            SimpleAuthorizationInfo simpleAuthorizationInfo = <span class="built_in">new</span> SimpleAuthorizationInfo();</span><br><span class="line">//</span><br><span class="line">//            simpleAuthorizationInfo.addRole("user");</span><br><span class="line">//</span><br><span class="line">//            simpleAuthorizationInfo.addStringPermission("user:find:*");</span><br><span class="line">//            simpleAuthorizationInfo.addStringPermission("user:update:*");</span><br><span class="line">//</span><br><span class="line">//            <span class="keyword">return</span> simpleAuthorizationInfo;</span><br><span class="line">//        &#125;</span><br><span class="line">        UserService userService = (UserService) ApplicationContextUtils.getBean("userService");</span><br><span class="line">        <span class="keyword">User</span> <span class="keyword">user</span> = userService.findRolesByUserName(primaryPrincipal);</span><br><span class="line">        //授权角色信息</span><br><span class="line">        <span class="keyword">if</span>(!CollectionUtils.isEmpty(<span class="keyword">user</span>.getRoles()))&#123;</span><br><span class="line">            SimpleAuthorizationInfo simpleAuthorizationInfo = <span class="built_in">new</span> SimpleAuthorizationInfo();</span><br><span class="line">            <span class="keyword">user</span>.getRoles().<span class="keyword">forEach</span>(<span class="keyword">role</span> -&gt;&#123;</span><br><span class="line">                simpleAuthorizationInfo.addRole(<span class="keyword">role</span>.getName());</span><br><span class="line"></span><br><span class="line">                //权限信息</span><br><span class="line">                List&lt;Perms&gt; perms = userService.findPermsByRoleId(<span class="keyword">role</span>.getId());</span><br><span class="line">                <span class="keyword">if</span>(!CollectionUtils.isEmpty(perms))&#123;</span><br><span class="line">                    perms.<span class="keyword">forEach</span>(perm-&gt;&#123;</span><br><span class="line">                        simpleAuthorizationInfo.addStringPermission(perm.getName());</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> simpleAuthorizationInfo;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>这样，以数据库的认证授权操作就全部做完了</p><p>剩下的就是去优化了  因为现在这样写 每次登录的时候都会去查数据库  所以我们要将授权角色信息和权限信息进行一个缓存  来优化我们的认证和授权</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;授权&quot;&gt;&lt;a href=&quot;#授权&quot; class=&quot;headerlink&quot; title=&quot;授权&quot;&gt;&lt;/a&gt;授权&lt;/h1&gt;&lt;h2 id=&quot;授权方式&quot;&gt;&lt;a href=&quot;#授权方式&quot; class=&quot;headerlink&quot; title=&quot;授权方式&quot;&gt;&lt;/a&gt;授权方式&lt;/h
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/12/2-数据库+MD5+Salt认证</title>
    <link href="http://yoursite.com/2020/12/02/Shiro-2020-12-2-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/12/02/Shiro-2020-12-2-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-12-02T02:03:12.000Z</published>
    <updated>2021-02-21T04:57:40.668Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringBoot-Shiro整合思路"><a href="#SpringBoot-Shiro整合思路" class="headerlink" title="SpringBoot+Shiro整合思路"></a>SpringBoot+Shiro整合思路</h1><h2 id="数据库-MD5-Salt认证功能"><a href="#数据库-MD5-Salt认证功能" class="headerlink" title="数据库+MD5+Salt认证功能"></a>数据库+MD5+Salt认证功能</h2><p>之前完成了用户md5+salt的用户注册流程</p><p>现在就完成以下认证的功能</p><p>认证的数据依旧是来自于数据库中的<br>这里就需要修改一下自定义realm中的认证实现换成数据库而不是写死的功能</p><p>需要现在UserDAO增加一个方法<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">User</span> <span class="title">findByUserName</span>(<span class="keyword">String</span> username);</span><br></pre></td></tr></table></figure></p><p>在UserDAOMapper.xml中添加对应的select方法<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">select</span> id=<span class="string">"findByUserName"</span> parameterType=<span class="string">"String"</span> resultType=<span class="string">"User"</span>&gt;</span><br><span class="line">        <span class="keyword">select</span> id,username,password,salt <span class="keyword">from</span> t_user</span><br><span class="line">        <span class="keyword">where</span> username = <span class="meta">#&#123;username&#125;</span></span><br><span class="line">    &lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure><br>同样的在业务层UserService添加方法<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//根据用户名查询业务的方法</span><br><span class="line">    <span class="keyword">User</span> <span class="title">findByUserName</span>(<span class="keyword">String</span> username);</span><br></pre></td></tr></table></figure><br>UserServiceImpl中的实现也要加上<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">User <span class="title">findByUserName</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">return</span> userDAO.<span class="title">findByUserName</span><span class="params">(username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>接着就是去修改realm方法啦,但是并没有业务对象，现在业务对象是由工厂去进行注入的</p><p>所以就建一个工具类ApplicationContextUtils<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContextAware;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationContextUtils</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ApplicationContext context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据bean名字获取工厂中指定bean对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function">Object <span class="title">getBean</span><span class="params">(String beanName)</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">return</span> context.<span class="title">getBean</span><span class="params">(beanName)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>接下来就可以把自定义realm中写死的数据改为数据库连接了<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.shiro.realms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.entity.<span class="type">User</span>;</span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.service.<span class="type">UserService</span>;</span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.utils.<span class="type">ApplicationContextUtils</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationException</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationToken</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">SimpleAuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.<span class="type">AuthorizationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.<span class="type">AuthorizingRealm</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.<span class="type">PrincipalCollection</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.util.<span class="type">ByteSource</span>;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.<span class="type">ObjectUtils</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义Realm</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomerRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthorizationInfo</span> doGetAuthorizationInfo(<span class="type">PrincipalCollection</span> principalCollection) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthenticationInfo</span> doGetAuthenticationInfo(<span class="type">AuthenticationToken</span> authenticationToken) <span class="keyword">throws</span> <span class="type">AuthenticationException</span> &#123;</span><br><span class="line">        <span class="type">System</span>.out.println(<span class="string">"====================================="</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据身份信息</span></span><br><span class="line">        <span class="type">String</span> principal = (<span class="type">String</span>)authenticationToken.getPrincipal();</span><br><span class="line">        <span class="comment">//在工厂中获取service对象</span></span><br><span class="line">        <span class="type">UserService</span> userService = (<span class="type">UserService</span>) <span class="type">ApplicationContextUtils</span>.getBean(<span class="string">"userService"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> user = userService.findByUserName(principal);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="type">ObjectUtils</span>.isEmpty(user))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">SimpleAuthenticationInfo</span>(user.getUsername(),user.getPassword(), <span class="type">ByteSource</span>.<span class="type">Util</span>.bytes(user.getSalt()),<span class="keyword">this</span>.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>但是这样还不行 因为我们的数据进行了md5和加盐的操作 所以必须还要修改一下凭证校验匹配器<br>在ShiroConfig中<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.<span class="built_in">config</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.shiro.realms.CustomerRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.credential.HashedCredentialsMatcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.Realm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用来整合Shiro框架的配置类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@Configuration</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> &#123;</span></span><br><span class="line">    <span class="comment">//1. 创建shiroFilter</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean shiroFilterFactoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给filter设置安全管理器</span></span><br><span class="line">        shiroFilterFactoryBean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//配置系统受限资源</span></span><br><span class="line">        <span class="comment">//配置系统公共资源</span></span><br><span class="line">        Map&lt;<span class="keyword">String</span>,<span class="keyword">String</span>&gt; <span class="built_in">map</span> = <span class="keyword">new</span> HashMap&lt;<span class="keyword">String</span>,<span class="keyword">String</span>&gt;();</span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/user/login"</span>,<span class="string">"anon"</span>); <span class="comment">//anon 设置为公共资源</span></span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/user/register"</span>,<span class="string">"anon"</span>);</span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/register.jsp"</span>,<span class="string">"anon"</span>);</span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/**"</span>,<span class="string">"authc"</span>);  <span class="comment">//authc 请求这个资源需要认证和授权</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//默认认证界面路径</span></span><br><span class="line">        shiroFilterFactoryBean.setLoginUrl(<span class="string">"/login.jsp"</span>);</span><br><span class="line">        shiroFilterFactoryBean.setFilterChainDefinitionMap(<span class="built_in">map</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shiroFilterFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 创建安全管理器</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(@Qualifier(<span class="string">"getRealm"</span>) Realm realm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager defaultWebSecurityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给安全管理器设置realm</span></span><br><span class="line">        defaultWebSecurityManager.setRealm(realm);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> defaultWebSecurityManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. 创建自定义realm</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Realm <span class="title">getRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        CustomerRealm customerRealm = <span class="keyword">new</span> CustomerRealm();</span><br><span class="line">        <span class="comment">//修改凭证校验匹配器</span></span><br><span class="line">        HashedCredentialsMatcher credentialsMatcher = <span class="keyword">new</span> HashedCredentialsMatcher();</span><br><span class="line">        <span class="comment">//设置加密方式为md5</span></span><br><span class="line">        credentialsMatcher.setHashAlgorithmName(<span class="string">"MD5"</span>);</span><br><span class="line">        <span class="comment">//设置散列次数</span></span><br><span class="line">        credentialsMatcher.setHashIterations(<span class="number">1024</span>);</span><br><span class="line">        customerRealm.setCredentialsMatcher(credentialsMatcher);</span><br><span class="line">        <span class="keyword">return</span> customerRealm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这样就完成了数据库+MD5+Salt的认证功能了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SpringBoot-Shiro整合思路&quot;&gt;&lt;a href=&quot;#SpringBoot-Shiro整合思路&quot; class=&quot;headerlink&quot; title=&quot;SpringBoot+Shiro整合思路&quot;&gt;&lt;/a&gt;SpringBoot+Shiro整合思路&lt;/h1&gt;&lt;
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/11/30-SpringBoot+Shiro整合</title>
    <link href="http://yoursite.com/2020/11/30/Shiro-2020-11-30-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/11/30/Shiro-2020-11-30-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-11-30T05:10:37.000Z</published>
    <updated>2021-02-21T04:57:42.898Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringBoot-Shiro"><a href="#SpringBoot-Shiro" class="headerlink" title="SpringBoot+Shiro"></a>SpringBoot+Shiro</h1><h2 id="整合思路"><a href="#整合思路" class="headerlink" title="整合思路"></a>整合思路</h2><p><img src="/img/JavaWeb/11-30学习日记/0.png" alt="avatar"></p><h2 id="引入Shiro依赖"><a href="#引入Shiro依赖" class="headerlink" title="引入Shiro依赖"></a>引入Shiro依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建SpringBoot项目就不多说了</p><p>还需要引入一下jstl的依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">         <span class="comment">&lt;!--        引入jsp解析依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        jstl--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        servlet-api--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>application.properties文件配置为<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="number">8080</span></span><br><span class="line"><span class="attr">server.servlet.context-path</span>=/shiro</span><br><span class="line"><span class="attr">spring.application.name</span>=shiro</span><br><span class="line"></span><br><span class="line"><span class="attr">spring.mvc.view.prefix</span>=/</span><br><span class="line"><span class="attr">spring.mvc.view.suffix</span>=.jsp</span><br></pre></td></tr></table></figure></p><p>这样环境就配置好了</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>在webapp下创建index.jps和login.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@page contentType=<span class="string">"text/html;  UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!doctype html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span></span><br><span class="line"><span class="xml">          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>系统主页V1.0<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>商品管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>订单管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>物流管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>login.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@page contentType=<span class="string">"text/html;  UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!doctype html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span></span><br><span class="line"><span class="xml">          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>登陆页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>接着创建一个config包来存放Shiroconfig<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.<span class="built_in">config</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.shiro.realms.CustomerRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.Realm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用来整合Shiro框架的配置类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@Configuration</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> &#123;</span></span><br><span class="line">    <span class="comment">//1. 创建shiroFilter</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean shiroFilterFactoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给filter设置安全管理器</span></span><br><span class="line">        shiroFilterFactoryBean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//配置系统受限资源</span></span><br><span class="line">        <span class="comment">//配置系统公共资源</span></span><br><span class="line">        Map&lt;<span class="keyword">String</span>,<span class="keyword">String</span>&gt; <span class="built_in">map</span> = <span class="keyword">new</span> HashMap&lt;<span class="keyword">String</span>,<span class="keyword">String</span>&gt;();</span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/index.jsp"</span>,<span class="string">"authc"</span>);  <span class="comment">//authc请求这个资源需要认证和授权</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//默认认证界面路径</span></span><br><span class="line">        shiroFilterFactoryBean.setLoginUrl(<span class="string">"/login.jsp"</span>);</span><br><span class="line"></span><br><span class="line">        shiroFilterFactoryBean.setFilterChainDefinitionMap(<span class="built_in">map</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shiroFilterFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 创建安全管理器</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(@Qualifier(<span class="string">"getRealm"</span>) Realm realm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager defaultWebSecurityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给安全管理器设置realm</span></span><br><span class="line">        defaultWebSecurityManager.setRealm(realm);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> defaultWebSecurityManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. 创建自定义realm</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Realm <span class="title">getRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        CustomerRealm customerRealm = <span class="keyword">new</span> CustomerRealm();</span><br><span class="line">        <span class="keyword">return</span> customerRealm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>同时还需要一个shiro.realms包来自定义realm<br>CustomerRealm.java<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.shiro.realms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationException</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationToken</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.<span class="type">AuthorizationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.<span class="type">AuthorizingRealm</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.<span class="type">PrincipalCollection</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义Realm</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomerRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthorizationInfo</span> doGetAuthorizationInfo(<span class="type">PrincipalCollection</span> principalCollection) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthenticationInfo</span> doGetAuthenticationInfo(<span class="type">AuthenticationToken</span> authenticationToken) <span class="keyword">throws</span> <span class="type">AuthenticationException</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>最后运行访问一下index.jsp 要是成功跳转到了login.jsp  那就证明index.jsp现在是受保护的了</p><h2 id="实现认证与退出"><a href="#实现认证与退出" class="headerlink" title="实现认证与退出"></a>实现认证与退出</h2><p>这个例子并没有连接数据库，使用一个值来进行演示</p><p>由于config肯定不能进行直接访问，所以我们需要一个controller<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.IncorrectCredentialsException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UnknownAccountException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.<span class="keyword">annotation</span>.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(<span class="meta-string">"user"</span>)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退出登录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(<span class="meta-string">"logout"</span>)</span></span><br><span class="line">    <span class="keyword">public</span> String logout()&#123;</span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        subject.logout(); <span class="comment">//退出登录</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/login.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用来处理身份验证</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(<span class="meta-string">"login"</span>)</span></span><br><span class="line">    <span class="keyword">public</span> String login(String username,String password)&#123;</span><br><span class="line">        <span class="comment">//获取主体对象</span></span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subject.login(new UsernamePasswordToken(username,password));</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnknownAccountException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">"用户名错误"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IncorrectCredentialsException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.<span class="keyword">out</span>.println(<span class="string">"密码错误"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/login.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>同时也要去修改一下Realm<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.shiro.realms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationException</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationToken</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">SimpleAuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.<span class="type">AuthorizationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.<span class="type">AuthorizingRealm</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.<span class="type">PrincipalCollection</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义Realm</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomerRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthorizationInfo</span> doGetAuthorizationInfo(<span class="type">PrincipalCollection</span> principalCollection) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthenticationInfo</span> doGetAuthenticationInfo(<span class="type">AuthenticationToken</span> authenticationToken) <span class="keyword">throws</span> <span class="type">AuthenticationException</span> &#123;</span><br><span class="line">        <span class="type">System</span>.out.println(<span class="string">"====================================="</span>);</span><br><span class="line">        <span class="type">String</span> principal = (<span class="type">String</span>)authenticationToken.getPrincipal();</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"xiaochen"</span>.equals(principal))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">SimpleAuthenticationInfo</span>(principal,<span class="string">"123"</span>,<span class="keyword">this</span>.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Config也需要进行修改<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.<span class="built_in">config</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.shiro.realms.CustomerRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.Realm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用来整合Shiro框架的配置类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@Configuration</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> &#123;</span></span><br><span class="line">    <span class="comment">//1. 创建shiroFilter</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(DefaultWebSecurityManager defaultWebSecurityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean shiroFilterFactoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给filter设置安全管理器</span></span><br><span class="line">        shiroFilterFactoryBean.setSecurityManager(defaultWebSecurityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//配置系统受限资源</span></span><br><span class="line">        <span class="comment">//配置系统公共资源</span></span><br><span class="line">        Map&lt;<span class="keyword">String</span>,<span class="keyword">String</span>&gt; <span class="built_in">map</span> = <span class="keyword">new</span> HashMap&lt;<span class="keyword">String</span>,<span class="keyword">String</span>&gt;();</span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/user/login"</span>,<span class="string">"anon"</span>); <span class="comment">//anon 设置为公共资源</span></span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/**"</span>,<span class="string">"authc"</span>);  <span class="comment">//authc 请求这个资源需要认证和授权</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//默认认证界面路径</span></span><br><span class="line">        shiroFilterFactoryBean.setLoginUrl(<span class="string">"/login.jsp"</span>);</span><br><span class="line">        shiroFilterFactoryBean.setFilterChainDefinitionMap(<span class="built_in">map</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> shiroFilterFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 创建安全管理器</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getDefaultWebSecurityManager</span><span class="params">(@Qualifier(<span class="string">"getRealm"</span>) Realm realm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager defaultWebSecurityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//给安全管理器设置realm</span></span><br><span class="line">        defaultWebSecurityManager.setRealm(realm);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> defaultWebSecurityManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. 创建自定义realm</span></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Realm <span class="title">getRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        CustomerRealm customerRealm = <span class="keyword">new</span> CustomerRealm();</span><br><span class="line">        <span class="keyword">return</span> customerRealm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>上面都有了之后，就可以修改一下index.jsp和login.jsp了</p><p>index.jsp<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@page</span> <span class="attr">contentType</span>=<span class="string">"text/html;  UTF-8"</span> <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!doctype html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span></span><br><span class="line"><span class="xml">          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>系统主页V1.0<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageContext.request.contextPath&#125;</span><span class="xml"><span class="tag"><span class="string">/user/logout"</span>&gt;</span>退出用户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>商品管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>订单管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>物流管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>login.jsp<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@page</span> <span class="attr">contentType</span>=<span class="string">"text/html;  UTF-8"</span> <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!doctype html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span></span><br><span class="line"><span class="xml">          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>登陆页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageContext.request.contextPath&#125;</span><span class="xml"><span class="tag"><span class="string">/user/login"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>这样就完成了认证和退出</p><p>思路很简单，就是写一个controller控制器，去获取主体subject，并且调用subject中的login和logout方法去实现认证和退出，并且完成一下重定向的操作</p><p>subject呢会自动的注入到realm的配置中，所以可以直接使用</p><p>而realm中,为了方便演示，没有连接数据库去进行操作，使用了一个值去模拟登录和退出</p><p>连接数据库只需要去替换一下就可以了</p><h2 id="连接数据库-MD5-Salt注册功能"><a href="#连接数据库-MD5-Salt注册功能" class="headerlink" title="连接数据库+MD5+Salt注册功能"></a>连接数据库+MD5+Salt注册功能</h2><p>MD5+Salt不仅是用于用户认证，在用户注册时就应该去进行一下MD5+Salt的操作</p><p>首先肯定是要有个注册页面了register.jsp<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@page</span> <span class="attr">contentType</span>=<span class="string">"text/html;  UTF-8"</span> <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!doctype html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span></span></span></span><br><span class="line"><span class="xml">          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>用户注册<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageContext.request.contextPath&#125;</span><span class="xml"><span class="tag"><span class="string">/user/register"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"立即注册"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>还要将它和请求都设置为公共资源<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/user/register"</span>,<span class="string">"anon"</span>);</span><br><span class="line"><span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"/register.jsp"</span>,<span class="string">"anon"</span>);</span><br></pre></td></tr></table></figure></p><p>接下来就是新建一个数据库<br><img src="/img/JavaWeb/11-30学习日记/1.png" alt="avatar"></p><p>除此之外还要添加mysql和mybatis相关的依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--        mabatis相关依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        mysql依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        druid--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>配置文件同样也要加上<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">spring<span class="selector-class">.datasource</span>.type=com<span class="selector-class">.alibaba</span><span class="selector-class">.druid</span><span class="selector-class">.pool</span>.DruidDataSource</span><br><span class="line">spring<span class="selector-class">.datasource</span>.driver-class-name=com<span class="selector-class">.mysql</span><span class="selector-class">.cj</span><span class="selector-class">.jdbc</span>.Driver</span><br><span class="line">spring<span class="selector-class">.datasource</span>.url=jdbc:mysql:<span class="comment">//localhost:3306/shiro_spring?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&amp;useSSL=false</span></span><br><span class="line">spring<span class="selector-class">.datasource</span>.username=root</span><br><span class="line">spring<span class="selector-class">.datasource</span>.password=root</span><br><span class="line"></span><br><span class="line">mybatis.type-aliases-package=com<span class="selector-class">.ceit</span><span class="selector-class">.springboot_jsp_shiro</span>.entity</span><br><span class="line">mybatis.mapper-locations=classpath:com/ceit/mapper<span class="comment">/*.xml</span></span><br></pre></td></tr></table></figure></p><p>在resources下建一个com.ceit.mapper包用于存放mapper配置文件</p><p>在com.ceit.springboot_jsp_shiro下建一个entity包 创建一个User.java<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.experimental.Accessors;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Accessors(chain = <span class="literal">true</span>)</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@NoArgsConstructor</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> username;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> password;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> salt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalt</span><span class="params">(<span class="keyword">String</span> salt)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.salt = salt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(<span class="keyword">String</span> password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>接着对应开发对应的dao接口  UserDAO.interface<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">package</span> <span class="selector-tag">com</span><span class="selector-class">.ceit</span><span class="selector-class">.springboot_jsp_shiro</span><span class="selector-class">.dao</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">com</span><span class="selector-class">.ceit</span><span class="selector-class">.springboot_jsp_shiro</span><span class="selector-class">.entity</span><span class="selector-class">.User</span>;</span><br><span class="line"><span class="selector-tag">import</span> <span class="selector-tag">org</span><span class="selector-class">.apache</span><span class="selector-class">.ibatis</span><span class="selector-class">.annotations</span><span class="selector-class">.Mapper</span>;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">Mapper</span></span><br><span class="line"><span class="keyword">public</span> interface UserDAO &#123;</span><br><span class="line">    <span class="selector-tag">void</span> <span class="selector-tag">save</span>(<span class="selector-tag">User</span> <span class="selector-tag">user</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>接下来就是配置UserDAOMapper.xml了<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ceit.springboot_jsp_shiro.dao.UserDAO"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"save"</span> <span class="attr">parameterType</span>=<span class="string">"User"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        insert into t_user values(#</span><span class="template-variable">&#123;id&#125;</span><span class="xml">,#</span><span class="template-variable">&#123;username&#125;</span><span class="xml">,#</span><span class="template-variable">&#123;password&#125;</span><span class="xml">,#</span><span class="template-variable">&#123;salt&#125;</span><span class="xml">)</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>再创建一个service包 创建一个UserService.interface<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//注册用户</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">register</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>对应的UserServiceImpl.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.springboot_jsp_shiro.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.dao.UserDAO;</span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.ceit.springboot_jsp_shiro.utils.SaltUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.crypto.hash.Md5Hash;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDAO userDAO;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//处理业务调用dao</span></span><br><span class="line">        <span class="comment">//明文密码进行md5+salt+hash散列</span></span><br><span class="line">        <span class="comment">//1. 生成随机盐</span></span><br><span class="line">        String salt = SaltUtils.getSalt(<span class="number">8</span>);</span><br><span class="line">        <span class="comment">//2. 将随机盐保存到数据</span></span><br><span class="line">        user.setSalt(salt);</span><br><span class="line">        <span class="comment">//3. 明文密码进行md5+salt+hash散列</span></span><br><span class="line">        Md5Hash md5Hash = <span class="keyword">new</span> Md5Hash(user.getPassword(),salt,<span class="number">1024</span>);</span><br><span class="line">        user.setPassword(md5Hash.toHex());</span><br><span class="line"></span><br><span class="line">        userDAO.save(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这里还需要创建一个工具类 先创建一个Utils包 包下创建一个SaltUtils.class<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.springboot_jsp_shiro.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SaltUtils</span> &#123;</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成salt的静态方法</span></span><br><span class="line"><span class="comment">     * @param n</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> <span class="title">getSalt</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] chars = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()"</span>.toCharArray();</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> aChar = chars[<span class="keyword">new</span> Random().nextInt(chars.length)];</span><br><span class="line">            sb.append(aChar);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">String</span> salt = getSalt(<span class="number">4</span>);</span><br><span class="line">        System.out.<span class="built_in">println</span>(salt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>用于生成盐</p><p>接着在Controller中添加<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户认证</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(<span class="meta-string">"register"</span>)</span></span><br><span class="line">    <span class="keyword">public</span> String register(User user)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            userService.register(user);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"redirect:/login.jsp"</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"redirect:/register.jsp"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>接下来进行一下测试，访问register.jsp  如果注册之后 跳转到了login.jsp  登陆一下  如果成功了  那么就完成了注册的一个流程，看一下数据库中也有了对应账号和加了盐的密码</p><p>注意事项：</p><ol><li><p>druid依赖 直接使用druid-spring-boot-starter</p></li><li><p>xml需要加上&lt;?xml version=”1.0” encoding=”UTF-8”?&gt;</p></li><li><p>dao包下的DAO别忘了加上@Mapper</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SpringBoot-Shiro&quot;&gt;&lt;a href=&quot;#SpringBoot-Shiro&quot; class=&quot;headerlink&quot; title=&quot;SpringBoot+Shiro&quot;&gt;&lt;/a&gt;SpringBoot+Shiro&lt;/h1&gt;&lt;h2 id=&quot;整合思路&quot;&gt;&lt;a 
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/11/19-用户授权</title>
    <link href="http://yoursite.com/2020/11/19/Shiro-2020-11-19-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/11/19/Shiro-2020-11-19-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-11-19T10:14:45.000Z</published>
    <updated>2021-02-21T04:57:44.883Z</updated>
    
    <content type="html"><![CDATA[<h1 id="shiro中授权的概念"><a href="#shiro中授权的概念" class="headerlink" title="shiro中授权的概念"></a>shiro中授权的概念</h1><h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><p>授权，即访问控制，控制谁能访问哪些资源，主体进行身份认证后需要分配权限方可访问系统的资源，对于某些资源没有权限是无法访问的</p><h2 id="关键对象"><a href="#关键对象" class="headerlink" title="关键对象"></a>关键对象</h2><p>授权可简单理解为who对what(which)进行how操作</p><ul><li><p>Who 即主体(subject) 主体需要访问系统中的资源</p></li><li><p>What 即资源(Resource) 如系统菜单，页面，按钮，类方法，系统商品信息等。资源包括资源类型和资源实例</p></li><li><p>How 即权限/许可(Permission) 规定了主体对资源的操作许可，权限离开资源没有意义，如用户查询权限，用户添加权限，某个类方法的调用权限</p></li></ul><h2 id="授权流程"><a href="#授权流程" class="headerlink" title="授权流程"></a>授权流程</h2><p><img src="/img/JavaWeb/11-19学习日记/0.png" alt="avatar"></p><h2 id="授权方式"><a href="#授权方式" class="headerlink" title="授权方式"></a>授权方式</h2><h3 id="基于角色的访问控制"><a href="#基于角色的访问控制" class="headerlink" title="基于角色的访问控制"></a>基于角色的访问控制</h3><ul><li>RBAC基于角色的访问控制(Role-Based Access Control) 是以角色为中心进行访问控制<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(subject.hasRole(<span class="string">"admin"</span>)</span></span>)&#123;</span><br><span class="line"><span class="comment">//操作什么资源</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="基于资源的访问控制"><a href="#基于资源的访问控制" class="headerlink" title="基于资源的访问控制"></a>基于资源的访问控制</h3><ul><li>RBAC基于资源的访问控制(Resource-Based Access Control) 是以资源为中心进行访问控制<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(subject.isPermission(<span class="string">"user:find:*"</span>)</span></span>)&#123;</span><br><span class="line"><span class="comment">//对所有用户具有查询权限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="权限字符串"><a href="#权限字符串" class="headerlink" title="权限字符串"></a>权限字符串</h2><p>权限字符串的规则是：资源标识符：操作：资源实例标识符，意思是对哪个资源的哪个实例具有什么操作，”:”是资源/操作/实例的分割线，权限字符串也可以使用*通配符</p><p>例子：</p><ul><li><p>用户创建权限：user:create,或user:create:*</p></li><li><p>用户修改实例001的权限：user:update:001</p></li><li><p>用户实例001的所有权限：user:*:001</p></li></ul><h1 id="shiro中的授权实现"><a href="#shiro中的授权实现" class="headerlink" title="shiro中的授权实现"></a>shiro中的授权实现</h1><ul><li>编程式:</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Subject subject = <span class="module-access"><span class="module"><span class="identifier">SecurityUtils</span>.</span></span>get<span class="constructor">Subject()</span>;</span><br><span class="line"><span class="keyword">if</span>(subject.has<span class="constructor">Role(<span class="string">"admin"</span>)</span>)&#123;</span><br><span class="line"><span class="comment">//有权限</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//无权限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>注解式:</li></ul><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiresRoles</span>(<span class="string">"admin"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//有权限</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>标签式:</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JSP/GSP 标签: 在JSP/GSP 页面通过相应的标签完成：</span><br><span class="line"><span class="tag">&lt;<span class="name">shiro:hasRole</span> <span class="attr">name</span>=<span class="string">"admin"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!-</span> 有权限 <span class="attr">-</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">shiro:hasRole</span>&gt;</span></span><br><span class="line">注意：Thymeleaf中使用shiro需要额外集成！</span><br></pre></td></tr></table></figure><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>接着上次授权的来<br>在后面添加<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//认证用户进行授权</span></span><br><span class="line"><span class="keyword">if</span>(subject.is<span class="constructor">Authenticated()</span>)&#123;</span><br><span class="line">    <span class="comment">//基于角色权限控制</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(subject.has<span class="constructor">Role(<span class="string">"admin"</span>)</span>);;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//基于多角色权限控制</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(subject.has<span class="constructor">AllRoles(Arrays.<span class="params">asList</span>(<span class="string">"admin"</span>, <span class="string">"user"</span>)</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//基于具有其中一个角色</span></span><br><span class="line">    boolean<span class="literal">[]</span> booleans = subject.has<span class="constructor">Roles(Arrays.<span class="params">asList</span>(<span class="string">"admin"</span>, <span class="string">"super"</span>, <span class="string">"user"</span>)</span>);</span><br><span class="line">    for(boolean aBoolean:booleans)&#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(aBoolean);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"=========================================="</span>);</span><br><span class="line">    <span class="comment">//基于权限字符串的访问控制，资源标志符:操作:资源类型</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"权限："</span>+subject.is<span class="constructor">Permitted(<span class="string">"user:*:01"</span>)</span>);</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"权限："</span>+subject.is<span class="constructor">Permitted(<span class="string">"product:update"</span>)</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//分别具有哪些权限</span></span><br><span class="line">    boolean<span class="literal">[]</span> permitted = subject.is<span class="constructor">Permitted(<span class="string">"user:*:01"</span>, <span class="string">"order:*:10"</span>)</span>;</span><br><span class="line">    for(boolean b : permitted)&#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//同时具有哪些权限</span></span><br><span class="line">    boolean permittedAll = subject.is<span class="constructor">PermittedAll(<span class="string">"user:*:01"</span>, <span class="string">"product:*"</span>)</span>;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(permittedAll);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>在CustomerMd5Realm中添加<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected AuthorizationInfo <span class="keyword">do</span><span class="constructor">GetAuthorizationInfo(PrincipalCollection <span class="params">principalCollection</span>)</span> &#123;</span><br><span class="line">    String primaryPrincipal = (String)principalCollection.get<span class="constructor">PrimaryPrincipal()</span>;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"身份信息:"</span>+primaryPrincipal);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据身份信息  用户名 获取当前用户的角色信息，以及权限信息  xiaochen admin user</span></span><br><span class="line">    SimpleAuthorizationInfo simpleAuthorizationInfo = <span class="keyword">new</span> <span class="constructor">SimpleAuthorizationInfo()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将数据库中查询的角色信息赋值给权限对象</span></span><br><span class="line">    simpleAuthorizationInfo.add<span class="constructor">Role(<span class="string">"admin"</span>)</span>;</span><br><span class="line">    simpleAuthorizationInfo.add<span class="constructor">Role(<span class="string">"user"</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将数据库中查询权限信息赋值个权限对象</span></span><br><span class="line">    simpleAuthorizationInfo.add<span class="constructor">StringPermission(<span class="string">"user:*:01"</span>)</span>;</span><br><span class="line">    simpleAuthorizationInfo.add<span class="constructor">StringPermission(<span class="string">"product:create:02"</span>)</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    return simpleAuthorizationInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>到这里shiro中的授权就完成了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;shiro中授权的概念&quot;&gt;&lt;a href=&quot;#shiro中授权的概念&quot; class=&quot;headerlink&quot; title=&quot;shiro中授权的概念&quot;&gt;&lt;/a&gt;shiro中授权的概念&lt;/h1&gt;&lt;h2 id=&quot;授权&quot;&gt;&lt;a href=&quot;#授权&quot; class=&quot;head
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/11/17-MD5+Salt</title>
    <link href="http://yoursite.com/2020/11/17/Shiro-2020-11-17-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/11/17/Shiro-2020-11-17-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-11-17T07:45:14.000Z</published>
    <updated>2021-02-21T04:57:46.663Z</updated>
    
    <content type="html"><![CDATA[<h1 id="shiro中自定义Realm的实现"><a href="#shiro中自定义Realm的实现" class="headerlink" title="shiro中自定义Realm的实现"></a>shiro中自定义Realm的实现</h1><ol><li><p>最终执行用户名比较 SimpleAccountRealm doGetAuthenticationInfo 在这个方法中完成用户名校验</p></li><li><p>最终密码校验是在AuthenticatingRealm中 assertCredentialsMatch</p></li></ol><p>总结：</p><ul><li><p>AuthenticatingRealm 认证realm doGetAuthenticationInfo</p></li><li><p>AuthorizingRealm 授权realm doGetAuthorizationInfo</p></li></ul><p>自定义Realm的目的就是为了抛弃掉ini配置文件</p><p>实现与数据库和以后Spring的连接</p><p>创建一个realm包用于存放我们自定义的CustomerRealm<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.realm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationException</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationToken</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">SimpleAuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.<span class="type">AuthorizationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.<span class="type">AuthorizingRealm</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.<span class="type">PrincipalCollection</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义realm实现  将认证/授权数据的来源转为数据库</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomerRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="comment">//授权</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthorizationInfo</span> doGetAuthorizationInfo(<span class="type">PrincipalCollection</span> principalCollection) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//认证</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthenticationInfo</span> doGetAuthenticationInfo(<span class="type">AuthenticationToken</span> authenticationToken) <span class="keyword">throws</span> <span class="type">AuthenticationException</span> &#123;</span><br><span class="line">        <span class="comment">//在token中获取用户名</span></span><br><span class="line">        <span class="type">String</span> principal = (<span class="type">String</span>)authenticationToken.getPrincipal();</span><br><span class="line">        <span class="type">System</span>.out.println(principal);</span><br><span class="line">        <span class="comment">//根据身份信息使用JDBC Mybatis查询相关数据库</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"xiaochen"</span>.equals(principal))&#123;</span><br><span class="line">            <span class="comment">//参数1：数据库中查询到的用户名   //参数2：返回数据库中正确密码  //参数3：提供当前realm的名字 this.getName();</span></span><br><span class="line">            <span class="type">SimpleAuthenticationInfo</span> simpleAuthenticationInfo = <span class="keyword">new</span> <span class="type">SimpleAuthenticationInfo</span>(principal,<span class="string">"123"</span>,<span class="keyword">this</span>.getName());</span><br><span class="line">            <span class="keyword">return</span> simpleAuthenticationInfo;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>写一个类来测试一下<br>TestCustomerRealmAuthenticator<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.realm.CustomerRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.IncorrectCredentialsException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UnknownAccountException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.DefaultSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用自定义realm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCustomerRealmAuthenticator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> void main(<span class="type">String</span>[] args) &#123;</span><br><span class="line">        <span class="comment">//创建securityManager</span></span><br><span class="line">        <span class="type">DefaultSecurityManager</span> defaultSecurityManager = new <span class="type">DefaultSecurityManager</span>();</span><br><span class="line">        <span class="comment">//设置自定义realm</span></span><br><span class="line">        defaultSecurityManager.setRealm(new <span class="type">CustomerRealm</span>());</span><br><span class="line">        <span class="comment">//将安全工具类设置安全工具类</span></span><br><span class="line">        <span class="type">SecurityUtils</span>.setSecurityManager(defaultSecurityManager);</span><br><span class="line">        <span class="comment">//通过安全工具类获取subject</span></span><br><span class="line">        <span class="type">Subject</span> subject = <span class="type">SecurityUtils</span>.getSubject();</span><br><span class="line">        <span class="comment">//创建token</span></span><br><span class="line">        <span class="type">UsernamePasswordToken</span> token = new <span class="type">UsernamePasswordToken</span>(<span class="string">"xiaochen"</span>, <span class="string">"123"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subject.login(token);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="type">UnknownAccountException</span> e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"用户名错误"</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (<span class="type">IncorrectCredentialsException</span> e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"密码错误"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这样自定义的realm就写好了  以后只需要将CustomerRealm中<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据身份信息使用JDBC Mybatis查询相关数据库</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">"xiaochen"</span>.equals(principal))&#123;</span><br><span class="line">    <span class="comment">//参数1：数据库中查询到的用户名   //参数2：返回数据库中正确密码  //参数3：提供当前realm的名字 this.getName();</span></span><br><span class="line">    SimpleAuthenticationInfo simpleAuthenticationInfo = <span class="keyword">new</span> <span class="constructor">SimpleAuthenticationInfo(<span class="params">principal</span>,<span class="string">"123"</span>,<span class="params">this</span>.<span class="params">getName</span>()</span>);</span><br><span class="line">    return simpleAuthenticationInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>修改为JDBC或Mybatis即可</p><h1 id="MD5和Salt的简介和执行流程说明"><a href="#MD5和Salt的简介和执行流程说明" class="headerlink" title="MD5和Salt的简介和执行流程说明"></a>MD5和Salt的简介和执行流程说明</h1><p>刚才虽然完成了自定义realm的实现，但是还有一个问题就是，认证用的密码还在是明文存储的 </p><p>一般开发中都是加密和加盐的  避免安全隐患(sql注入)</p><ul><li><p>MD5算法：</p><ul><li><p>作用：一般用来加密 或者 签名(检验和)</p></li><li><p>特点：MD5算法不可逆  如果内容相同无论执行多少次md5生成结果始终是一致的</p></li><li><p>生成结果：始终是一个16进制 32位长度字符串</p></li></ul></li></ul><h2 id="MD5-Salt实现"><a href="#MD5-Salt实现" class="headerlink" title="MD5+Salt实现"></a>MD5+Salt实现</h2><p>先来测试一下md5的用法<br>TestShiroMD5<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit;</span><br><span class="line"></span><br><span class="line">import org.apache.shiro.crypto.hash.Md5Hash;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> TestShiroMD5 &#123;</span><br><span class="line">    public static void main(String<span class="literal">[]</span> args) &#123;</span><br><span class="line">        <span class="comment">//创建一个md5算法</span></span><br><span class="line"><span class="comment">//        Md5Hash md5Hash = new Md5Hash();</span></span><br><span class="line"><span class="comment">//        md5Hash.setBytes("123".getBytes());</span></span><br><span class="line"><span class="comment">//        String s = md5Hash.toHex();</span></span><br><span class="line"><span class="comment">//        System.out.println(s);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用md5</span></span><br><span class="line">        Md5Hash md5Hash = <span class="keyword">new</span> <span class="constructor">Md5Hash(<span class="string">"123"</span>)</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(md5Hash.<span class="keyword">to</span><span class="constructor">Hex()</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//使用md5+salt处理</span></span><br><span class="line">        Md5Hash md5Hash1 = <span class="keyword">new</span> <span class="constructor">Md5Hash(<span class="string">"123"</span>,<span class="string">"X0*7ps"</span>)</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(md5Hash1.<span class="keyword">to</span><span class="constructor">Hex()</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用md5 + salt + hash散列</span></span><br><span class="line">        Md5Hash md5Hash2 = <span class="keyword">new</span> <span class="constructor">Md5Hash(<span class="string">"123"</span>, <span class="string">"X0*7ps"</span>, 1024)</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(md5Hash2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">202</span>cb<span class="number">962</span>ac<span class="number">59075</span>b<span class="number">964</span>b<span class="number">07152</span>d<span class="number">234</span>b<span class="number">70</span></span><br><span class="line"><span class="number">8</span>a<span class="number">83592</span>a<span class="number">02263</span>bfe<span class="number">6752</span>b<span class="number">2</span>b<span class="number">5</span>b<span class="number">03</span>a<span class="number">4799</span></span><br><span class="line">e<span class="number">4</span>f<span class="number">9</span>bf<span class="number">3e0</span><span class="keyword">c</span><span class="number">58</span>f<span class="number">045e62</span><span class="keyword">c</span><span class="number">23</span><span class="keyword">c</span><span class="number">533</span>fcf<span class="number">633</span></span><br></pre></td></tr></table></figure></p><p>创建一个CustomerMd5Realm<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.realm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationException</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">AuthenticationToken</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.<span class="type">SimpleAuthenticationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.<span class="type">AuthorizationInfo</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.<span class="type">AuthorizingRealm</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.<span class="type">PrincipalCollection</span>;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.util.<span class="type">ByteSource</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用自定义realm 加入md5 + salt +hash</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomerMd5Realm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthorizationInfo</span> doGetAuthorizationInfo(<span class="type">PrincipalCollection</span> principalCollection) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">AuthenticationInfo</span> doGetAuthenticationInfo(<span class="type">AuthenticationToken</span> authenticationToken) <span class="keyword">throws</span> <span class="type">AuthenticationException</span> &#123;</span><br><span class="line">        <span class="comment">//获取身份信息</span></span><br><span class="line">        <span class="type">String</span> principal = (<span class="type">String</span>)authenticationToken.getPrincipal();</span><br><span class="line"></span><br><span class="line"><span class="comment">//        if("xiaochen".equals(principal))&#123;</span></span><br><span class="line"><span class="comment">//            return new SimpleAuthenticationInfo(principal,</span></span><br><span class="line"><span class="comment">//                    "202cb962ac59075b964b07152d234b70",</span></span><br><span class="line"><span class="comment">//                    this.getName());</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//参数1 数据库用户名  参数2 数据库md5+salt之后的密码 参数3 注册时的随机盐 参数4 realm的名字</span></span><br><span class="line"><span class="comment">//        if("xiaochen".equals(principal))&#123;</span></span><br><span class="line"><span class="comment">//            return new SimpleAuthenticationInfo(principal,</span></span><br><span class="line"><span class="comment">//                    "8a83592a02263bfe6752b2b5b03a4799",</span></span><br><span class="line"><span class="comment">//                    ByteSource.Util.bytes("X0*7ps"),</span></span><br><span class="line"><span class="comment">//                    this.getName());</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"xiaochen"</span>.equals(principal))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="type">SimpleAuthenticationInfo</span>(principal,</span><br><span class="line">                    <span class="string">"e4f9bf3e0c58f045e62c23c533fcf633"</span>,</span><br><span class="line">                    <span class="type">ByteSource</span>.<span class="type">Util</span>.bytes(<span class="string">"X0*7ps"</span>),</span><br><span class="line">                    <span class="keyword">this</span>.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>这里就直接用md5 + salt + hash来演示了</p><p>再创建TestCustomerMd5RealmAuthenticator类<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit;</span><br><span class="line"></span><br><span class="line">import com.ceit.realm.CustomerMd5Realm;</span><br><span class="line">import org.apache.shiro.SecurityUtils;</span><br><span class="line">import org.apache.shiro.authc.AuthenticationException;</span><br><span class="line">import org.apache.shiro.authc.IncorrectCredentialsException;</span><br><span class="line">import org.apache.shiro.authc.UnknownAccountException;</span><br><span class="line">import org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line">import org.apache.shiro.authc.credential.HashedCredentialsMatcher;</span><br><span class="line">import org.apache.shiro.mgt.DefaultSecurityManager;</span><br><span class="line">import org.apache.shiro.subject.Subject;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> TestCustomerMd5RealmAuthenticator &#123;</span><br><span class="line">    public static void main(String<span class="literal">[]</span> args) &#123;</span><br><span class="line">        <span class="comment">//创建安全管理器</span></span><br><span class="line">        DefaultSecurityManager defaultSecurityManager = <span class="keyword">new</span> <span class="constructor">DefaultSecurityManager()</span>;</span><br><span class="line">        <span class="comment">//注入realm</span></span><br><span class="line">        CustomerMd5Realm realm = <span class="keyword">new</span> <span class="constructor">CustomerMd5Realm()</span>;</span><br><span class="line">        <span class="comment">//设置realm使用hash凭证匹配器</span></span><br><span class="line">        HashedCredentialsMatcher credentialsMatcher = <span class="keyword">new</span> <span class="constructor">HashedCredentialsMatcher()</span>;</span><br><span class="line">        <span class="comment">//使用算法</span></span><br><span class="line">        credentialsMatcher.set<span class="constructor">HashAlgorithmName(<span class="string">"md5"</span>)</span>;</span><br><span class="line">        <span class="comment">//散列次数</span></span><br><span class="line">        credentialsMatcher.set<span class="constructor">HashIterations(1024)</span>;</span><br><span class="line">        realm.set<span class="constructor">CredentialsMatcher(<span class="params">credentialsMatcher</span>)</span>;</span><br><span class="line"></span><br><span class="line">        defaultSecurityManager.set<span class="constructor">Realm(<span class="params">realm</span>)</span>;</span><br><span class="line">        <span class="comment">//通过安全工具类获取subject</span></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">SecurityUtils</span>.</span></span>set<span class="constructor">SecurityManager(<span class="params">defaultSecurityManager</span>)</span>;</span><br><span class="line">        <span class="comment">//通过安全工具类获取subject</span></span><br><span class="line">        Subject subject = <span class="module-access"><span class="module"><span class="identifier">SecurityUtils</span>.</span></span>get<span class="constructor">Subject()</span>;</span><br><span class="line">        <span class="comment">//创建token</span></span><br><span class="line">        UsernamePasswordToken token = <span class="keyword">new</span> <span class="constructor">UsernamePasswordToken(<span class="string">"xiaochen"</span>, <span class="string">"123"</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subject.login(token);</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"登录成功"</span>);</span><br><span class="line">        &#125; catch (UnknownAccountException e) &#123;</span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"用户名错误"</span>);</span><br><span class="line">        &#125;catch (IncorrectCredentialsException e)&#123;</span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"密码错误"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>运行结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">登录成功</span><br></pre></td></tr></table></figure></p><p>这样一个md5+salt+hash的认证就完成了</p><p>到这里shiro的认证就基本完成了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;shiro中自定义Realm的实现&quot;&gt;&lt;a href=&quot;#shiro中自定义Realm的实现&quot; class=&quot;headerlink&quot; title=&quot;shiro中自定义Realm的实现&quot;&gt;&lt;/a&gt;shiro中自定义Realm的实现&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;最
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/11/16-用户认证</title>
    <link href="http://yoursite.com/2020/11/16/Shiro-2020-11-16-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/11/16/Shiro-2020-11-16-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-11-16T10:22:41.000Z</published>
    <updated>2021-02-21T04:57:48.517Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第一个程序用户认证"><a href="#第一个程序用户认证" class="headerlink" title="第一个程序用户认证"></a>第一个程序用户认证</h1><h2 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h2><p>由于现在还不需要整合到SSM中，所以直接创建maven的quickstart就可以了</p><p>引入相关依赖，并且调整一下Java的目录结构</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>还需要引入shiro的配置文件，配置文件后缀为<code>.ini</code>结尾的文件  shiro对名字和位置没有过于严格的要求  只需要放在当前项目下的任意位置即可  </p><p>在整合了Spring boot后，是不需要这个配置文件的 只是在学习过程中使用</p><p>shiro.ini<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[users]</span></span><br><span class="line"><span class="attr">xiaochen</span>=<span class="number">123</span></span><br><span class="line"><span class="attr">zhangsan</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">lisi</span>=<span class="number">789</span></span><br></pre></td></tr></table></figure><br>[users]是写死的，后面的数据必须以键值对的方式来写</p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ol><li><p>创建安全管理器对象</p></li><li><p>给安全管理器设置realm</p></li><li><p>SecurityUtils 给全局安全工具类设置安全管理器</p></li><li><p>关键对象  subject 主体</p></li><li><p>创建令牌</p></li></ol><p>创建一个TestAuthenticator类<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit;</span><br><span class="line"></span><br><span class="line">import org.apache.shiro.SecurityUtils;</span><br><span class="line">import org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line">import org.apache.shiro.mgt.DefaultSecurityManager;</span><br><span class="line">import org.apache.shiro.mgt.SecurityManager;</span><br><span class="line">import org.apache.shiro.realm.text.IniRealm;</span><br><span class="line">import org.apache.shiro.subject.Subject;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> TestAuthenticator &#123;</span><br><span class="line">    public static void main(String<span class="literal">[]</span> args) &#123;</span><br><span class="line">        <span class="comment">//1. 创建安全管理器对象</span></span><br><span class="line">        DefaultSecurityManager securityManager = <span class="keyword">new</span> <span class="constructor">DefaultSecurityManager()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 给安全管理器设置realm</span></span><br><span class="line">        securityManager.set<span class="constructor">Realm(<span class="params">new</span> IniRealm(<span class="string">"classpath:shiro.ini"</span>)</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. SecurityUtils 给全局安全工具类设置安全管理器</span></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">SecurityUtils</span>.</span></span>set<span class="constructor">SecurityManager(<span class="params">securityManager</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 关键对象  subject 主体</span></span><br><span class="line">        Subject subject = <span class="module-access"><span class="module"><span class="identifier">SecurityUtils</span>.</span></span>get<span class="constructor">Subject()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. 创建令牌</span></span><br><span class="line">        UsernamePasswordToken token = <span class="keyword">new</span> <span class="constructor">UsernamePasswordToken(<span class="string">"xiaochen"</span>,<span class="string">"123"</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"认证状态："</span>+subject.is<span class="constructor">Authenticated()</span>);</span><br><span class="line">            subject.login(token); <span class="comment">//用户认证</span></span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"认证状态："</span>+subject.is<span class="constructor">Authenticated()</span>);</span><br><span class="line">        &#125;catch (UnknownAccountException e)&#123;</span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"用户名不存在"</span>);</span><br><span class="line">        &#125;catch (IncorrectCredentialsException e)&#123;</span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"密码错误"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这里踩了一个坑 提示了报错<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">SLF4J</span>: <span class="selector-tag">Failed</span> <span class="selector-tag">to</span> <span class="selector-tag">load</span> <span class="selector-tag">class</span> "<span class="selector-tag">org</span><span class="selector-class">.slf4j</span><span class="selector-class">.impl</span><span class="selector-class">.StaticLoggerBinder</span></span><br></pre></td></tr></table></figure><br>查了一下只需要maven引入依赖即可<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-nop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>正常认证通过的话，是不会有异常抛出的<br>运行结果<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">认证状态：<span class="literal">false</span></span><br><span class="line">认证状态：<span class="literal">true</span></span><br></pre></td></tr></table></figure></p><p>如果没有认证通过<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">org</span><span class="selector-class">.apache</span><span class="selector-class">.shiro</span><span class="selector-class">.authc</span><span class="selector-class">.UnknownAccountException</span></span><br></pre></td></tr></table></figure><br>则会直接抛出这样的异常  异常的意思就是用户名不存在</p><p>如果是用户名正确而密码不正确就会抛出<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">org</span><span class="selector-class">.apache</span><span class="selector-class">.shiro</span><span class="selector-class">.authc</span><span class="selector-class">.IncorrectCredentialsException</span></span><br></pre></td></tr></table></figure><br>这异常就是密码错误</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;第一个程序用户认证&quot;&gt;&lt;a href=&quot;#第一个程序用户认证&quot; class=&quot;headerlink&quot; title=&quot;第一个程序用户认证&quot;&gt;&lt;/a&gt;第一个程序用户认证&lt;/h1&gt;&lt;h2 id=&quot;相关配置&quot;&gt;&lt;a href=&quot;#相关配置&quot; class=&quot;headerli
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-2020/11/11-基础概念</title>
    <link href="http://yoursite.com/2020/11/11/Shiro-2020-11-11-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/11/11/Shiro-2020-11-11-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-11-11T06:05:00.000Z</published>
    <updated>2021-02-21T04:57:50.549Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Shiro"><a href="#Shiro" class="headerlink" title="Shiro"></a>Shiro</h1><ul><li><p>学习目标</p><ol><li><p>基于url权限管理和shiro基础</p></li><li><p>shiro与企业web项目整合开发的方法</p></li></ol></li><li><p>权限管理</p><ol><li><p>用户认证</p></li><li><p>用户授权</p></li></ol></li><li><p>shiro基础</p><ol><li><p>shiro架构</p></li><li><p>shiro进行用户认证的方法</p></li><li><p>shiro进行用户授权的方法</p></li></ol></li></ul><h2 id="什么是权限管理"><a href="#什么是权限管理" class="headerlink" title="什么是权限管理"></a>什么是权限管理</h2><p>只要有用户参与的系统，一般都需要有权限管理，权限管理实现对用户访问系统的控制，按照安全规则或者安全策略控制用户可以访问而且只能访问自己被授权的资源</p><p>分为用户认证和授权两部分</p><h3 id="用户认证"><a href="#用户认证" class="headerlink" title="用户认证"></a>用户认证</h3><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>用户去访问系统，系统要验证用户身份的合法性，最常用的用户身份验证的方法：</p><ol><li><p>用户名密码</p></li><li><p>指纹打卡机</p></li><li><p>基于证书的验证方法…</p></li></ol><p>系统验证用户身份合法，用户方可访问系统的资源</p><h4 id="关键对象"><a href="#关键对象" class="headerlink" title="关键对象"></a>关键对象</h4><ul><li><p>subject:主体 理解为用户，可能是程序，都要去访问系统的资源，系统需要对subject进行身份认证</p></li><li><p>principal:身份信息，通常是唯一的，一个主体还有多个身份信息，但是都有一个主身份信息(primary principal)</p></li><li><p>credential:凭证信息，可以是密码，证书，指纹</p></li></ul><p>总体：主体在进行身份认证时需要提供身份信息和凭证信息</p><h3 id="用户授权"><a href="#用户授权" class="headerlink" title="用户授权"></a>用户授权</h3><h4 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h4><p>简单理解为访问控制，在用户认证通过后，系统对用户访问资源进行控制，用户具有资源的访问权限方可访问</p><h4 id="关键对象-1"><a href="#关键对象-1" class="headerlink" title="关键对象"></a>关键对象</h4><ul><li><p>授权的过程理解为：who对what(which)进行how操作</p></li><li><p>who:主体即subject，subject在认证通过后系统进行访问控制</p></li><li><p>what(which):资源(Resource)，subject必须具备资源的访问权限方可访问该资源。资源比如：系统用户列表页面、商品修改菜单、商品id为001的商品信息</p><ul><li><p>资源分为资源类型和资源实例</p></li><li><p>系统的用户信息就是资源类型，相当于java类</p></li><li><p>系统中id为001的用户就是资源实例相当于new的java对象</p></li></ul></li><li><p>how:权限/许可(permission)，针对资源的权限或许可，subject具有permission，如何访问/操作需要定义permission，比如：用户添加、用户修改、商品删除</p></li></ul><h4 id="分配权限"><a href="#分配权限" class="headerlink" title="分配权限"></a>分配权限</h4><p>用户需要分配相应的权限才可访问相应的资源。权限是对于资源的操作许可</p><p>通常给用户分配资源权限需要将权限信息持久化，比如存储在关系数据库中</p><h4 id="权限控制-授权核心"><a href="#权限控制-授权核心" class="headerlink" title="权限控制(授权核心)"></a>权限控制(授权核心)</h4><p>基于角色的访问控制(RBAC-Role based access control)<br>比如：<br>系统角色包括：部门经理，总经理（角色针对用户来划分）</p><p>系统代码中实现：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果该user是部门经理则可以访问if中的代码</span></span><br><span class="line"><span class="function"><span class="title">if</span><span class="params">(user.hasRole(<span class="string">'部门经理'</span>)</span></span>)&#123;</span><br><span class="line"><span class="comment">//代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>问题：<br>角色针对人划分的，人作为用户在系统中属于活动内容，如果该角色可以访问的资源出现变更，需要修改你的代码了，比如：需求变更为部门经理和总经理都可以查看用户报表，代码改为<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(<span class="keyword">user</span>.hasRole(<span class="string">'部门经理'</span>)|| <span class="keyword">user</span>.hasRole(<span class="string">'总经理'</span>))&#123;</span><br><span class="line">//代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>基于角色的访问控制是不利于系统维护的(可拓展性不强)</p><p>基于资源的访问控制(RBAC-Resource based access control)<br>资源在系统中是不变的，比如资源有：类中的方法，页面中的按钮</p><p>对资源的访问需要具有permission权限，代码可以写为：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(user.hasPermission(<span class="string">'用户报表查看'</span>)</span></span>)&#123;</span><br><span class="line"><span class="comment">//代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这种方式可以解决用户角色变更不用修改权限控制的代码</p><p>如果需要变更权限只需要在分配权限模块去操作，给部门经理或总经理增或删除权限</p><p>所以建议使用基于资源的访问控制</p><h2 id="权限管理解决方案"><a href="#权限管理解决方案" class="headerlink" title="权限管理解决方案"></a>权限管理解决方案</h2><h3 id="什么是粗粒度和细粒度权限"><a href="#什么是粗粒度和细粒度权限" class="headerlink" title="什么是粗粒度和细粒度权限"></a>什么是粗粒度和细粒度权限</h3><ul><li><p>粗粒度：对资源类型的权限管理</p><ul><li><p>资源类型：菜单,url链接,用户添加页面,用户信息,类方法,页面中按钮</p></li><li><p>比如：超级管理员可以访问用户添加页面，用户信息等全部页面；部门管理员可以访问用户信息页面</p></li></ul></li><li><p>细粒度：对资源实例的权限管理，数据级别的权限管理</p><ul><li><p>资源实例：就是资源类型的具体化，比如：用户id为001的修改连接,1110班的用户信息,行政部的员工</p></li><li><p>部门经理只可以访问本部门的员工信息，用户只可以看到自己的菜单，大区经理只可以查看本辖区的销售订单</p></li></ul></li></ul><h3 id="如何实现"><a href="#如何实现" class="headerlink" title="如何实现"></a>如何实现</h3><h4 id="粗粒度"><a href="#粗粒度" class="headerlink" title="粗粒度"></a>粗粒度</h4><p>比较容易将权限管理的代码抽取出来在系统架构级别统一处理</p><p>比如：通过springmvc的拦截器实现授权</p><h4 id="细粒度"><a href="#细粒度" class="headerlink" title="细粒度"></a>细粒度</h4><p>在数据级别没有共性可言，针对细粒度权限管理就是业务逻辑的一部分，如果在业务层去处理相对比较简单，如果将细粒度权限管理统一在系统架构级别去抽取，比较困难，即使抽取的功能可能也存在扩展性不强</p><p>建议细粒度权限管理在业务层去控制</p><p>比如：部门经理只查询本部门员工信息，在service接口提供一个部门id的参数，controller中根据当前用户的信息得到该用户属于哪个部门，调用service将部门id传入service，实现该用户只查询本部门的员工</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Shiro&quot;&gt;&lt;a href=&quot;#Shiro&quot; class=&quot;headerlink&quot; title=&quot;Shiro&quot;&gt;&lt;/a&gt;Shiro&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;学习目标&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;基于url权限管理和shiro基础&lt;/p&gt;
&lt;/li&gt;

      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/10/21-员工管理系统-5</title>
    <link href="http://yoursite.com/2020/10/21/SSM-2020-10-21-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/10/21/SSM-2020-10-21-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-10-21T10:30:53.000Z</published>
    <updated>2021-02-21T04:57:52.449Z</updated>
    
    <content type="html"><![CDATA[<h1 id="员工修改"><a href="#员工修改" class="headerlink" title="员工修改"></a>员工修改</h1><h2 id="更新信息"><a href="#更新信息" class="headerlink" title="更新信息"></a>更新信息</h2><p>如果将请求直接改为PUT，就会发现数据无法修改，请求体中有数据但Employee封装不上</p><p>原因：</p><ul><li><p>tomcat:</p><ol><li><p>将请求体中的数据，封装一个map</p></li><li><p>request.getParameter(“empName”)就会从这个map中取值</p></li><li><p>SpringMVC封装POJO对象的时候，会把POJO种每个属性的值，request.getParamter(“email”);</p></li><li><p>Tomcat检测到PUT请求就不会封装请求体数据为map，只有POST请求才会封装请求体</p></li></ol></li></ul><p>解决办法：<br>使用SpringMVC提供的过滤器HttpPutFormContentFilter</p><p>它的作用，将请求体中的数据解析包装成一个map，request被重新包装,request.getParameter()被重写，就会从自己封装的map中取数据</p><p>在web.xml中添加过滤器<br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">filter</span>&gt;</span><br><span class="line">  &lt;<span class="keyword">filter</span>-<span class="type">name</span>&gt;HttpPutFormContentFilter&lt;/<span class="keyword">filter</span>-<span class="type">name</span>&gt;</span><br><span class="line">  &lt;<span class="keyword">filter</span>-<span class="keyword">class</span>&gt;org.springframework.web.<span class="keyword">filter</span>.HttpPutFormContentFilter&lt;/<span class="keyword">filter</span>-<span class="keyword">class</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">filter</span>&gt;</span><br><span class="line">&lt;<span class="keyword">filter</span>-<span class="keyword">mapping</span>&gt;</span><br><span class="line">  &lt;<span class="keyword">filter</span>-<span class="type">name</span>&gt;HttpPutFormContentFilter&lt;/<span class="keyword">filter</span>-<span class="type">name</span>&gt;</span><br><span class="line">  &lt;url-pattern&gt;<span class="comment">/*&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">&lt;/filter-mapping&gt;</span></span><br></pre></td></tr></table></figure></p><p>index.jsp<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击更新，更新员工信息</span></span><br><span class="line">$(<span class="string">"#emp_update_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.验证邮箱是否合法</span></span><br><span class="line">    <span class="keyword">var</span> email = $(<span class="string">"#email_update_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regEmaill = <span class="regexp">/^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/</span> ;</span><br><span class="line">    <span class="keyword">if</span>(!regEmaill.test(email))&#123;</span><br><span class="line">        <span class="comment">// alert("邮箱格式不正确");</span></span><br><span class="line">        show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"error"</span>,<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.发送ajax请求，保存更新的员工数据</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>),</span><br><span class="line">        type:<span class="string">"PUT"</span>,</span><br><span class="line">        data:$(<span class="string">"#empUpdateModal form"</span>).serialize(),</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            alert(result.msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>现在就成功的更改了用户的数据</p><p>接下来就是完善这个更新逻辑，让其与之前的添加功能相同（关闭模态框，显示当前页）</p><p>定义一个全局变量currentPage，并在分页信息处赋值<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">currentPage</span> = result.extend.pageInfo.pageNum<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>最后的编辑功能<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击更新，更新员工信息</span></span><br><span class="line">$(<span class="string">"#emp_update_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.验证邮箱是否合法</span></span><br><span class="line">    <span class="keyword">var</span> email = $(<span class="string">"#email_update_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regEmaill = <span class="regexp">/^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/</span> ;</span><br><span class="line">    <span class="keyword">if</span>(!regEmaill.test(email))&#123;</span><br><span class="line">        <span class="comment">// alert("邮箱格式不正确");</span></span><br><span class="line">        show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"error"</span>,<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.发送ajax请求，保存更新的员工数据</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>),</span><br><span class="line">        type:<span class="string">"PUT"</span>,</span><br><span class="line">        data:$(<span class="string">"#empUpdateModal form"</span>).serialize(),</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//alert(result.msg);</span></span><br><span class="line">            <span class="comment">//1.关闭模态框</span></span><br><span class="line">            $(<span class="string">"#empUpdateModal"</span>).modal(<span class="string">"hide"</span>);</span><br><span class="line">            <span class="comment">//2.回到本页面</span></span><br><span class="line">            to_page(currentPage);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h1 id="员工删除"><a href="#员工删除" class="headerlink" title="员工删除"></a>员工删除</h1><p>效果图：<br><img src="/img/JavaWeb/10-21学习日记/0.png" alt="avatar"></p><p>我们想要实现的功能就是两种，第一种是单项删除，第二种就是选中然后一键删除</p><p>逻辑：</p><ol><li>单个删除<ul><li>URI：/emp{id} DELETE</li></ul></li></ol><h2 id="单个删除"><a href="#单个删除" class="headerlink" title="单个删除"></a>单个删除</h2><p>和之前的编辑差不多</p><p>在Controller中添加<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@ResponseBody</span></span><br><span class="line"><span class="variable">@RequestMapping</span>(value = <span class="string">"/emp/&#123;id&#125;"</span>,method = RequestMethod.DELETE)</span><br><span class="line">public Msg deleteEmpById(<span class="variable">@PathVariable</span>(<span class="string">"id"</span>)Integer id)&#123;</span><br><span class="line">    <span class="selector-tag">employeeService</span><span class="selector-class">.deleteEmp</span>(id);</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">Msg</span><span class="selector-class">.success</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Service:<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工删除</span></span><br><span class="line"><span class="comment"> * @param id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public void delete<span class="constructor">Emp(Integer <span class="params">id</span>)</span> &#123;</span><br><span class="line">    employeeMapper.delete<span class="constructor">ByPrimaryKey(<span class="params">id</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>给删除按钮添加自定义属性”del-id”</p><p>index.jsp：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单个删除</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".delete_btn"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.弹出确认删除对话框</span></span><br><span class="line">    <span class="keyword">var</span> empName = $(<span class="keyword">this</span>).parents(<span class="string">"tr"</span>).find(<span class="string">"td:eq(1)"</span>).text();</span><br><span class="line">    <span class="keyword">var</span> empId = $(<span class="keyword">this</span>).attr(<span class="string">"del-id"</span>);</span><br><span class="line">    <span class="comment">//alert($(this).parents("tr").find("td:eq(1)").text());</span></span><br><span class="line">    <span class="keyword">if</span>(confirm(<span class="string">"确认删除["</span>+empName+<span class="string">"]吗？"</span>))&#123;</span><br><span class="line">        <span class="comment">//确认，发送ajax请求删除即可</span></span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">           url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+empId,</span><br><span class="line">            type:<span class="string">"DELETE"</span>,</span><br><span class="line">            success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">                alert(result.msg);</span><br><span class="line">                <span class="comment">//回到本页</span></span><br><span class="line">                to_page(currentPage);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>单个删除目前功能已经实现了</p><h2 id="多选删除"><a href="#多选删除" class="headerlink" title="多选删除"></a>多选删除</h2><p>表头需要一个checkbox</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">&lt;tr&gt;</span></span><br><span class="line">    <span class="symbol">&lt;th&gt;</span></span><br><span class="line">        &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">"checkbox"</span> id=<span class="string">"check_all"</span>/&gt;</span><br><span class="line">    &lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">    <span class="symbol">&lt;th&gt;</span>#&lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">    <span class="symbol">&lt;th&gt;</span>empName&lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">    <span class="symbol">&lt;th&gt;</span>gender&lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">    <span class="symbol">&lt;th&gt;</span>email&lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">    <span class="symbol">&lt;th&gt;</span>deptName&lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">    <span class="symbol">&lt;th&gt;</span>操作&lt;/<span class="keyword">th</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">tr</span>&gt;</span><br></pre></td></tr></table></figure><p>同时也要给他添加进遍历里<br><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build_emps_tables</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//清空table</span></span><br><span class="line">    $(<span class="string">"#emps_table tbody"</span>).empty();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> emps=result.extend.pageInfo.list;</span><br><span class="line">    $.each(emps,<span class="function"><span class="keyword">function</span> (<span class="params">index,item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> checkBoxTd = $(<span class="string">"&lt;td&gt;&lt;input type='checkbox' class='check_item' /&gt;&lt;/td&gt;"</span>);</span><br></pre></td></tr></table></figure></p><p>接着编写点击事件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//完成全选/全不选</span></span><br><span class="line">$(<span class="string">"#check_all"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//attr获取checked是undefined</span></span><br><span class="line">    <span class="comment">//我们这些dom原生的属性,attr获取自定义属性的值</span></span><br><span class="line">    <span class="comment">//prop修改和读取dom原生属性的值</span></span><br><span class="line">   $(<span class="string">".check_item"</span>).prop(<span class="string">"checked"</span>,$(<span class="keyword">this</span>).prop(<span class="string">"checked"</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断当前选择中的元素是否5个</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".check_item"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flag = $(<span class="string">".check_item:checked"</span>).length == $(<span class="string">".check_item"</span>).length;</span><br><span class="line">    $(<span class="string">"#check_all"</span>).prop(<span class="string">"checked"</span>,flag);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>这样一个多选功能就完成了</p><p>为了增加代码复用，我们修改一下Controller<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 单个批量二合一</span></span><br><span class="line"><span class="comment"> * 批量删除：1-2-3</span></span><br><span class="line"><span class="comment"> * 单个删除：1</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param ids</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@ResponseBody</span><br><span class="line">@<span class="constructor">RequestMapping(<span class="params">value</span> = <span class="string">"/emp/&#123;ids&#125;"</span>,<span class="params">method</span> = RequestMethod.DELETE)</span></span><br><span class="line">public Msg delete<span class="constructor">Emp(@PathVariable(<span class="string">"ids"</span>)</span>String ids)&#123;</span><br><span class="line">    <span class="comment">//批量删除</span></span><br><span class="line">    <span class="keyword">if</span>(ids.contains(<span class="string">"-"</span>))&#123;</span><br><span class="line">        List&lt;Integer&gt; del_ids = <span class="keyword">new</span> ArrayList&lt;&gt;<span class="literal">()</span>;</span><br><span class="line">        String<span class="literal">[]</span> str_ids = ids.split(<span class="string">"-"</span>);</span><br><span class="line">        <span class="comment">//组装id的集合</span></span><br><span class="line">        for(String <span class="built_in">string</span> : str_ids)&#123;</span><br><span class="line">            del_ids.add(<span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>parse<span class="constructor">Int(<span class="params">string</span>)</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        employeeService.delete<span class="constructor">Batch(<span class="params">del_ids</span>)</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        Integer id = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>parse<span class="constructor">Int(<span class="params">ids</span>)</span>;</span><br><span class="line">        employeeService.delete<span class="constructor">Emp(<span class="params">id</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    return <span class="module-access"><span class="module"><span class="identifier">Msg</span>.</span></span>success<span class="literal">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>以及Service对应的方法<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public void delete<span class="constructor">Batch(List&lt;Integer&gt; <span class="params">ids</span>)</span> &#123;</span><br><span class="line">    EmployeeExample example = <span class="keyword">new</span> <span class="constructor">EmployeeExample()</span>;</span><br><span class="line">    EmployeeExample.Criteria criteria = example.create<span class="constructor">Criteria()</span>;</span><br><span class="line">    <span class="comment">//delete from xxx where emp_id in(1,2,3)</span></span><br><span class="line">    criteria.<span class="keyword">and</span><span class="constructor">EmpIdIn(<span class="params">ids</span>)</span>;</span><br><span class="line">    employeeMapper.delete<span class="constructor">ByExample(<span class="params">example</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>index.jsp也简要修改<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击全部删除，就批量删除</span></span><br><span class="line">    $(<span class="string">"#emp_delete_all_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//$(".check_item:checked")</span></span><br><span class="line">        <span class="keyword">var</span> empNames = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">var</span> del_idstr = <span class="string">""</span>;</span><br><span class="line">        $.each($(<span class="string">".check_item:checked"</span>),<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">           <span class="comment">//this</span></span><br><span class="line">            empNames += $(<span class="keyword">this</span>).parents(<span class="string">"tr"</span>).find(<span class="string">"td:eq(2)"</span>).text()+<span class="string">"，"</span>;</span><br><span class="line">            <span class="comment">//组装员工id字符串</span></span><br><span class="line">            del_idstr += $(<span class="keyword">this</span>).parents(<span class="string">"tr"</span>).find(<span class="string">"td:eq(1)"</span>).text()+<span class="string">"-"</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//去除empNames多余的,</span></span><br><span class="line">        empNames = empNames.substring(<span class="number">0</span>,empNames.length<span class="number">-1</span>);</span><br><span class="line">        <span class="comment">//去除删除的id多余的-</span></span><br><span class="line">        del_idstr = del_idstr.substring(<span class="number">0</span>,del_idstr.length<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span>(confirm(<span class="string">"确认删除["</span>+empNames+<span class="string">"]吗？"</span>))&#123;</span><br><span class="line">            <span class="comment">//发送ajax请求</span></span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">               url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+del_idstr,</span><br><span class="line">               type:<span class="string">"DELETE"</span>,</span><br><span class="line">               success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123;</span><br><span class="line">                   alert(result.msg);</span><br><span class="line">                   <span class="comment">//回到当前页面</span></span><br><span class="line">                   to_page(currentPage);</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><br>这样就完成了一个多选删除的功能，单选删除也同样奏效</p><p>到这里整个的增删改查功能就全部做完了</p><p>最后的index.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 员工添加的模态框 --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@qq.com"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_add_input"</span> <span class="attr">value</span>=<span class="string">"M"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_add_input"</span> <span class="attr">value</span>=<span class="string">"F"</span>&gt;</span> 女</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                            部门提交部门id即可-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"dId"</span> <span class="attr">id</span>=<span class="string">"dept_add_select"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                                部门名称-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_save_btn"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-员工修改的模态框-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empUpdateModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span>&gt;</span>员工修改<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"form-control-static"</span> <span class="attr">id</span>=<span class="string">"empName_update_static"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_update_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@qq.com"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_update_input"</span> <span class="attr">value</span>=<span class="string">"M"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_update_input"</span> <span class="attr">value</span>=<span class="string">"F"</span>&gt;</span> 女</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                            部门提交部门id即可-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"dId"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-  部门名称-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_update_btn"</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_add_modal_btn"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span> <span class="attr">id</span>=<span class="string">"emp_delete_all_btn"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"check_all"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    var totalRecords,currentPage;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">    $(function ()&#123;</span></span><br><span class="line"><span class="xml">        //去首页</span></span><br><span class="line"><span class="xml">        to_page(1);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function to_page(pn) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">            data:"pn="+pn,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                build_page_info(result);</span></span><br><span class="line"><span class="xml">                //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                build_page_nav(result);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空table</span></span><br><span class="line"><span class="xml">        $("#emps_table tbody").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">        $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var checkBoxTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'checkbox'</span> <span class="attr">class</span>=<span class="string">'check_item'</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>");</span></span><br><span class="line"><span class="xml">            var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">            var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">            var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">            var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">            var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             编辑</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm edit_btn")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">            //为编辑按钮添加一个自定义的属性，来表示当前员工id</span></span><br><span class="line"><span class="xml">            editBtn.attr("edit-id",item.empId);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             删除</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm delete_btn")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"><span class="xml">            //为删除按钮添加一个自定义的属性，来表示当前员工id</span></span><br><span class="line"><span class="xml">            delBtn.attr("del-id",item.empId);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">            $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(checkBoxTd)</span></span><br><span class="line"><span class="xml">                .append(empIdTd)</span></span><br><span class="line"><span class="xml">                .append(empNameTd)</span></span><br><span class="line"><span class="xml">                .append(genderTd)</span></span><br><span class="line"><span class="xml">                .append(emailTd)</span></span><br><span class="line"><span class="xml">                .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                .append(btnTd)</span></span><br><span class="line"><span class="xml">                .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页信息</span></span><br><span class="line"><span class="xml">    function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">        //清空分页信息</span></span><br><span class="line"><span class="xml">        $("#page_info_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">        totalRecords = result.extend.pageInfo.total;</span></span><br><span class="line"><span class="xml">        currentPage = result.extend.pageInfo.pageNum;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">    function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空</span></span><br><span class="line"><span class="xml">        $("#page_nav_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //page_nav_area</span></span><br><span class="line"><span class="xml">        var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span></span><br><span class="line"><span class="xml">            firstPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            prePageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            firstPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            prePageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum-1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">        var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasNextPage == false)&#123;</span></span><br><span class="line"><span class="xml">            nextPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            lastPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            nextPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum+1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            lastPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pages);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">        ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">        //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">        $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">            if(result.extend.pageInfo.pageNum == item)&#123;</span></span><br><span class="line"><span class="xml">                numLi.addClass("active");</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            numLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(item);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            ul.append(numLi);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">        ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">        var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">        navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //清空表单样式及内容</span></span><br><span class="line"><span class="xml">    function reset_form(ele)&#123;</span></span><br><span class="line"><span class="xml">        $(ele)[0].reset();</span></span><br><span class="line"><span class="xml">        //清空样式</span></span><br><span class="line"><span class="xml">        $(ele).find("*").removeClass("has-success has-error");</span></span><br><span class="line"><span class="xml">        $(ele).find(".help-block").text("");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击新增按钮弹出模态框</span></span><br><span class="line"><span class="xml">    $("#emp_add_modal_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //清除数据，表单重置</span></span><br><span class="line"><span class="xml">        reset_form($("#empAddModal form"));</span></span><br><span class="line"><span class="xml">        //发送ajax请求，查出部门信息，显示在下拉列表</span></span><br><span class="line"><span class="xml">        getDepts("#empAddModal select");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //弹出模态框</span></span><br><span class="line"><span class="xml">        $("#empAddModal").modal(&#123;</span></span><br><span class="line"><span class="xml">            backdrop:"static"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //查出所有的部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="xml">    function getDepts(ele) &#123;</span></span><br><span class="line"><span class="xml">        //清空之前下拉列表的值</span></span><br><span class="line"><span class="xml">        $(ele).empty();</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">           url:"$&#123;APP_PATH&#125;/depts",</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                // console.log(result)</span></span><br><span class="line"><span class="xml">                //显示部门信息在下拉列表中</span></span><br><span class="line"><span class="xml">                // $("#dept_add_select").append("")</span></span><br><span class="line"><span class="xml">                $.each(result.extend.depts,function () &#123;</span></span><br><span class="line"><span class="xml">                    var optionEle = $("<span class="tag">&lt;<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span>").append(this.deptName).attr("value",this.deptId);</span></span><br><span class="line"><span class="xml">                    optionEle.appendTo(ele)</span></span><br><span class="line"><span class="xml">                &#125;);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //校验表单数据</span></span><br><span class="line"><span class="xml">    function validata_add_form()&#123;</span></span><br><span class="line"><span class="xml">        //1. 拿到要检验的数据，使用正则表达式</span></span><br><span class="line"><span class="xml">        var empName = $("#empName_add_input").val();</span></span><br><span class="line"><span class="xml">        var regName = /(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\u2E80-\u9FFF]&#123;2,5&#125;)/;</span></span><br><span class="line"><span class="xml">        if(!regName.test(empName))&#123;</span></span><br><span class="line"><span class="xml">            // alert("用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line"><span class="xml">            //清空这个元素之前的样式</span></span><br><span class="line"><span class="xml">            show_validate_msg("#empName_add_input","error","用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#empName_add_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //2. 校验邮箱信息</span></span><br><span class="line"><span class="xml">        var email = $("#email_add_input").val();</span></span><br><span class="line"><span class="xml">        var regEmaill = /^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/ ;</span></span><br><span class="line"><span class="xml">        if(!regEmaill.test(email))&#123;</span></span><br><span class="line"><span class="xml">            // alert("邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_add_input","error","邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_add_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        return true;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //显示校验信息</span></span><br><span class="line"><span class="xml">    function show_validate_msg(ele,status,msg)&#123;</span></span><br><span class="line"><span class="xml">        //清空这个元素之前的样式</span></span><br><span class="line"><span class="xml">        $(ele).parent().removeClass("has-success has-error");</span></span><br><span class="line"><span class="xml">        $(ele).next("span").text("");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        if(status == "success")&#123;</span></span><br><span class="line"><span class="xml">            $(ele).parent().addClass("has-success");</span></span><br><span class="line"><span class="xml">            $(ele).next("span").text(msg);</span></span><br><span class="line"><span class="xml">        &#125;else if(status == "error")&#123;</span></span><br><span class="line"><span class="xml">            $(ele).parent().addClass("has-error");</span></span><br><span class="line"><span class="xml">            $(ele).next("span").text(msg);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //校验用户名是否可用</span></span><br><span class="line"><span class="xml">    $("#empName_add_input").change(function () &#123;</span></span><br><span class="line"><span class="xml">        //发送ajax请求校验用户名是否可用</span></span><br><span class="line"><span class="xml">        var empName = this.value;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/checkUser",</span></span><br><span class="line"><span class="xml">            data:"empName="+empName,</span></span><br><span class="line"><span class="xml">            type:"POST",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                if(result.code == 200)&#123;</span></span><br><span class="line"><span class="xml">                    show_validate_msg("#empName_add_input","success","用户名可用");</span></span><br><span class="line"><span class="xml">                    $("#emp_save_btn").attr("ajax-va","success");</span></span><br><span class="line"><span class="xml">                &#125;else&#123;</span></span><br><span class="line"><span class="xml">                    show_validate_msg("#empName_add_input","error",result.extend.va_msg);</span></span><br><span class="line"><span class="xml">                    $("#emp_save_btn").attr("ajax-va","error");</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击保存，保存员工</span></span><br><span class="line"><span class="xml">    $("#emp_save_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line"><span class="xml">        //2.先对要提交给服务器的数据进行校验</span></span><br><span class="line"><span class="xml">        if(!validata_add_form())&#123;</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        //3.判断之前的ajax用户名校验是否成功</span></span><br><span class="line"><span class="xml">        if($(this).attr("ajax-va")=="error")&#123;</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        //4.发送ajax请求保存员工</span></span><br><span class="line"><span class="xml">        // alert($("#empAddModal form").serialize());</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emp",</span></span><br><span class="line"><span class="xml">            type:"POST",</span></span><br><span class="line"><span class="xml">            data:$("#empAddModal form").serialize(),</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                //alert(result.msg);</span></span><br><span class="line"><span class="xml">                if(result.code == 200)&#123;</span></span><br><span class="line"><span class="xml">                    //员工保存成功：</span></span><br><span class="line"><span class="xml">                    //1. 关闭模态框</span></span><br><span class="line"><span class="xml">                    $("#empAddModal").modal('hide');</span></span><br><span class="line"><span class="xml">                    //2. 来到最后一页，显示刚才保存的数据</span></span><br><span class="line"><span class="xml">                    //发送ajax请求显示最后一页数据即可</span></span><br><span class="line"><span class="xml">                    //可以将总记录数当作页码</span></span><br><span class="line"><span class="xml">                    to_page(totalRecords);</span></span><br><span class="line"><span class="xml">                &#125;else&#123;</span></span><br><span class="line"><span class="xml">                    //显示失败信息</span></span><br><span class="line"><span class="xml">                    // console.log(result);</span></span><br><span class="line"><span class="xml">                    //有哪个字段的错误信息，就显示哪个字段</span></span><br><span class="line"><span class="xml">                    if(undefined != result.extend.errorFields.email)&#123;</span></span><br><span class="line"><span class="xml">                        //显示邮箱错误信息</span></span><br><span class="line"><span class="xml">                        show_validate_msg("#email_add_input","error",result.extend.errorFields.email);</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    if(undefined != result.extend.errorFields.empName)&#123;</span></span><br><span class="line"><span class="xml">                        //显示员工错误信息</span></span><br><span class="line"><span class="xml">                        show_validate_msg("#empName_add_input","error",result.extend.result.extend.errorFields.empName);</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //1.按钮创建之前就绑定了click，所以绑定不上</span></span><br><span class="line"><span class="xml">    //1).可以在创建按钮的时候绑定事件 2).live()</span></span><br><span class="line"><span class="xml">    //jquery新版没有live，使用on方法进行替代</span></span><br><span class="line"><span class="xml">    $(document).on("click",".edit_btn",function () &#123;</span></span><br><span class="line"><span class="xml">      //alert("edit")</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //1.查出部门信息，并显示部门列表</span></span><br><span class="line"><span class="xml">        getDepts("#empUpdateModal select");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //2.查出员工信息，显示员工信息</span></span><br><span class="line"><span class="xml">        getEmp($(this).attr("edit-id"));</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //3.把员工的id传递给模态框的更新按钮</span></span><br><span class="line"><span class="xml">        $("#emp_update_btn").attr("edit-id",$(this).attr("edit-id"));</span></span><br><span class="line"><span class="xml">        $("#empUpdateModal").modal(&#123;</span></span><br><span class="line"><span class="xml">            backdrop:"static"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function getEmp(id) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emp/"+id,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                var empData = result.extend.emp;</span></span><br><span class="line"><span class="xml">                $("#empName_update_static").text(empData.empName);</span></span><br><span class="line"><span class="xml">                $("#email_update_input").val(empData.email);</span></span><br><span class="line"><span class="xml">                $("#empUpdateModal input[name=gender]").val([empData.gender]);</span></span><br><span class="line"><span class="xml">                $("#empUpdateModal select").val([empData.dId]);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击更新，更新员工信息</span></span><br><span class="line"><span class="xml">    $("#emp_update_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //1.验证邮箱是否合法</span></span><br><span class="line"><span class="xml">        var email = $("#email_update_input").val();</span></span><br><span class="line"><span class="xml">        var regEmaill = /^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/ ;</span></span><br><span class="line"><span class="xml">        if(!regEmaill.test(email))&#123;</span></span><br><span class="line"><span class="xml">            // alert("邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_update_input","error","邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_update_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        //2.发送ajax请求，保存更新的员工数据</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emp/"+$(this).attr("edit-id"),</span></span><br><span class="line"><span class="xml">            type:"PUT",</span></span><br><span class="line"><span class="xml">            data:$("#empUpdateModal form").serialize(),</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                //alert(result.msg);</span></span><br><span class="line"><span class="xml">                //1.关闭模态框</span></span><br><span class="line"><span class="xml">                $("#empUpdateModal").modal("hide");</span></span><br><span class="line"><span class="xml">                //2.回到本页面</span></span><br><span class="line"><span class="xml">                to_page(currentPage);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //单个删除</span></span><br><span class="line"><span class="xml">    $(document).on("click",".delete_btn",function () &#123;</span></span><br><span class="line"><span class="xml">        //1.弹出确认删除对话框</span></span><br><span class="line"><span class="xml">        var empName = $(this).parents("tr").find("td:eq(2)").text();</span></span><br><span class="line"><span class="xml">        var empId = $(this).attr("del-id");</span></span><br><span class="line"><span class="xml">        //alert($(this).parents("tr").find("td:eq(1)").text());</span></span><br><span class="line"><span class="xml">        if(confirm("确认删除["+empName+"]吗？"))&#123;</span></span><br><span class="line"><span class="xml">            //确认，发送ajax请求删除即可</span></span><br><span class="line"><span class="xml">            $.ajax(&#123;</span></span><br><span class="line"><span class="xml">               url:"$&#123;APP_PATH&#125;/emp/"+empId,</span></span><br><span class="line"><span class="xml">                type:"DELETE",</span></span><br><span class="line"><span class="xml">                success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                    alert(result.msg);</span></span><br><span class="line"><span class="xml">                    //回到本页</span></span><br><span class="line"><span class="xml">                    to_page(currentPage);</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //完成全选/全不选</span></span><br><span class="line"><span class="xml">    $("#check_all").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //attr获取checked是undefined</span></span><br><span class="line"><span class="xml">        //我们这些dom原生的属性,attr获取自定义属性的值</span></span><br><span class="line"><span class="xml">        //prop修改和读取dom原生属性的值</span></span><br><span class="line"><span class="xml">       $(".check_item").prop("checked",$(this).prop("checked"));</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //判断当前选择中的元素是否5个</span></span><br><span class="line"><span class="xml">    $(document).on("click",".check_item",function () &#123;</span></span><br><span class="line"><span class="xml">        var flag = $(".check_item:checked").length == $(".check_item").length;</span></span><br><span class="line"><span class="xml">        $("#check_all").prop("checked",flag);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击全部删除，就批量删除</span></span><br><span class="line"><span class="xml">    $("#emp_delete_all_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //$(".check_item:checked")</span></span><br><span class="line"><span class="xml">        var empNames = "";</span></span><br><span class="line"><span class="xml">        var del_idstr = "";</span></span><br><span class="line"><span class="xml">        $.each($(".check_item:checked"),function () &#123;</span></span><br><span class="line"><span class="xml">           //this</span></span><br><span class="line"><span class="xml">            empNames += $(this).parents("tr").find("td:eq(2)").text()+"，";</span></span><br><span class="line"><span class="xml">            //组装员工id字符串</span></span><br><span class="line"><span class="xml">            del_idstr += $(this).parents("tr").find("td:eq(1)").text()+"-"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //去除empNames多余的,</span></span><br><span class="line"><span class="xml">        empNames = empNames.substring(0,empNames.length-1);</span></span><br><span class="line"><span class="xml">        //去除删除的id多余的-</span></span><br><span class="line"><span class="xml">        del_idstr = del_idstr.substring(0,del_idstr.length-1);</span></span><br><span class="line"><span class="xml">        if(confirm("确认删除["+empNames+"]吗？"))&#123;</span></span><br><span class="line"><span class="xml">            //发送ajax请求</span></span><br><span class="line"><span class="xml">            $.ajax(&#123;</span></span><br><span class="line"><span class="xml">               url:"$&#123;APP_PATH&#125;/emp/"+del_idstr,</span></span><br><span class="line"><span class="xml">               type:"DELETE",</span></span><br><span class="line"><span class="xml">               success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                   alert(result.msg);</span></span><br><span class="line"><span class="xml">                   //回到当前页面</span></span><br><span class="line"><span class="xml">                   to_page(currentPage);</span></span><br><span class="line"><span class="xml">               &#125;</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>最后的EmployeeController<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.crud.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Msg;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.<span class="keyword">factory</span>.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.BindingResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.FieldError;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Valid;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="built_in">List</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="built_in">Map</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>处理员工CRUD请求</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> *</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> */</span></span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeService employeeService;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>单个批量二合一</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>批量删除：1-2-3</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>单个删除：1</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param ids</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/emp/&#123;ids&#125;"</span>,method = RequestMethod.DELETE)</span><br><span class="line">    public Msg deleteEmp(<span class="meta">@PathVariable</span>(<span class="string">"ids"</span>)<span class="built_in">String</span> ids)&#123;</span><br><span class="line">        <span class="comment">//批量删除</span></span><br><span class="line">        <span class="keyword">if</span>(ids.contains(<span class="string">"-"</span>))&#123;</span><br><span class="line">            <span class="built_in">List</span>&lt;Integer&gt; del_ids = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="built_in">String</span>[] str_ids = ids.split(<span class="string">"-"</span>);</span><br><span class="line">            <span class="comment">//组装id的集合</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">String</span> string : str_ids)&#123;</span><br><span class="line">                del_ids.add(Integer.parseInt(string));</span><br><span class="line">            &#125;</span><br><span class="line">            employeeService.deleteBatch(del_ids);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            Integer id = Integer.parseInt(ids);</span><br><span class="line">            employeeService.deleteEmp(id);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Msg.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>如果直接发送ajax=PUT形式的请求</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>封装的数据</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Employee</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>问题：</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>请求体中有数据</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>但是Employee对象封装不上</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>原因：</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>tomcat:</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     *   </span>1. 将请求体中的数据，封装一个map</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     *   </span>2. request.getParameter("empName")就会从这个map中取值</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     *   </span>3. SpringMVC封装POJO对象的时候，会把POJO种每个属性的值，request.getParamter("email");</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>AJAX不能直接发PUT请求</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Tomcat检测到PUT请求就不会封装请求体数据为map，只有POST请求才会封装请求体</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>org.apache.catalina.connector.Request;</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>parseParameters() （3111）</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>我们要能支持直接发送PUT之类的请求还要封装请求体中的数据</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>配置上HttpPutFormContentFilter</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>它的作用，将请求体中的数据解析包装成一个map，request被重新包装,request.getParameter()被重写，就会从自己封装的map中取数据</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>员工更新方法</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param employee</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/emp/&#123;empId&#125;"</span>,method = RequestMethod.PUT)</span><br><span class="line">    public Msg saveEmp(Employee employee)&#123;</span><br><span class="line">        employeeService.updateEmp(employee);</span><br><span class="line">        <span class="keyword">return</span> Msg.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>按照员工id查询员工</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param id</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/emp/&#123;id&#125;"</span>,method=RequestMethod.GET)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    public Msg getEmp(<span class="meta">@PathVariable</span>(<span class="string">"id"</span>) Integer id)&#123;</span><br><span class="line">        Employee employee = employeeService.getEmp(id);</span><br><span class="line">        <span class="keyword">return</span> Msg.success().add(<span class="string">"emp"</span>,employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//检查用户名是否可用</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/checkUser"</span>)</span><br><span class="line">    public Msg checkUser(<span class="meta">@RequestParam</span>(<span class="string">"empName"</span>) <span class="built_in">String</span> empName)&#123;</span><br><span class="line">        <span class="comment">//先判断用户名是否是合法的表达式;</span></span><br><span class="line">        <span class="built_in">String</span> regx = <span class="string">"(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)"</span>;</span><br><span class="line">        <span class="keyword">if</span>(!empName.matches(regx))&#123;</span><br><span class="line">            <span class="keyword">return</span> Msg.fail().add(<span class="string">"va_msg"</span>,<span class="string">"用户名必须是6到16位数字和字母的组合或2-5位中文"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//数据库用户名重复校验</span></span><br><span class="line">        boolean b = employeeService.checkUser(empName);</span><br><span class="line">        <span class="keyword">if</span>(b)&#123;</span><br><span class="line">            <span class="keyword">return</span> Msg.success();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Msg.fail().add(<span class="string">"va_msg"</span>,<span class="string">"用户名不可用"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>员工保存</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>1.支持JSR303校验</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>2. 导入Hibernate-validator</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param employee</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/emp"</span>,method = RequestMethod.POST)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    public Msg saveEmp(<span class="meta">@Valid</span>  Employee employee, BindingResult result)&#123;</span><br><span class="line">        <span class="keyword">if</span>(result.hasErrors())&#123;</span><br><span class="line">            <span class="comment">//校验失败应该返回失败，在模态框中显示校验失败的错误信息</span></span><br><span class="line">            <span class="built_in">Map</span>&lt;<span class="built_in">String</span>,<span class="built_in">Object</span>&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            <span class="built_in">List</span>&lt;FieldError&gt; errors = result.getFieldErrors();</span><br><span class="line">            <span class="keyword">for</span>(FieldError fieldError : errors)&#123;</span><br><span class="line">                System.out.println(<span class="string">"错误的字段名："</span>+fieldError.getField());</span><br><span class="line">                System.out.println(<span class="string">"错误信息："</span>+fieldError.getDefaultMessage());</span><br><span class="line">                map.put(fieldError.getField(),fieldError.getDefaultMessage());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Msg.fail().add(<span class="string">"errorFields"</span>,map);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            employeeService.saveEmp(employee);</span><br><span class="line">            <span class="keyword">return</span> Msg.success();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>导入jackson包</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param pn</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/emps"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    public Msg getEmpsWithJson(<span class="meta">@RequestParam</span>(value = <span class="string">"pn"</span>,defaultValue = <span class="string">"1"</span>)Integer pn)&#123;</span><br><span class="line">        <span class="comment">//这不是一个分页查询</span></span><br><span class="line">        <span class="comment">//引入PageHelper分页插件</span></span><br><span class="line">        <span class="comment">//在查询之前只需要调用,传入页码以及每页的个数</span></span><br><span class="line">        PageHelper.startPage(pn,<span class="number">5</span>);</span><br><span class="line">        <span class="comment">//startPage后面紧跟的这个查询就是一个分页查询</span></span><br><span class="line">        <span class="built_in">List</span>&lt;Employee&gt; emps = employeeService.getAll();</span><br><span class="line">        <span class="comment">//使用PageInfo包装查询后的结果，只需要将PageInfo交给页面就行了</span></span><br><span class="line">        <span class="comment">//封装了详细的分页信息，包括有我们查询出来的数据,连续显示的页数</span></span><br><span class="line">        PageInfo page= <span class="keyword">new</span> PageInfo(emps,<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">return</span> Msg.success().add(<span class="string">"pageInfo"</span>,page);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>查询员工数据(分页查询)</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//@RequestMapping("/emps")</span></span><br><span class="line">    public <span class="built_in">String</span> getEmps(<span class="meta">@RequestParam</span>(value = <span class="string">"pn"</span>,defaultValue = <span class="string">"1"</span>)Integer pn, Model model)&#123;</span><br><span class="line">        <span class="comment">//这不是一个分页查询</span></span><br><span class="line">        <span class="comment">//引入PageHelper分页插件</span></span><br><span class="line">        <span class="comment">//在查询之前只需要调用,传入页码以及每页的个数</span></span><br><span class="line">        PageHelper.startPage(pn,<span class="number">5</span>);</span><br><span class="line">        <span class="comment">//startPage后面紧跟的这个查询就是一个分页查询</span></span><br><span class="line">        <span class="built_in">List</span>&lt;Employee&gt; emps = employeeService.getAll();</span><br><span class="line">        <span class="comment">//使用PageInfo包装查询后的结果，只需要将PageInfo交给页面就行了</span></span><br><span class="line">        <span class="comment">//封装了详细的分页信息，包括有我们查询出来的数据,连续显示的页数</span></span><br><span class="line">        PageInfo page= <span class="keyword">new</span> PageInfo(emps,<span class="number">5</span>);</span><br><span class="line">        model.addAttribute(<span class="string">"pageInfo"</span>,page);</span><br><span class="line">        page.getNavigatepageNums();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>最后的EmployeeService<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.crud.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.EmployeeExample;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.dao.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有员工</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> employeeMapper.selectByExampleWithDept(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 员工保存方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveEmp</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">        employeeMapper.insertSelective(employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检验用户名是否可用</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> empName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true 代表当前姓名可用 false 代表不可用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkUser</span><span class="params">(String empName)</span> </span>&#123;</span><br><span class="line">        EmployeeExample example = <span class="keyword">new</span> EmployeeExample();</span><br><span class="line">        EmployeeExample.Criteria criteria = example.createCriteria();</span><br><span class="line">        criteria.andEmpNameEqualTo(empName);</span><br><span class="line">        <span class="keyword">long</span> count = employeeMapper.countByExample(example);</span><br><span class="line">        <span class="keyword">return</span> count==<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmp</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        Employee employee = employeeMapper.selectByPrimaryKey(id);</span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 员工更新</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">        employeeMapper.updateByPrimaryKeySelective(employee);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 员工删除</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteEmp</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        employeeMapper.deleteByPrimaryKey(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteBatch</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">        EmployeeExample example = <span class="keyword">new</span> EmployeeExample();</span><br><span class="line">        EmployeeExample.Criteria criteria = example.createCriteria();</span><br><span class="line">        <span class="comment">//delete from xxx where emp_id in(1,2,3)</span></span><br><span class="line">        criteria.andEmpIdIn(ids);</span><br><span class="line">        employeeMapper.deleteByExample(example);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>最后的web.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Archetype Created Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--1.启动Spring的容器  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2.spring mvc的前端控制器，拦截所有请求--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--  3.字符编码过滤器  一定要放在所有过滤器之前--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 4.使用Rest风格的URI  将页面普通的POST请求转为指定的delete或put请求 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HttpPutFormContentFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>最后的Employee<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.crud.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.validator.constraints.Length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Email;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> Integer empId;</span><br><span class="line"></span><br><span class="line">    @Pattern(regexp = <span class="string">"(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)"</span></span><br><span class="line">            ,message = <span class="string">"用户名必须是2-5位中文或6-16位英文和数字的组合"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> empName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> gender;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Email</span></span><br><span class="line">    @Pattern(regexp = <span class="string">"^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$"</span></span><br><span class="line">            ,message = <span class="string">"邮箱格式不正确"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> email;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer dId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Department department;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Department <span class="title">getDepartment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> department;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(Integer empId, <span class="keyword">String</span> empName, <span class="keyword">String</span> gender, <span class="keyword">String</span> email, Integer dId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.empId = empId;</span><br><span class="line">        <span class="keyword">this</span>.empName = empName;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">        <span class="keyword">this</span>.dId = dId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDepartment</span><span class="params">(Department department)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.department = department;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getEmpId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> empId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmpId</span><span class="params">(Integer empId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.empId = empId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getEmpName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> empName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmpName</span><span class="params">(<span class="keyword">String</span> empName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.empName = empName == null ? null : empName.trim();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(<span class="keyword">String</span> gender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender == null ? null : gender.trim();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(<span class="keyword">String</span> email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.email = email == null ? null : email.trim();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getdId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setdId</span><span class="params">(Integer dId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dId = dId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>以上就是与之前进行过修改的所有代码了</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这里画一个图来总结一下思路<br><img src="/img/JavaWeb/10-21学习日记/1.jpg" alt="avatar"></p><p>如果要部署到真实的服务器，使用maven构建war包就好了</p><p>注意点：</p><ol><li><p>新增，修改，引入数据校验（前后端）</p></li><li><p>删除，单个&amp;批量</p></li><li><p>mybatis generator-xxMapper</p></li><li><p>ajax,SpringMVC-@ResponseBody</p></li></ol><p><a href="/download/SSM.zip">源码下载</a></p><p>🌸🌸🌸完结撒花🌸🌸🌸</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;员工修改&quot;&gt;&lt;a href=&quot;#员工修改&quot; class=&quot;headerlink&quot; title=&quot;员工修改&quot;&gt;&lt;/a&gt;员工修改&lt;/h1&gt;&lt;h2 id=&quot;更新信息&quot;&gt;&lt;a href=&quot;#更新信息&quot; class=&quot;headerlink&quot; title=&quot;更新信息&quot;&gt;&lt;/a
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/10/19-员工管理系统-4</title>
    <link href="http://yoursite.com/2020/10/19/SSM-2020-10-19-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/10/19/SSM-2020-10-19-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-10-19T11:05:00.000Z</published>
    <updated>2021-02-21T04:57:54.528Z</updated>
    
    <content type="html"><![CDATA[<h1 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存</h1><h2 id="校验"><a href="#校验" class="headerlink" title="校验"></a>校验</h2><p>之前完成了前端，合法性和重复性的检验，但是由于添加了一个自定义的ajax-va，所以还是会出现一个错误，就是ajax-va的存在导致了数据无法提交，但是将其改为success时，又可以成功提交并绕过重复性的检验，这是不期望看到的</p><p>所以还需要一个后端校验以及数据库约束等</p><p>已完成的校验：</p><ul><li><p>jquery前端校验</p></li><li><p>ajax用户名重复校验</p></li><li><p>合法性校验</p></li></ul><h3 id="后端校验-JSR303"><a href="#后端校验-JSR303" class="headerlink" title="后端校验(JSR303)"></a>后端校验(JSR303)</h3><p>这是为了防止用户提交非法数据，添加唯一约束，尤其是对于重要数据，必须要添加后端校验</p><p>需要导入Hibernate-Validator包，依旧是添加maven依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    JSR303校验  数据校验支持--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate.validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.6.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>在Employee.java中给empName和email添加上JSR303检验标准<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Pattern</span>(<span class="keyword">regexp</span> = <span class="string">"(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)"</span></span><br><span class="line">        ,message = <span class="string">"用户名必须是2-5位中文或6-16位英文和数字的组合"</span>)</span><br><span class="line">private String empName;</span><br></pre></td></tr></table></figure></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    @Email</span></span><br><span class="line">    <span class="meta">@Pattern(regexp = <span class="meta-string">"^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$"</span></span></span><br><span class="line"><span class="meta">            ,message = <span class="meta-string">"邮箱格式不正确"</span>)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br></pre></td></tr></table></figure><p>Email可以直接写@Email或自定义</p><p>要想校验实现，只需要在Controller的对应方法中的封装对象添加上@Valid 就可以代表封装对象之后，封装的数据要进行校验，还可以定义一个BindingResult对象来封装校验的结果<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工保存</span></span><br><span class="line"><span class="comment"> * 1.支持JSR303校验</span></span><br><span class="line"><span class="comment"> * 2. 导入Hibernate-validator</span></span><br><span class="line"><span class="comment"> * @param employee</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@<span class="constructor">RequestMapping(<span class="params">value</span> = <span class="string">"/emp"</span>,<span class="params">method</span> = RequestMethod.POST)</span></span><br><span class="line">@ResponseBody</span><br><span class="line">public Msg save<span class="constructor">Emp(@Valid  Employee <span class="params">employee</span>, BindingResult <span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(result.has<span class="constructor">Errors()</span>)&#123;</span><br><span class="line">        <span class="comment">//校验失败应该返回失败，在模态框中显示校验失败的错误信息</span></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;<span class="literal">()</span>;</span><br><span class="line">        List&lt;FieldError&gt; errors = result.get<span class="constructor">FieldErrors()</span>;</span><br><span class="line">        for(FieldError fieldError : errors)&#123;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"错误的字段名："</span>+fieldError.get<span class="constructor">Field()</span>);</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"错误信息："</span>+fieldError.get<span class="constructor">DefaultMessage()</span>);</span><br><span class="line">            map.put(fieldError.get<span class="constructor">Field()</span>,fieldError.get<span class="constructor">DefaultMessage()</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        return <span class="module-access"><span class="module"><span class="identifier">Msg</span>.</span></span>fail<span class="literal">()</span>.add(<span class="string">"errorFields"</span>,map);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        employeeService.save<span class="constructor">Emp(<span class="params">employee</span>)</span>;</span><br><span class="line">        return <span class="module-access"><span class="module"><span class="identifier">Msg</span>.</span></span>success<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>还需要修改一下index.jsp，让他点击完保存之后，有进一步的校验和提示信息<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击保存，保存员工</span></span><br><span class="line"><span class="constructor">$(<span class="string">"#emp_save_btn"</span>)</span>.click(<span class="keyword">function</span> <span class="literal">()</span> &#123;</span><br><span class="line">    <span class="comment">//1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line">    <span class="comment">//2.先对要提交给服务器的数据进行校验</span></span><br><span class="line">    <span class="keyword">if</span>(!validata<span class="constructor">_add_form()</span>)&#123;</span><br><span class="line">        return <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//3.判断之前的ajax用户名校验是否成功</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="constructor">$(<span class="params">this</span>)</span>.attr(<span class="string">"ajax-va"</span>)==<span class="string">"error"</span>)&#123;</span><br><span class="line">        return <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//4.发送ajax请求保存员工</span></span><br><span class="line">    <span class="comment">// alert($("#empAddModal form").serialize());</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/emp"</span>,</span><br><span class="line">        <span class="keyword">type</span>:<span class="string">"POST"</span>,</span><br><span class="line">        data:<span class="constructor">$(<span class="string">"#empAddModal form"</span>)</span>.serialize<span class="literal">()</span>,</span><br><span class="line">        success:<span class="keyword">function</span> (result) &#123;</span><br><span class="line">            <span class="comment">//alert(result.msg);</span></span><br><span class="line">            <span class="keyword">if</span>(result.code<span class="operator"> == </span><span class="number">200</span>)&#123;</span><br><span class="line">                <span class="comment">//员工保存成功：</span></span><br><span class="line">                <span class="comment">//1. 关闭模态框</span></span><br><span class="line">                <span class="constructor">$(<span class="string">"#empAddModal"</span>)</span>.modal('hide');</span><br><span class="line">                <span class="comment">//2. 来到最后一页，显示刚才保存的数据</span></span><br><span class="line">                <span class="comment">//发送ajax请求显示最后一页数据即可</span></span><br><span class="line">                <span class="comment">//可以将总记录数当作页码</span></span><br><span class="line">                <span class="keyword">to</span><span class="constructor">_page(<span class="params">totalRecords</span>)</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//显示失败信息</span></span><br><span class="line">                <span class="comment">// console.log(result);</span></span><br><span class="line">                <span class="comment">//有哪个字段的错误信息，就显示哪个字段</span></span><br><span class="line">                <span class="keyword">if</span>(undefined != result.extend.errorFields.email)&#123;</span><br><span class="line">                    <span class="comment">//显示邮箱错误信息</span></span><br><span class="line">                    show<span class="constructor">_validate_msg(<span class="string">"#email_add_input"</span>,<span class="string">"error"</span>,<span class="params">result</span>.<span class="params">extend</span>.<span class="params">errorFields</span>.<span class="params">email</span>)</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(undefined != result.extend.errorFields.empName)&#123;</span><br><span class="line">                    <span class="comment">//显示员工错误信息</span></span><br><span class="line">                    show<span class="constructor">_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,<span class="params">result</span>.<span class="params">extend</span>.<span class="params">result</span>.<span class="params">extend</span>.<span class="params">errorFields</span>.<span class="params">empName</span>)</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>显示即使注释掉了前端的校验代码，依然会提示错误信息，并且后端的控制台中也会看到对应的信息<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">错误的字段名：<span class="section">email</span></span><br><span class="line">错误信息：邮箱格式不正确</span><br></pre></td></tr></table></figure><br>这里就完成了最终的校验</p><p>当然数据在创建的时候可以给用户名和邮箱等信息添加不可重复的依赖，那就又添加了一次保障</p><p>当前的index.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 员工添加的模态框 --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@qq.com"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_add_input"</span> <span class="attr">value</span>=<span class="string">"M"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_add_input"</span> <span class="attr">value</span>=<span class="string">"F"</span>&gt;</span> 女</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                            部门提交部门id即可-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"dId"</span> <span class="attr">id</span>=<span class="string">"dept_add_select"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                                部门名称-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_save_btn"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_add_modal_btn"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    var totalRecords;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">    $(function ()&#123;</span></span><br><span class="line"><span class="xml">        //去首页</span></span><br><span class="line"><span class="xml">        to_page(1);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function to_page(pn) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">            data:"pn="+pn,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                build_page_info(result);</span></span><br><span class="line"><span class="xml">                //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                build_page_nav(result);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空table</span></span><br><span class="line"><span class="xml">        $("#emps_table tbody").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">        $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">            var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">            var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">            var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">            var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             编辑</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             删除</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">            $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                .append(empNameTd)</span></span><br><span class="line"><span class="xml">                .append(genderTd)</span></span><br><span class="line"><span class="xml">                .append(emailTd)</span></span><br><span class="line"><span class="xml">                .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                .append(btnTd)</span></span><br><span class="line"><span class="xml">                .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页信息</span></span><br><span class="line"><span class="xml">    function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">        //清空分页信息</span></span><br><span class="line"><span class="xml">        $("#page_info_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">        totalRecords = result.extend.pageInfo.total;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">    function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空</span></span><br><span class="line"><span class="xml">        $("#page_nav_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //page_nav_area</span></span><br><span class="line"><span class="xml">        var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span></span><br><span class="line"><span class="xml">            firstPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            prePageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            firstPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            prePageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum-1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">        var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasNextPage == false)&#123;</span></span><br><span class="line"><span class="xml">            nextPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            lastPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            nextPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum+1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            lastPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pages);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">        ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">        //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">        $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">            if(result.extend.pageInfo.pageNum == item)&#123;</span></span><br><span class="line"><span class="xml">                numLi.addClass("active");</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            numLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(item);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            ul.append(numLi);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">        ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">        var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">        navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //清空表单样式及内容</span></span><br><span class="line"><span class="xml">    function reset_form(ele)&#123;</span></span><br><span class="line"><span class="xml">        $(ele)[0].reset();</span></span><br><span class="line"><span class="xml">        //清空样式</span></span><br><span class="line"><span class="xml">        $(ele).find("*").removeClass("has-success has-error");</span></span><br><span class="line"><span class="xml">        $(ele).find(".help-block").text("");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击新增按钮弹出模态框</span></span><br><span class="line"><span class="xml">    $("#emp_add_modal_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //清除数据，表单重置</span></span><br><span class="line"><span class="xml">        reset_form($("#empAddModal form"));</span></span><br><span class="line"><span class="xml">        //发送ajax请求，查出部门信息，显示在下拉列表</span></span><br><span class="line"><span class="xml">        getDepts();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //弹出模态框</span></span><br><span class="line"><span class="xml">        $("#empAddModal").modal(&#123;</span></span><br><span class="line"><span class="xml">            backdrop:"static"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //查出所有的部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="xml">    function getDepts() &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">           url:"$&#123;APP_PATH&#125;/depts",</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                // console.log(result)</span></span><br><span class="line"><span class="xml">                //显示部门信息在下拉列表中</span></span><br><span class="line"><span class="xml">                // $("#dept_add_select").append("")</span></span><br><span class="line"><span class="xml">                $.each(result.extend.depts,function () &#123;</span></span><br><span class="line"><span class="xml">                    var optionEle = $("<span class="tag">&lt;<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span>").append(this.deptName).attr("value",this.deptId);</span></span><br><span class="line"><span class="xml">                    optionEle.appendTo("#dept_add_select")</span></span><br><span class="line"><span class="xml">                &#125;);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml">    //校验表单数据</span></span><br><span class="line"><span class="xml">    function validata_add_form()&#123;</span></span><br><span class="line"><span class="xml">        //1. 拿到要检验的数据，使用正则表达式</span></span><br><span class="line"><span class="xml">        var empName = $("#empName_add_input").val();</span></span><br><span class="line"><span class="xml">        var regName = /(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\u2E80-\u9FFF]&#123;2,5&#125;)/;</span></span><br><span class="line"><span class="xml">        if(!regName.test(empName))&#123;</span></span><br><span class="line"><span class="xml">            // alert("用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line"><span class="xml">            //清空这个元素之前的样式</span></span><br><span class="line"><span class="xml">            show_validate_msg("#empName_add_input","error","用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#empName_add_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //2. 校验邮箱信息</span></span><br><span class="line"><span class="xml">        var email = $("#email_add_input").val();</span></span><br><span class="line"><span class="xml">        var regEmaill = /^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/ ;</span></span><br><span class="line"><span class="xml">        if(!regEmaill.test(email))&#123;</span></span><br><span class="line"><span class="xml">            // alert("邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_add_input","error","邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_add_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        return true;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //显示校验信息</span></span><br><span class="line"><span class="xml">    function show_validate_msg(ele,status,msg)&#123;</span></span><br><span class="line"><span class="xml">        //清空这个元素之前的样式</span></span><br><span class="line"><span class="xml">        $(ele).parent().removeClass("has-success has-error");</span></span><br><span class="line"><span class="xml">        $(ele).next("span").text("");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        if(status == "success")&#123;</span></span><br><span class="line"><span class="xml">            $(ele).parent().addClass("has-success");</span></span><br><span class="line"><span class="xml">            $(ele).next("span").text(msg);</span></span><br><span class="line"><span class="xml">        &#125;else if(status == "error")&#123;</span></span><br><span class="line"><span class="xml">            $(ele).parent().addClass("has-error");</span></span><br><span class="line"><span class="xml">            $(ele).next("span").text(msg);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //校验用户名是否可用</span></span><br><span class="line"><span class="xml">    $("#empName_add_input").change(function () &#123;</span></span><br><span class="line"><span class="xml">        //发送ajax请求校验用户名是否可用</span></span><br><span class="line"><span class="xml">        var empName = this.value;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/checkUser",</span></span><br><span class="line"><span class="xml">            data:"empName="+empName,</span></span><br><span class="line"><span class="xml">            type:"POST",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                if(result.code == 200)&#123;</span></span><br><span class="line"><span class="xml">                    show_validate_msg("#empName_add_input","success","用户名可用");</span></span><br><span class="line"><span class="xml">                    $("#emp_save_btn").attr("ajax-va","success");</span></span><br><span class="line"><span class="xml">                &#125;else&#123;</span></span><br><span class="line"><span class="xml">                    show_validate_msg("#empName_add_input","error",result.extend.va_msg);</span></span><br><span class="line"><span class="xml">                    $("#emp_save_btn").attr("ajax-va","error");</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击保存，保存员工</span></span><br><span class="line"><span class="xml">    $("#emp_save_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line"><span class="xml">        //2.先对要提交给服务器的数据进行校验</span></span><br><span class="line"><span class="xml">        if(!validata_add_form())&#123;</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        //3.判断之前的ajax用户名校验是否成功</span></span><br><span class="line"><span class="xml">        if($(this).attr("ajax-va")=="error")&#123;</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        //4.发送ajax请求保存员工</span></span><br><span class="line"><span class="xml">        // alert($("#empAddModal form").serialize());</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emp",</span></span><br><span class="line"><span class="xml">            type:"POST",</span></span><br><span class="line"><span class="xml">            data:$("#empAddModal form").serialize(),</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                //alert(result.msg);</span></span><br><span class="line"><span class="xml">                if(result.code == 200)&#123;</span></span><br><span class="line"><span class="xml">                    //员工保存成功：</span></span><br><span class="line"><span class="xml">                    //1. 关闭模态框</span></span><br><span class="line"><span class="xml">                    $("#empAddModal").modal('hide');</span></span><br><span class="line"><span class="xml">                    //2. 来到最后一页，显示刚才保存的数据</span></span><br><span class="line"><span class="xml">                    //发送ajax请求显示最后一页数据即可</span></span><br><span class="line"><span class="xml">                    //可以将总记录数当作页码</span></span><br><span class="line"><span class="xml">                    to_page(totalRecords);</span></span><br><span class="line"><span class="xml">                &#125;else&#123;</span></span><br><span class="line"><span class="xml">                    //显示失败信息</span></span><br><span class="line"><span class="xml">                    // console.log(result);</span></span><br><span class="line"><span class="xml">                    //有哪个字段的错误信息，就显示哪个字段</span></span><br><span class="line"><span class="xml">                    if(undefined != result.extend.errorFields.email)&#123;</span></span><br><span class="line"><span class="xml">                        //显示邮箱错误信息</span></span><br><span class="line"><span class="xml">                        show_validate_msg("#email_add_input","error",result.extend.errorFields.email);</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    if(undefined != result.extend.errorFields.empName)&#123;</span></span><br><span class="line"><span class="xml">                        //显示员工错误信息</span></span><br><span class="line"><span class="xml">                        show_validate_msg("#empName_add_input","error",result.extend.result.extend.errorFields.empName);</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><h1 id="员工修改"><a href="#员工修改" class="headerlink" title="员工修改"></a>员工修改</h1><p>效果图：<br><img src="/img/JavaWeb/10-19学习日记/0.png" alt="avatar"></p><p>当点击编辑按钮时就会弹出这样一个模态框</p><ol><li><p>点击编辑</p></li><li><p>弹出用户修改的模态框（显示用户信息）</p></li><li><p>点击更新，完成用户修改</p></li></ol><p>由于很相似，所以就复制进行一点修改就好了</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--员工修改的模态框--%&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal fade"</span> id=<span class="string">"empUpdateModal"</span> tabindex=<span class="string">"-1"</span> role=<span class="string">"dialog"</span> aria-labelledby=<span class="string">"myModalLabel"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-dialog"</span> role=<span class="string">"document"</span>&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-content"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-header"</span>&gt;</span><br><span class="line">                &lt;button <span class="class"><span class="keyword">type</span></span>=<span class="string">"button"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"close"</span> data-dismiss=<span class="string">"modal"</span> aria-label=<span class="string">"Close"</span>&gt;&lt;span aria-hidden=<span class="string">"true"</span>&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">                &lt;h4 <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-title"</span>&gt;员工修改&lt;/h4&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-body"</span>&gt;</span><br><span class="line">                &lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-horizontal"</span>&gt;</span><br><span class="line">                    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">                        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-2 control-label"</span>&gt;empName&lt;/label&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">                            &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"text"</span> name=<span class="string">"empName"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"empName_update_input"</span> placeholder=<span class="string">"empName"</span>&gt;</span><br><span class="line">                            &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"help-block"</span>&gt;&lt;/span&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">                        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-2 control-label"</span>&gt;email&lt;/label&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">                            &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"text"</span> name=<span class="string">"email"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"email_update_input"</span> placeholder=<span class="string">"email@qq.com"</span>&gt;</span><br><span class="line">                            &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"help-block"</span>&gt;&lt;/span&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">                        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-2 control-label"</span>&gt;gender&lt;/label&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">                            &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"radio-inline"</span>&gt;</span><br><span class="line">                                &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"radio"</span> name=<span class="string">"gender"</span> id=<span class="string">"gender1_update_input"</span> value=<span class="string">"M"</span> checked=<span class="string">"checked"</span>&gt; 男</span><br><span class="line">                            &lt;/label&gt;</span><br><span class="line">                            &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"radio-inline"</span>&gt;</span><br><span class="line">                                &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"radio"</span> name=<span class="string">"gender"</span> id=<span class="string">"gender2_update_input"</span> value=<span class="string">"F"</span>&gt; 女</span><br><span class="line">                            &lt;/label&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">                        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-2 control-label"</span>&gt;deptName&lt;/label&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-4"</span>&gt;</span><br><span class="line">                            &lt;%--                            部门提交部门id即可--%&gt;</span><br><span class="line">                            &lt;select <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> name=<span class="string">"dId"</span>&gt;</span><br><span class="line">                                &lt;%--  部门名称--%&gt;</span><br><span class="line">                            &lt;/select&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;/form&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-footer"</span>&gt;</span><br><span class="line">                &lt;button <span class="class"><span class="keyword">type</span></span>=<span class="string">"button"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-default"</span> data-dismiss=<span class="string">"modal"</span>&gt;关闭&lt;/button&gt;</span><br><span class="line">                &lt;button <span class="class"><span class="keyword">type</span></span>=<span class="string">"button"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-primary"</span> id=<span class="string">"emp_update_btn"</span>&gt;更新&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>然后给按钮加上标识<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var editBtn = <span class="constructor">$(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>)</span>.add<span class="constructor">Class(<span class="string">"btn btn-primary btn-sm edit_btn"</span>)</span></span><br><span class="line">    .append(<span class="constructor">$(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>)</span>.add<span class="constructor">Class(<span class="string">"glyphicon glyphicon-pencil"</span>)</span>).append(<span class="string">"编辑"</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;button class="btn btn-danger btn-sm"&gt;</span></span><br><span class="line"><span class="comment"> &lt;span class="glyphicon glyphicon-trash" aria-hidden="true" /&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="comment"> 删除</span></span><br><span class="line"><span class="comment"> &lt;/button&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">var delBtn = <span class="constructor">$(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>)</span>.add<span class="constructor">Class(<span class="string">"btn btn-danger btn-sm delete_btn"</span>)</span></span><br><span class="line">    .append(<span class="constructor">$(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>)</span>.add<span class="constructor">Class(<span class="string">"glyphicon glyphicon-trash"</span>)</span>).append(<span class="string">"删除"</span>);</span><br></pre></td></tr></table></figure><br>别忘了还有绑定点击事件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.按钮创建之前就绑定了click，所以绑定不上</span></span><br><span class="line"><span class="comment">//1).可以在创建按钮的时候绑定事件 2).live()</span></span><br><span class="line"><span class="comment">//jquery新版没有live，使用on方法进行替代</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".edit_btn"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//alert("edit")</span></span><br><span class="line">    <span class="comment">//0.查出员工信息，显示员工信息</span></span><br><span class="line">    <span class="comment">//1.查出部门信息，并显示部门列表</span></span><br><span class="line"></span><br><span class="line">    getDepts(<span class="string">"#empUpdateModal select"</span>)</span><br><span class="line">    $(<span class="string">"#empUpdateModal"</span>).modal(&#123;</span><br><span class="line">        backdrop:<span class="string">"static"</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>现在的模态框和添加的模态框是一样的，所以我们还需要做一些修改</p><h2 id="显示信息"><a href="#显示信息" class="headerlink" title="显示信息"></a>显示信息</h2><p>效果图中，用户名是不能变得，所以从<a href="https://v3.bootcss.com/css/" target="_blank" rel="noopener">bootstrap全局样式</a>中找到表单的静态控件<br>实际上就加了一个p标签<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control-static"</span>&gt;email<span class="meta">@example</span>.com&lt;/p&gt;</span><br></pre></td></tr></table></figure></p><p>想要更新时保持不变并与其对应，那还是发送ajax请求，传到这个静态控件中<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control-static"</span> id=<span class="string">"empName_update_static"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>在EmployeeController中添加<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 按照员工id查询员工</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping(value=<span class="meta-string">"/emp/&#123;id&#125;"</span>,method=RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Msg getEmp(<span class="meta">@PathVariable(<span class="meta-string">"id"</span>)</span> Integer id)&#123;</span><br><span class="line">    Employee employee = employeeService.getEmp(id);</span><br><span class="line">    <span class="keyword">return</span> Msg.success().add(<span class="string">"emp"</span>,employee);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>对应的Service中也添加上<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">public</span> Employee getEmp(Integer id) &#123;</span><br><span class="line">    <span class="attribute">Employee</span> employee = employeeMapper.<span class="literal">select</span>ByPrimaryKey(id);</span><br><span class="line">    <span class="attribute">return</span> employee;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>给编辑按钮添加一个自定义属性<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var editBtn = <span class="constructor">$(<span class="string">"&lt;button&gt;&lt;/button&gt;"</span>)</span>.add<span class="constructor">Class(<span class="string">"btn btn-primary btn-sm edit_btn"</span>)</span></span><br><span class="line">    .append(<span class="constructor">$(<span class="string">"&lt;span&gt;&lt;/span&gt;"</span>)</span>.add<span class="constructor">Class(<span class="string">"glyphicon glyphicon-pencil"</span>)</span>).append(<span class="string">"编辑"</span>);</span><br><span class="line"><span class="comment">//为编辑按钮添加一个自定义的属性，来表示当前员工id</span></span><br><span class="line">editBtn.attr(<span class="string">"edit-id"</span>,item.empId);</span><br></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.按钮创建之前就绑定了click，所以绑定不上</span></span><br><span class="line"><span class="comment">//1).可以在创建按钮的时候绑定事件 2).live()</span></span><br><span class="line"><span class="comment">//jquery新版没有live，使用on方法进行替代</span></span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">"click"</span>,<span class="string">".edit_btn"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//alert("edit")</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.查出部门信息，并显示部门列表</span></span><br><span class="line">    getDepts(<span class="string">"#empUpdateModal select"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.查出员工信息，显示员工信息</span></span><br><span class="line">    getEmp($(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>));</span><br><span class="line">    $(<span class="string">"#empUpdateModal"</span>).modal(&#123;</span><br><span class="line">        backdrop:<span class="string">"static"</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEmp</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+id,</span><br><span class="line">        type:<span class="string">"GET"</span>,</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// console.log(result);</span></span><br><span class="line">            <span class="keyword">var</span> empData = result.extend.emp;</span><br><span class="line">            $(<span class="string">"#empName_update_static"</span>).text(empData.empName);</span><br><span class="line">            $(<span class="string">"#email_update_input"</span>).val(empData.email);</span><br><span class="line">            $(<span class="string">"#empUpdateModal input[name=gender]"</span>).val([empData.gender]);</span><br><span class="line">            $(<span class="string">"#empUpdateModal select"</span>).val([empData.dId]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里基本的显示就完成了</p><h2 id="更新信息"><a href="#更新信息" class="headerlink" title="更新信息"></a>更新信息</h2><p>在EmployeeController中添加上<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工更新方法</span></span><br><span class="line"><span class="comment"> * @param employee</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">@ResponseBody</span></span><br><span class="line"><span class="variable">@RequestMapping</span>(value = <span class="string">"/emp/&#123;empId&#125;"</span>,method = RequestMethod.PUT)</span><br><span class="line">public Msg saveEmp(Employee employee)&#123;</span><br><span class="line">    <span class="selector-tag">employeeService</span><span class="selector-class">.updateEmp</span>(employee);</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">Msg</span><span class="selector-class">.success</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Service中也对应添加<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工更新</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Employee employee)</span></span>&#123;</span><br><span class="line">    employeeMapper.updateByPrimaryKeySelective(employee);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>在index.jsp中添加上点击事件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击更新，更新员工信息</span></span><br><span class="line">$(<span class="string">"#emp_update_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.验证邮箱是否合法</span></span><br><span class="line">    <span class="keyword">var</span> email = $(<span class="string">"#email_update_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regEmaill = <span class="regexp">/^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/</span> ;</span><br><span class="line">    <span class="keyword">if</span>(!regEmaill.test(email))&#123;</span><br><span class="line">        <span class="comment">// alert("邮箱格式不正确");</span></span><br><span class="line">        show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"error"</span>,<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        show_validate_msg(<span class="string">"#email_update_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.发送ajax请求，保存更新的员工数据</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/emp/"</span>+$(<span class="keyword">this</span>).attr(<span class="string">"edit-id"</span>),</span><br><span class="line">        type:<span class="string">"POST"</span>,</span><br><span class="line">        data:$(<span class="string">"#empUpdateModal form"</span>).serialize()+<span class="string">"&amp;_method=PUT"</span>,</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            alert(result.msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>这样就完成了更新的基本操作</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;保存&quot;&gt;&lt;a href=&quot;#保存&quot; class=&quot;headerlink&quot; title=&quot;保存&quot;&gt;&lt;/a&gt;保存&lt;/h1&gt;&lt;h2 id=&quot;校验&quot;&gt;&lt;a href=&quot;#校验&quot; class=&quot;headerlink&quot; title=&quot;校验&quot;&gt;&lt;/a&gt;校验&lt;/h2&gt;&lt;p&gt;之前完
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/10/16-员工管理系统-3</title>
    <link href="http://yoursite.com/2020/10/16/SSM-2020-10-16-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/10/16/SSM-2020-10-16-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-10-16T11:16:41.000Z</published>
    <updated>2021-02-21T04:57:56.388Z</updated>
    
    <content type="html"><![CDATA[<h1 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存</h1><p>URI：</p><ul><li><p>/emp/{id}   GET 查询员工</p></li><li><p>/emp    POST保存员工</p></li><li><p>/emp/{id}   PUT修改员工</p></li><li><p>/emp/{id}   DELETE删除员工</p></li></ul><p>首先添加一个点击事件，点击保存的时候，完成保存事件<br><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#emp_save_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>给保存按钮添加上<code>id=emp_save_btn</code></p><p>接着在EmployeeController中添加方法<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@RequestMapping</span>(value = <span class="string">"/emp"</span>,method = RequestMethod.POST)</span><br><span class="line"><span class="variable">@ResponseBody</span></span><br><span class="line">public Msg saveEmp(Employee employee)&#123;</span><br><span class="line">    <span class="selector-tag">employeeService</span><span class="selector-class">.saveEmp</span>(employee);</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">Msg</span><span class="selector-class">.success</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>EmployeeService中对应的写方法</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工保存方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public void save<span class="constructor">Emp(Employee <span class="params">employee</span>)</span>&#123;</span><br><span class="line">    employeeMapper.insert<span class="constructor">Selective(<span class="params">employee</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着完善点击事件</p><p>由于需要ajax请求保存员工，但是一个一个取出员工数据太过于麻烦，所以就需要请出一生噩梦，序列化与反序列化</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//alert($("#empAddModal form").serialize());</span></span><br><span class="line"></span><br><span class="line">$.ajax(&#123;</span><br><span class="line"><span class="symbol">    url:</span><span class="string">"$&#123;APP_PATH&#125;/emp"</span>,</span><br><span class="line"><span class="symbol">    type:</span><span class="string">"POST"</span>,</span><br><span class="line"><span class="symbol">    data:</span>$(<span class="string">"#empAddModal form"</span>).serialize()</span><br></pre></td></tr></table></figure><p>我们还想要再点击保存之后关闭模态框并且转到最后一页来显示刚才的数据</p><p>访问一下<a href="https://v3.bootcss.com/javascript/#modals-methods" target="_blank" rel="noopener">bootstarp模态框</a><br>找到关闭模态框的方法<br><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#empAddModal"</span>).modal(<span class="string">'hide'</span>);</span><br></pre></td></tr></table></figure></p><p>来到最后一页要面临一个问题就是当该页已经有5个数据，再添加一个数据，页码就会加一，这个时候不用担心，插件会自动帮我们完成，我们只需要发送ajax请求最后一页数据即可，但是又担心调用to_page方法不够保险，就可以请求总记录数当页码</p><p>定义一个全局遍历totalRecords<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">totalRecords</span> = result.extend.pageInfo.total<span class="comment">;</span></span><br></pre></td></tr></table></figure><br>然后用to_page请求就好了<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">to</span><span class="constructor">_page(<span class="params">totalRecords</span>)</span>;</span><br></pre></td></tr></table></figure></p><p>完整的保存<br><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#emp_save_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line">    <span class="comment">//2.发送ajax请求保存员工</span></span><br><span class="line">    <span class="comment">// alert($("#empAddModal form").serialize());</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/emp"</span>,</span><br><span class="line">        type:<span class="string">"POST"</span>,</span><br><span class="line">        data:$(<span class="string">"#empAddModal form"</span>).serialize(),</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//alert(result.msg);</span></span><br><span class="line">            <span class="comment">//员工保存成功：</span></span><br><span class="line">            <span class="comment">//1. 关闭模态框</span></span><br><span class="line">            $(<span class="string">"#empAddModal"</span>).modal(<span class="string">'hide'</span>);</span><br><span class="line">            <span class="comment">//2. 来到最后一页，显示刚才保存的数据</span></span><br><span class="line">            <span class="comment">//发送ajax请求显示最后一页数据即可</span></span><br><span class="line">            <span class="comment">//可以将总记录数当作页码</span></span><br><span class="line">            to_page(totalRecords);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>这下点击保存之后，就会自动跳转到最后一页并关闭模态框了</p><p>但是目前只是基本完成了保存功能，但是没有校验输入的信息，这就需要编写一下娇艳的逻辑了</p><h2 id="校验"><a href="#校验" class="headerlink" title="校验"></a>校验</h2><h3 id="合法性校验"><a href="#合法性校验" class="headerlink" title="合法性校验"></a>合法性校验</h3><p>输入数据以后不能直接完成保存，必须要进行校验</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//校验表单数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validata_add_form</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1. 拿到要检验的数据，使用正则表达式</span></span><br><span class="line">    <span class="keyword">var</span> empName = $(<span class="string">"#empName_add_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regName = <span class="regexp">/(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\u2E80-\u9FFF]&#123;2,5&#125;)/</span>;</span><br><span class="line">    <span class="keyword">if</span>(!regName.test(empName))&#123;</span><br><span class="line">        alert(<span class="string">"用户名可以是2-5位中文或6-16位英文和数字的组合"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//2. 校验邮箱信息</span></span><br><span class="line">    <span class="keyword">var</span> email = $(<span class="string">"#email_add_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regEmaill = <span class="regexp">/^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/</span> ;</span><br><span class="line">    <span class="keyword">if</span>(!regEmaill.test(email))&#123;</span><br><span class="line">        alert(<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//点击保存，保存员工</span></span><br><span class="line">$(<span class="string">"#emp_save_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line">    <span class="comment">//2.先对要提交给服务器的数据进行校验</span></span><br><span class="line">    <span class="keyword">if</span>(!validata_add_form())&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p>这样我们的逻辑就完成了，用户名和邮箱都需要正确才允许提交ajax请求</p><p>但是alert太难看了，可以在<a href="https://v3.bootcss.com/css/#forms-control-validation" target="_blank" rel="noopener">bootstrap表单</a>校验状态找到相应的操作</p><p>我们抽取一个方法show_validate_msg</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> show<span class="constructor">_validate_msg(<span class="params">ele</span>,<span class="params">status</span>,<span class="params">msg</span>)</span>&#123;</span><br><span class="line">       <span class="comment">//清空这个元素之前的样式</span></span><br><span class="line">       <span class="constructor">$(<span class="params">ele</span>)</span>.parent<span class="literal">()</span>.remove<span class="constructor">Class(<span class="string">"has-success has-error"</span>)</span>;</span><br><span class="line">       <span class="constructor">$(<span class="params">ele</span>)</span>.next(<span class="string">"span"</span>).text(<span class="string">""</span>);</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">if</span>(status<span class="operator"> == </span><span class="string">"success"</span>)&#123;</span><br><span class="line">           <span class="constructor">$(<span class="params">ele</span>)</span>.parent<span class="literal">()</span>.add<span class="constructor">Class(<span class="string">"has-success"</span>)</span>;</span><br><span class="line">           <span class="constructor">$(<span class="params">ele</span>)</span>.next(<span class="string">"span"</span>).text(msg);</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(status<span class="operator"> == </span><span class="string">"error"</span>)&#123;</span><br><span class="line">           <span class="constructor">$(<span class="params">ele</span>)</span>.parent<span class="literal">()</span>.add<span class="constructor">Class(<span class="string">"has-error"</span>)</span>;</span><br><span class="line">           <span class="constructor">$(<span class="params">ele</span>)</span>.next(<span class="string">"span"</span>).text(msg);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>validata_add_form也要修改</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//校验表单数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validata_add_form</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1. 拿到要检验的数据，使用正则表达式</span></span><br><span class="line">    <span class="keyword">var</span> empName = $(<span class="string">"#empName_add_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regName = <span class="regexp">/(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\u2E80-\u9FFF]&#123;2,5&#125;)/</span>;</span><br><span class="line">    <span class="keyword">if</span>(!regName.test(empName))&#123;</span><br><span class="line">        <span class="comment">// alert("用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line">        <span class="comment">//清空这个元素之前的样式</span></span><br><span class="line">        show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,<span class="string">"用户名可以是2-5位中文或6-16位英文和数字的组合"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 校验邮箱信息</span></span><br><span class="line">    <span class="keyword">var</span> email = $(<span class="string">"#email_add_input"</span>).val();</span><br><span class="line">    <span class="keyword">var</span> regEmaill = <span class="regexp">/^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/</span> ;</span><br><span class="line">    <span class="keyword">if</span>(!regEmaill.test(email))&#123;</span><br><span class="line">        <span class="comment">// alert("邮箱格式不正确");</span></span><br><span class="line">        show_validate_msg(<span class="string">"#email_add_input"</span>,<span class="string">"error"</span>,<span class="string">"邮箱格式不正确"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        show_validate_msg(<span class="string">"#email_add_input"</span>,<span class="string">"success"</span>,<span class="string">""</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就完成了一个好看的检验信息，但是现在只是校验了合法性，但是并没有查重，所以接下来就需要进行一个查重的校验</p><h3 id="重复校验"><a href="#重复校验" class="headerlink" title="重复校验"></a>重复校验</h3><p>基本逻辑就是当查到重复的时候要提示出错误信息，并且不能保存，利用change事件来编写</p><p>首先需要编写一个checkUser方法</p><p>在EmployeeController中添加<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检查用户名是否可用</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(<span class="meta-string">"/checkUser"</span>)</span></span><br><span class="line"><span class="keyword">public</span> Msg checkUser(<span class="meta">@RequestParam(<span class="meta-string">"empName"</span>)</span> String empName)&#123;</span><br><span class="line">    boolean b = employeeService.checkUser(empName);</span><br><span class="line">    <span class="keyword">if</span>(b)&#123;</span><br><span class="line">        <span class="keyword">return</span> Msg.success();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Msg.fail();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>对应的Service中添加<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public boolean check<span class="constructor">User(String <span class="params">empName</span>)</span> &#123;</span><br><span class="line">    EmployeeExample example = <span class="keyword">new</span> <span class="constructor">EmployeeExample()</span>;</span><br><span class="line">    EmployeeExample.Criteria criteria = example.create<span class="constructor">Criteria()</span>;</span><br><span class="line">    criteria.<span class="keyword">and</span><span class="constructor">EmpNameEqualTo(<span class="params">empName</span>)</span>;</span><br><span class="line">    long count = employeeMapper.count<span class="constructor">ByExample(<span class="params">example</span>)</span>;</span><br><span class="line">    return count==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>接着在index.jsp中添加上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//校验用户名是否可用</span></span><br><span class="line">$(<span class="string">"#empName_add_input"</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//发送ajax请求校验用户名是否可用</span></span><br><span class="line">    <span class="keyword">var</span> empName = <span class="keyword">this</span>.value;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/checkUser"</span>,</span><br><span class="line">        data:<span class="string">"empName="</span>+empName,</span><br><span class="line">        type:<span class="string">"POST"</span>,</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(result.code == <span class="number">200</span>)&#123;</span><br><span class="line">                show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"success"</span>,<span class="string">"用户名可用"</span>);</span><br><span class="line">                $(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"success"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,<span class="string">"用户名不可用"</span>);</span><br><span class="line">                $(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"error"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>这里利用一个自定义的属性ajax-va来判断是否可用<br>保存事件也要添加上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#emp_save_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line">    <span class="comment">//2.先对要提交给服务器的数据进行校验</span></span><br><span class="line">    <span class="keyword">if</span>(!validata_add_form())&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//3.判断之前的ajax用户名校验是否成功</span></span><br><span class="line">    <span class="keyword">if</span>($(<span class="keyword">this</span>).attr(<span class="string">"ajax-va"</span>)==<span class="string">"error"</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p><p>因为使用的是change事件，只有内容发生改变的时候，才会执行此校验，所以为了防止绕过该校验信息，就需要每次提交后都重置表单<br><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#emp_add_modal_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//清除数据，表单重置</span></span><br><span class="line">    $(<span class="string">"#empAddModal form"</span>)[<span class="number">0</span>].reset();</span><br></pre></td></tr></table></figure></p><p>这样一来，一个完整的前端校验就完成了</p><h3 id="前端校验"><a href="#前端校验" class="headerlink" title="前端校验"></a>前端校验</h3><p>依旧是用正则表达式<br>在EmployeeController中修改checkUser<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//检查用户名是否可用</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="meta">@RequestMapping(<span class="meta-string">"/checkUser"</span>)</span></span><br><span class="line">   <span class="keyword">public</span> Msg checkUser(<span class="meta">@RequestParam(<span class="meta-string">"empName"</span>)</span> String empName)&#123;</span><br><span class="line">       <span class="comment">//先判断用户名是否是合法的表达式;</span></span><br><span class="line">       String regx = <span class="string">"(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\\u2E80-\\u9FFF]&#123;2,5&#125;)"</span>;</span><br><span class="line">       <span class="keyword">if</span>(!empName.matches(regx))&#123;</span><br><span class="line">           <span class="keyword">return</span> Msg.fail().add(<span class="string">"va_msg"</span>,<span class="string">"用户名必须是6到16位数字和字母的组合或2-5位中文"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//数据库用户名重复校验</span></span><br><span class="line">       boolean b = employeeService.checkUser(empName);</span><br><span class="line">       <span class="keyword">if</span>(b)&#123;</span><br><span class="line">           <span class="keyword">return</span> Msg.success();</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">return</span> Msg.fail().add(<span class="string">"va_msg"</span>,<span class="string">"用户名不可用"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><br>同时修改index.jsp<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//校验用户名是否可用</span></span><br><span class="line">$(<span class="string">"#empName_add_input"</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//发送ajax请求校验用户名是否可用</span></span><br><span class="line">    <span class="keyword">var</span> empName = <span class="keyword">this</span>.value;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:<span class="string">"$&#123;APP_PATH&#125;/checkUser"</span>,</span><br><span class="line">        data:<span class="string">"empName="</span>+empName,</span><br><span class="line">        type:<span class="string">"POST"</span>,</span><br><span class="line">        success:<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(result.code == <span class="number">200</span>)&#123;</span><br><span class="line">                show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"success"</span>,<span class="string">"用户名可用"</span>);</span><br><span class="line">                $(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"success"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                show_validate_msg(<span class="string">"#empName_add_input"</span>,<span class="string">"error"</span>,result.extend.va_msg);</span><br><span class="line">                $(<span class="string">"#emp_save_btn"</span>).attr(<span class="string">"ajax-va"</span>,<span class="string">"error"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>同时还有一个问题，就是清楚掉表单的样式</p><p>抽取一个方法reset_form<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//清空表单样式及内容</span></span><br><span class="line"><span class="keyword">function</span> reset<span class="constructor">_form(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">    <span class="constructor">$(<span class="params">ele</span>)</span><span class="literal">[<span class="number">0</span>]</span>.reset<span class="literal">()</span>;</span><br><span class="line">    <span class="comment">//清空样式</span></span><br><span class="line">    <span class="constructor">$(<span class="params">ele</span>)</span>.find(<span class="string">"*"</span>).remove<span class="constructor">Class(<span class="string">"has-success has-error"</span>)</span>;</span><br><span class="line">    <span class="constructor">$(<span class="params">ele</span>)</span>.find(<span class="string">".help-block"</span>).text(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>弹出模态框的事件也要修改<br><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#emp_add_modal_btn"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//清除数据，表单重置</span></span><br><span class="line">    reset_form($(<span class="string">"#empAddModal form"</span>));</span><br></pre></td></tr></table></figure></p><p>当前的index.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 员工添加的模态框 --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@qq.com"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_add_input"</span> <span class="attr">value</span>=<span class="string">"M"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_add_input"</span> <span class="attr">value</span>=<span class="string">"F"</span>&gt;</span> 女</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                            部门提交部门id即可-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"dId"</span> <span class="attr">id</span>=<span class="string">"dept_add_select"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                                部门名称-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_save_btn"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_add_modal_btn"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    var totalRecords;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">    $(function ()&#123;</span></span><br><span class="line"><span class="xml">        //去首页</span></span><br><span class="line"><span class="xml">        to_page(1);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function to_page(pn) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">            data:"pn="+pn,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                build_page_info(result);</span></span><br><span class="line"><span class="xml">                //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                build_page_nav(result);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空table</span></span><br><span class="line"><span class="xml">        $("#emps_table tbody").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">        $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">            var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">            var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">            var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">            var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             编辑</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             删除</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">            $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                .append(empNameTd)</span></span><br><span class="line"><span class="xml">                .append(genderTd)</span></span><br><span class="line"><span class="xml">                .append(emailTd)</span></span><br><span class="line"><span class="xml">                .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                .append(btnTd)</span></span><br><span class="line"><span class="xml">                .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页信息</span></span><br><span class="line"><span class="xml">    function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">        //清空分页信息</span></span><br><span class="line"><span class="xml">        $("#page_info_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">        totalRecords = result.extend.pageInfo.total;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">    function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空</span></span><br><span class="line"><span class="xml">        $("#page_nav_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //page_nav_area</span></span><br><span class="line"><span class="xml">        var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span></span><br><span class="line"><span class="xml">            firstPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            prePageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            firstPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            prePageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum-1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">        var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasNextPage == false)&#123;</span></span><br><span class="line"><span class="xml">            nextPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            lastPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            nextPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum+1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            lastPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pages);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">        ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">        //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">        $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">            if(result.extend.pageInfo.pageNum == item)&#123;</span></span><br><span class="line"><span class="xml">                numLi.addClass("active");</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            numLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(item);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            ul.append(numLi);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">        ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">        var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">        navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //清空表单样式及内容</span></span><br><span class="line"><span class="xml">    function reset_form(ele)&#123;</span></span><br><span class="line"><span class="xml">        $(ele)[0].reset();</span></span><br><span class="line"><span class="xml">        //清空样式</span></span><br><span class="line"><span class="xml">        $(ele).find("*").removeClass("has-success has-error");</span></span><br><span class="line"><span class="xml">        $(ele).find(".help-block").text("");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击新增按钮弹出模态框</span></span><br><span class="line"><span class="xml">    $("#emp_add_modal_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //清除数据，表单重置</span></span><br><span class="line"><span class="xml">        reset_form($("#empAddModal form"));</span></span><br><span class="line"><span class="xml">        //发送ajax请求，查出部门信息，显示在下拉列表</span></span><br><span class="line"><span class="xml">        getDepts();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //弹出模态框</span></span><br><span class="line"><span class="xml">        $("#empAddModal").modal(&#123;</span></span><br><span class="line"><span class="xml">            backdrop:"static"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //查出所有的部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="xml">    function getDepts() &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">           url:"$&#123;APP_PATH&#125;/depts",</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                // console.log(result)</span></span><br><span class="line"><span class="xml">                //显示部门信息在下拉列表中</span></span><br><span class="line"><span class="xml">                // $("#dept_add_select").append("")</span></span><br><span class="line"><span class="xml">                $.each(result.extend.depts,function () &#123;</span></span><br><span class="line"><span class="xml">                    var optionEle = $("<span class="tag">&lt;<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span>").append(this.deptName).attr("value",this.deptId);</span></span><br><span class="line"><span class="xml">                    optionEle.appendTo("#dept_add_select")</span></span><br><span class="line"><span class="xml">                &#125;);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml">    //校验表单数据</span></span><br><span class="line"><span class="xml">    function validata_add_form()&#123;</span></span><br><span class="line"><span class="xml">        //1. 拿到要检验的数据，使用正则表达式</span></span><br><span class="line"><span class="xml">        var empName = $("#empName_add_input").val();</span></span><br><span class="line"><span class="xml">        var regName = /(^[a-zA-Z0-9_-]&#123;6,16&#125;$)|(^[\u2E80-\u9FFF]&#123;2,5&#125;)/;</span></span><br><span class="line"><span class="xml">        if(!regName.test(empName))&#123;</span></span><br><span class="line"><span class="xml">            // alert("用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line"><span class="xml">            //清空这个元素之前的样式</span></span><br><span class="line"><span class="xml">            show_validate_msg("#empName_add_input","error","用户名可以是2-5位中文或6-16位英文和数字的组合");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#empName_add_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //2. 校验邮箱信息</span></span><br><span class="line"><span class="xml">        var email = $("#email_add_input").val();</span></span><br><span class="line"><span class="xml">        var regEmaill = /^([a-zA-Z0-9_.-]+)@([da-z.-]+).([a-z.]&#123;2,6&#125;)$/ ;</span></span><br><span class="line"><span class="xml">        if(!regEmaill.test(email))&#123;</span></span><br><span class="line"><span class="xml">            // alert("邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_add_input","error","邮箱格式不正确");</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            show_validate_msg("#email_add_input","success","");</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        return true;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //显示校验信息</span></span><br><span class="line"><span class="xml">    function show_validate_msg(ele,status,msg)&#123;</span></span><br><span class="line"><span class="xml">        //清空这个元素之前的样式</span></span><br><span class="line"><span class="xml">        $(ele).parent().removeClass("has-success has-error");</span></span><br><span class="line"><span class="xml">        $(ele).next("span").text("");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        if(status == "success")&#123;</span></span><br><span class="line"><span class="xml">            $(ele).parent().addClass("has-success");</span></span><br><span class="line"><span class="xml">            $(ele).next("span").text(msg);</span></span><br><span class="line"><span class="xml">        &#125;else if(status == "error")&#123;</span></span><br><span class="line"><span class="xml">            $(ele).parent().addClass("has-error");</span></span><br><span class="line"><span class="xml">            $(ele).next("span").text(msg);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //校验用户名是否可用</span></span><br><span class="line"><span class="xml">    $("#empName_add_input").change(function () &#123;</span></span><br><span class="line"><span class="xml">        //发送ajax请求校验用户名是否可用</span></span><br><span class="line"><span class="xml">        var empName = this.value;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/checkUser",</span></span><br><span class="line"><span class="xml">            data:"empName="+empName,</span></span><br><span class="line"><span class="xml">            type:"POST",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                if(result.code == 200)&#123;</span></span><br><span class="line"><span class="xml">                    show_validate_msg("#empName_add_input","success","用户名可用");</span></span><br><span class="line"><span class="xml">                    $("#emp_save_btn").attr("ajax-va","success");</span></span><br><span class="line"><span class="xml">                &#125;else&#123;</span></span><br><span class="line"><span class="xml">                    show_validate_msg("#empName_add_input","error",result.extend.va_msg);</span></span><br><span class="line"><span class="xml">                    $("#emp_save_btn").attr("ajax-va","error");</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击保存，保存员工</span></span><br><span class="line"><span class="xml">    $("#emp_save_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //1.模态框中填写的表单数据提交给服务器进行保存</span></span><br><span class="line"><span class="xml">        //2.先对要提交给服务器的数据进行校验</span></span><br><span class="line"><span class="xml">        if(!validata_add_form())&#123;</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        //3.判断之前的ajax用户名校验是否成功</span></span><br><span class="line"><span class="xml">        if($(this).attr("ajax-va")=="error")&#123;</span></span><br><span class="line"><span class="xml">            return false;</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">        //4.发送ajax请求保存员工</span></span><br><span class="line"><span class="xml">        // alert($("#empAddModal form").serialize());</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emp",</span></span><br><span class="line"><span class="xml">            type:"POST",</span></span><br><span class="line"><span class="xml">            data:$("#empAddModal form").serialize(),</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                //alert(result.msg);</span></span><br><span class="line"><span class="xml">                //员工保存成功：</span></span><br><span class="line"><span class="xml">                //1. 关闭模态框</span></span><br><span class="line"><span class="xml">                $("#empAddModal").modal('hide');</span></span><br><span class="line"><span class="xml">                //2. 来到最后一页，显示刚才保存的数据</span></span><br><span class="line"><span class="xml">                //发送ajax请求显示最后一页数据即可</span></span><br><span class="line"><span class="xml">                //可以将总记录数当作页码</span></span><br><span class="line"><span class="xml">                to_page(totalRecords);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;保存&quot;&gt;&lt;a href=&quot;#保存&quot; class=&quot;headerlink&quot; title=&quot;保存&quot;&gt;&lt;/a&gt;保存&lt;/h1&gt;&lt;p&gt;URI：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;/emp/{id}   GET 查询员工&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;/emp    POS
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/10/12-员工管理系统-2</title>
    <link href="http://yoursite.com/2020/10/12/SSM-2020-10-12-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/10/12/SSM-2020-10-12-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-10-12T15:19:00.000Z</published>
    <updated>2021-02-21T04:57:58.414Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端页面"><a href="#前端页面" class="headerlink" title="前端页面"></a>前端页面</h1><p>根据前面的效果图做一个前端页面<br>list.jsp:<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span></span></span></span><br><span class="line"><span class="xml">    web路径：</span></span><br><span class="line"><span class="xml">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="xml">        以/开始的相对路径，找资源，以服务器的路径为标准（http://localhost:3306）需要加上项目名</span></span><br><span class="line"><span class="xml">            http://localhost:3306/crud</span></span><br><span class="line"><span class="xml">--%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">uri</span>=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> <span class="attr">prefix</span>=<span class="string">"c"</span>%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="xml">        pageContext.setAttribute("APP_PATH",request.getContextPath());</span></span><br><span class="line"><span class="xml">    %&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--标题--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--按钮--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--显示表格数据--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>qwe<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>男<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>aaa@qq.com<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                编辑</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                删除</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--显示分页信息--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>            分页文字信息<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                当前记录数：XXX</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>            分页条信息<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">"Page navigation"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">aria-label</span>=<span class="string">"Previous"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;laquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">aria-label</span>=<span class="string">"Next"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;raquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>末页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>这样基本的前端页面框架就出来，接下来就是填充数据就好了<br><img src="/img/JavaWeb/10-12学习日记/0.png" alt="avatar"></p><h1 id="实现分页查询"><a href="#实现分页查询" class="headerlink" title="实现分页查询"></a>实现分页查询</h1><p>接下来就是将数据解析填充到对应位置<br>list.jsp<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span></span></span></span><br><span class="line"><span class="xml">    web路径：</span></span><br><span class="line"><span class="xml">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="xml">        以/开始的相对路径，找资源，以服务器的路径为标准（http://localhost:3306）需要加上项目名</span></span><br><span class="line"><span class="xml">            http://localhost:3306/crud</span></span><br><span class="line"><span class="xml">--%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">uri</span>=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> <span class="attr">prefix</span>=<span class="string">"c"</span>%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="xml">        pageContext.setAttribute("APP_PATH",request.getContextPath());</span></span><br><span class="line"><span class="xml">    %&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--标题--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--按钮--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--显示表格数据--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.list&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">var</span>=<span class="string">"emp"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.empId&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.empName&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.gender=="M"?"男":"女"&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.email&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.department.deptName&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    编辑</span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    删除</span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--显示分页信息--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>            分页文字信息<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                当前记录数：$</span><span class="template-variable">&#123;pageInfo.pageNum&#125;</span><span class="xml">页，总$</span><span class="template-variable">&#123;pageInfo.pages&#125;</span><span class="xml">页,总$</span><span class="template-variable">&#123;pageInfo.total&#125;</span><span class="xml">条记录</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>            分页条信息<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">"Page navigation"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=1"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>                        有上一页再显示箭头，没有则不显示<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.hasPreviousPage&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageInfo.pageNum-1&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">aria-label</span>=<span class="string">"Previous"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;laquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>                        遍历显示页码，当前页码高亮<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.navigatepageNums&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">var</span>=<span class="string">"pageNumb"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageNumb == pageInfo.pageNum&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>$</span><span class="template-variable">&#123;pageNumb&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageNumb != pageInfo.pageNum&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageNumb&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>$</span><span class="template-variable">&#123;pageNumb&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>                        有下一页再显示箭头，没有则不显示<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.hasNextPage&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageInfo.pageNum+1&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">aria-label</span>=<span class="string">"Next"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;raquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageInfo.pages&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>末页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>这样就实现了预览图的效果啦</p><h1 id="控制器返回JSON数据"><a href="#控制器返回JSON数据" class="headerlink" title="控制器返回JSON数据"></a>控制器返回JSON数据</h1><p>目前我们这样写，只适用于浏览器与服务器，所以还需要考虑移动设备用户，就需要借助JSON</p><p>目前最好的解决方案就是服务器端去处理JSON数据，使用Ajax请求来完成</p><h2 id="查询-Ajax"><a href="#查询-Ajax" class="headerlink" title="查询-Ajax"></a>查询-Ajax</h2><ol><li><p>index.jsp页面直接发送ajax请求进行员工分页数据的查询</p></li><li><p>服务器将查出的数据，以json字符串的形式返回给浏览器</p></li><li><p>浏览器收到js字符串。可以使用js对json进行解析，使用js通过dom增删改的形式来改变页面</p></li><li><p>返回json。实现客户端的无关性</p></li></ol><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>首先要修改Controller<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 导入jackson包</span></span><br><span class="line"><span class="comment">    * @param pn</span></span><br><span class="line"><span class="comment">    * @return</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   @<span class="constructor">RequestMapping(<span class="string">"/emps"</span>)</span></span><br><span class="line">   @ResponseBody</span><br><span class="line">   public PageInfo get<span class="constructor">EmpsWithJson(@RequestParam(<span class="params">value</span> = <span class="string">"pn"</span>,<span class="params">defaultValue</span> = <span class="string">"1"</span>)</span>Integer pn)&#123;</span><br><span class="line">       <span class="comment">//这不是一个分页查询</span></span><br><span class="line">       <span class="comment">//引入PageHelper分页插件</span></span><br><span class="line">       <span class="comment">//在查询之前只需要调用,传入页码以及每页的个数</span></span><br><span class="line">       <span class="module-access"><span class="module"><span class="identifier">PageHelper</span>.</span></span>start<span class="constructor">Page(<span class="params">pn</span>,5)</span>;</span><br><span class="line">       <span class="comment">//startPage后面紧跟的这个查询就是一个分页查询</span></span><br><span class="line">       List&lt;Employee&gt; emps = employeeService.get<span class="constructor">All()</span>;</span><br><span class="line">       <span class="comment">//使用PageInfo包装查询后的结果，只需要将PageInfo交给页面就行了</span></span><br><span class="line">       <span class="comment">//封装了详细的分页信息，包括有我们查询出来的数据,连续显示的页数</span></span><br><span class="line">       PageInfo page= <span class="keyword">new</span> <span class="constructor">PageInfo(<span class="params">emps</span>,5)</span>;</span><br><span class="line">       return page;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><p>想要让ResponseBody实现，需要导入jackson包，在pom.xml中添加依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--   jason包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>再次访问之前的页面，就会发现已经变成了json字符串了</p><p>但是这样只返回page，用户不知道自己是否操作成功，所以我们写一个通用的返回类<br>在bean下新建一个Msg.class<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.crud.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通用的返回类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Msg</span> &#123;</span></span><br><span class="line">    <span class="comment">//状态码 200-成功  404-失败</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="comment">//提示信息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> msg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用户要返回给浏览器的数据</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;<span class="keyword">String</span>,Object&gt; extend=<span class="keyword">new</span> HashMap&lt;<span class="keyword">String</span>,Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Msg <span class="title">success</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Msg result=<span class="keyword">new</span> Msg();</span><br><span class="line">        result.setCode(<span class="number">200</span>);</span><br><span class="line">        result.setMsg(<span class="string">"处理成功!"</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Msg <span class="title">fail</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Msg result=<span class="keyword">new</span> Msg();</span><br><span class="line">        result.setCode(<span class="number">404</span>);</span><br><span class="line">        result.setMsg(<span class="string">"处理失败！"</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Msg <span class="title">add</span><span class="params">(<span class="keyword">String</span> key,Object value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getExtend().<span class="built_in">put</span>(key, value);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(<span class="keyword">int</span> code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(<span class="keyword">String</span> msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Map&lt;<span class="keyword">String</span>, Object&gt; getExtend() &#123;</span><br><span class="line">        <span class="keyword">return</span> extend;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setExtend</span><span class="params">(Map&lt;<span class="keyword">String</span>, Object&gt; extend)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.extend = extend;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>将Controller修改为<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="constructor">RequestMapping(<span class="string">"/emps"</span>)</span></span><br><span class="line">@ResponseBody</span><br><span class="line">public Msg get<span class="constructor">EmpsWithJson(@RequestParam(<span class="params">value</span> = <span class="string">"pn"</span>,<span class="params">defaultValue</span> = <span class="string">"1"</span>)</span>Integer pn)&#123;</span><br><span class="line">    <span class="comment">//这不是一个分页查询</span></span><br><span class="line">    <span class="comment">//引入PageHelper分页插件</span></span><br><span class="line">    <span class="comment">//在查询之前只需要调用,传入页码以及每页的个数</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">PageHelper</span>.</span></span>start<span class="constructor">Page(<span class="params">pn</span>,5)</span>;</span><br><span class="line">    <span class="comment">//startPage后面紧跟的这个查询就是一个分页查询</span></span><br><span class="line">    List&lt;Employee&gt; emps = employeeService.get<span class="constructor">All()</span>;</span><br><span class="line">    <span class="comment">//使用PageInfo包装查询后的结果，只需要将PageInfo交给页面就行了</span></span><br><span class="line">    <span class="comment">//封装了详细的分页信息，包括有我们查询出来的数据,连续显示的页数</span></span><br><span class="line">    PageInfo page= <span class="keyword">new</span> <span class="constructor">PageInfo(<span class="params">emps</span>,5)</span>;</span><br><span class="line">    return <span class="module-access"><span class="module"><span class="identifier">Msg</span>.</span></span>success<span class="literal">()</span>.add(<span class="string">"pageInfo"</span>,page);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这样一来有了状态码和文字的返回效果，用户就知道是否操作成功了</p><p>接下来就是用ajax，dom来完成CRUD了</p><p>新建一个index.jsp<br>将之前list.jsp的内容复制过来<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span></span></span></span><br><span class="line"><span class="xml">    web路径：</span></span><br><span class="line"><span class="xml">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="xml">        以/开始的相对路径，找资源，以服务器的路径为标准（http://localhost:3306）需要加上项目名</span></span><br><span class="line"><span class="xml">            http://localhost:3306/crud</span></span><br><span class="line"><span class="xml">--%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">uri</span>=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> <span class="attr">prefix</span>=<span class="string">"c"</span>%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="xml">        pageContext.setAttribute("APP_PATH",request.getContextPath());</span></span><br><span class="line"><span class="xml">    %&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--标题--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--按钮--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--显示表格数据--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.list&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">var</span>=<span class="string">"emp"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.empId&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.empName&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.gender=="M"?"男":"女"&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.email&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span>$</span><span class="template-variable">&#123;emp.department.deptName&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    编辑</span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    删除</span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%--显示分页信息--%</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>            分页文字信息<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                当前记录数：$</span><span class="template-variable">&#123;pageInfo.pageNum&#125;</span><span class="xml">页，总$</span><span class="template-variable">&#123;pageInfo.pages&#125;</span><span class="xml">页,总$</span><span class="template-variable">&#123;pageInfo.total&#125;</span><span class="xml">条记录</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>            分页条信息<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">"Page navigation"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=1"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>                        有上一页再显示箭头，没有则不显示<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.hasPreviousPage&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageInfo.pageNum-1&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">aria-label</span>=<span class="string">"Previous"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;laquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>                        遍历显示页码，当前页码高亮<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.navigatepageNums&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">var</span>=<span class="string">"pageNumb"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageNumb == pageInfo.pageNum&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>$</span><span class="template-variable">&#123;pageNumb&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageNumb != pageInfo.pageNum&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageNumb&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>$</span><span class="template-variable">&#123;pageNumb&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%--</span>                        有下一页再显示箭头，没有则不显示<span class="attr">--</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;pageInfo.hasNextPage&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageInfo.pageNum+1&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">aria-label</span>=<span class="string">"Next"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;raquo;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;APP_PATH&#125;</span><span class="xml"><span class="tag"><span class="string">/emps?pn=$</span></span></span><span class="template-variable">&#123;pageInfo.pages&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>末页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><h4 id="员工信息"><a href="#员工信息" class="headerlink" title="员工信息"></a>员工信息</h4><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    //员工数据等</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            当前：页，总 页,总 条记录</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">        $(function ()&#123;</span></span><br><span class="line"><span class="xml">           $.ajax(&#123;</span></span><br><span class="line"><span class="xml">               url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">               data:"pn=1",</span></span><br><span class="line"><span class="xml">               type:"GET",</span></span><br><span class="line"><span class="xml">               success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                   // console.log(result);</span></span><br><span class="line"><span class="xml">                   //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                   build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                   //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">               &#125;</span></span><br><span class="line"><span class="xml">           &#125;);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">            var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">            $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">                var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">                var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">                var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">                var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">                var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">                /**</span></span><br><span class="line"><span class="xml">                 * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 编辑</span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 */</span></span><br><span class="line"><span class="xml">                var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">                /**</span></span><br><span class="line"><span class="xml">                 * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 删除</span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 */</span></span><br><span class="line"><span class="xml">                var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                    .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">                var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">                //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">                $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                    .append(empNameTd)</span></span><br><span class="line"><span class="xml">                    .append(genderTd)</span></span><br><span class="line"><span class="xml">                    .append(emailTd)</span></span><br><span class="line"><span class="xml">                    .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                    .append(btnTd)</span></span><br><span class="line"><span class="xml">                    .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        function build_page_nav(result) &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="分页条及分页信息"><a href="#分页条及分页信息" class="headerlink" title="分页条及分页信息"></a>分页条及分页信息</h4><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">        $(function ()&#123;</span></span><br><span class="line"><span class="xml">           $.ajax(&#123;</span></span><br><span class="line"><span class="xml">               url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">               data:"pn=1",</span></span><br><span class="line"><span class="xml">               type:"GET",</span></span><br><span class="line"><span class="xml">               success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                   // console.log(result);</span></span><br><span class="line"><span class="xml">                   //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                   build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                   //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                   build_page_info(result);</span></span><br><span class="line"><span class="xml">                   //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                   build_page_nav(result);</span></span><br><span class="line"><span class="xml">               &#125;</span></span><br><span class="line"><span class="xml">           &#125;);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">            var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">            $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">                var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">                var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">                var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">                var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">                var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">                /**</span></span><br><span class="line"><span class="xml">                 * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 编辑</span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 */</span></span><br><span class="line"><span class="xml">                var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">                /**</span></span><br><span class="line"><span class="xml">                 * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 删除</span></span><br><span class="line"><span class="xml">                 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                 */</span></span><br><span class="line"><span class="xml">                var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                    .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">                var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">                //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">                $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                    .append(empNameTd)</span></span><br><span class="line"><span class="xml">                    .append(genderTd)</span></span><br><span class="line"><span class="xml">                    .append(emailTd)</span></span><br><span class="line"><span class="xml">                    .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                    .append(btnTd)</span></span><br><span class="line"><span class="xml">                    .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        //解析显示分页信息</span></span><br><span class="line"><span class="xml">        function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">            $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">                +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">                +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">        function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">            //page_nav_area</span></span><br><span class="line"><span class="xml">            var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"><span class="xml">            var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">            var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">            var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">            //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">            ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">            //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">            $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">                var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">                ul.append(numLi);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">            ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">            var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">            navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>这样就可以正常显示了，但是点击超链接并没有动作执行，接下来就需要编写动作了</p><h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><p>基本思路就是每点击一个超链接，就发送一次ajax请求,并且与之前的样式一样<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">    $(function ()&#123;</span></span><br><span class="line"><span class="xml">        //去首页</span></span><br><span class="line"><span class="xml">        to_page(1);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function to_page(pn) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">            data:"pn="+pn,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                build_page_info(result);</span></span><br><span class="line"><span class="xml">                //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                build_page_nav(result);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空table</span></span><br><span class="line"><span class="xml">        $("#emps_table tbody").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">        $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">            var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">            var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">            var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">            var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             编辑</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             删除</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">            $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                .append(empNameTd)</span></span><br><span class="line"><span class="xml">                .append(genderTd)</span></span><br><span class="line"><span class="xml">                .append(emailTd)</span></span><br><span class="line"><span class="xml">                .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                .append(btnTd)</span></span><br><span class="line"><span class="xml">                .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页信息</span></span><br><span class="line"><span class="xml">    function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">        //清空分页信息</span></span><br><span class="line"><span class="xml">        $("#page_info_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">    function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空</span></span><br><span class="line"><span class="xml">        $("#page_nav_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //page_nav_area</span></span><br><span class="line"><span class="xml">        var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span></span><br><span class="line"><span class="xml">            firstPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            prePageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            firstPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            prePageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum-1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">        var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasNextPage == false)&#123;</span></span><br><span class="line"><span class="xml">            nextPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            lastPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            nextPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum+1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            lastPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pages);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">        ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">        //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">        $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">            if(result.extend.pageInfo.pageNum == item)&#123;</span></span><br><span class="line"><span class="xml">                numLi.addClass("active");</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            numLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(item);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            ul.append(numLi);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">        ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">        var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">        navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>可以看到代码中有清空的操作，这是为了防止点击下一页的时候导致样式重叠</p><p>但是这样写当点击前一页或后一页时，到首页或末页，页码依旧会向后移动，这是不希望看到的，所以就需要利用pageHelper中的reasonable，来合理化<br>mybatis配置文件中修改<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- com.github.pagehelper为PageHelper类所在包名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            分页合理化--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"reasonable"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure><br>这样插件就自动帮我们完成了合理化操作</p><h1 id="新增功能"><a href="#新增功能" class="headerlink" title="新增功能"></a>新增功能</h1><ol><li><p>在index.jsp页面点击新增</p></li><li><p>弹出新增对话框</p></li><li><p>去数据库查询部门列表，显示在对话框中</p></li><li><p>用户输入数据完成保存</p></li></ol><p>打开bootstarp的 <a href="https://v3.bootcss.com/javascript/#modals" target="_blank" rel="noopener">JavaScript插件</a> 选择模态框</p><p>这里踩了个坑，竟然是bootstrap的引用顺序问题</p><p>修改为<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;link <span class="attribute">href</span>=<span class="string">"<span class="variable">$&#123;APP_PATH&#125;</span>/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attribute">rel</span>=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">    &lt;script <span class="attribute">src</span>=<span class="string">"<span class="variable">$&#123;APP_PATH&#125;</span>/static/js/jquery-3.5.1.min.js"</span> <span class="attribute">type</span>=<span class="string">"text/javascript"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script <span class="attribute">src</span>=<span class="string">"<span class="variable">$&#123;APP_PATH&#125;</span>/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><br>不然会导致模态框无法使用</p><p>接着参考 <a href="https://v3.bootcss.com/css/#forms-horizontal" target="_blank" rel="noopener">bootstrap表单</a> 的水平表单</p><p>复制到modal-body中<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-horizontal"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"inputEmail3"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-2 control-label"</span>&gt;<span class="type">Email</span>&lt;/label&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">      &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"email"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"inputEmail3"</span> placeholder=<span class="string">"Email"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"inputPassword3"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-2 control-label"</span>&gt;<span class="type">Password</span>&lt;/label&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">      &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"password"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"inputPassword3"</span> placeholder=<span class="string">"Password"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-offset-2 col-sm-10"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"checkbox"</span>&gt;</span><br><span class="line">        &lt;label&gt;</span><br><span class="line">          &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"checkbox"</span>&gt; <span class="type">Remember</span> me</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-offset-2 col-sm-10"</span>&gt;</span><br><span class="line">      &lt;button <span class="class"><span class="keyword">type</span></span>=<span class="string">"submit"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-default"</span>&gt;<span class="type">Sign</span> in&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></p><p>基本的模态框（未加数据库查找）<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 员工添加的模态框 --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@qq.com"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_add_input"</span> <span class="attr">value</span>=<span class="string">"M"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_add_input"</span> <span class="attr">value</span>=<span class="string">"F"</span>&gt;</span> 女</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                            部门提交部门id即可-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"dId"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">option</span>&gt;</span>1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">option</span>&gt;</span>2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_add_modal_btn"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">    $(function ()&#123;</span></span><br><span class="line"><span class="xml">        //去首页</span></span><br><span class="line"><span class="xml">        to_page(1);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function to_page(pn) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">            data:"pn="+pn,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                build_page_info(result);</span></span><br><span class="line"><span class="xml">                //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                build_page_nav(result);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空table</span></span><br><span class="line"><span class="xml">        $("#emps_table tbody").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">        $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">            var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">            var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">            var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">            var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             编辑</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             删除</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">            $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                .append(empNameTd)</span></span><br><span class="line"><span class="xml">                .append(genderTd)</span></span><br><span class="line"><span class="xml">                .append(emailTd)</span></span><br><span class="line"><span class="xml">                .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                .append(btnTd)</span></span><br><span class="line"><span class="xml">                .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页信息</span></span><br><span class="line"><span class="xml">    function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">        //清空分页信息</span></span><br><span class="line"><span class="xml">        $("#page_info_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">    function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空</span></span><br><span class="line"><span class="xml">        $("#page_nav_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //page_nav_area</span></span><br><span class="line"><span class="xml">        var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span></span><br><span class="line"><span class="xml">            firstPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            prePageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            firstPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            prePageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum-1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">        var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasNextPage == false)&#123;</span></span><br><span class="line"><span class="xml">            nextPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            lastPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            nextPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum+1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            lastPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pages);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">        ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">        //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">        $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">            if(result.extend.pageInfo.pageNum == item)&#123;</span></span><br><span class="line"><span class="xml">                numLi.addClass("active");</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            numLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(item);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            ul.append(numLi);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">        ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">        var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">        navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    $("#emp_add_modal_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        $("#empAddModal").modal(&#123;</span></span><br><span class="line"><span class="xml">            backdrop:"static"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>接下来就给下拉列表添加数据库查询并显示就好了<br>编写一个DepartmentController用于处理请求<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.crud.controller;</span><br><span class="line"></span><br><span class="line">import com.ceit.crud.bean.Department;</span><br><span class="line">import com.ceit.crud.bean.Msg;</span><br><span class="line">import com.ceit.crud.service.DepartmentService;</span><br><span class="line">import org.springframework.beans.factory.<span class="keyword">annotation</span>.<span class="title">Autowired</span>;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">RequestMapping</span>;</span><br><span class="line">import org.springframework.web.bind.<span class="keyword">annotation</span>.<span class="title">ResponseBody</span>;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 处理和部门有关的请求</span><br><span class="line"> *<span class="regexp">/</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">@Controller</span></span><br><span class="line"><span class="regexp">public class DepartmentController &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    @Autowired</span></span><br><span class="line"><span class="regexp">    private DepartmentService departmentService;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span>**</span><br><span class="line">     * 返回所有的部门信息</span><br><span class="line">     *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">    @RequestMapping("/depts</span><span class="string">")</span></span><br><span class="line"><span class="string">    @ResponseBody</span></span><br><span class="line"><span class="string">    public Msg getDepts()&#123;</span></span><br><span class="line"><span class="string">        //查出的所有部门信息</span></span><br><span class="line"><span class="string">        List&lt;Department&gt; list = departmentService.getDepts();</span></span><br><span class="line"><span class="string">        return Msg.success().add("</span>depts<span class="string">",list);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><br>还需要对应的Service<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.crud.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Department;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.dao.DepartmentMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.<span class="keyword">annotation</span>.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DepartmentService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DepartmentMapper departmentMapper;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Department&gt; getDepts()&#123;</span><br><span class="line">        List&lt;Department&gt; list = departmentMapper.selectByExample(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>接下来就是编写模态框的事件了<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"><span class="ruby">    web路径：</span></span><br><span class="line"><span class="ruby">        不以/开始的相对路径，找资源，以当前资源的路径为基准，经常容易出现问题</span></span><br><span class="line"><span class="ruby">        以/开始的相对路径，找资源，以服务器的路径为标准（<span class="symbol">http:</span>/<span class="regexp">/localhost:3306）需要加上项目名</span></span></span><br><span class="line"><span class="ruby">            <span class="symbol">http:</span>/<span class="regexp">/localhost:3306/crud</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>员工列表<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">        pageContext.setAttribute(<span class="string">"APP_PATH"</span>,request.getContextPath());</span></span><br><span class="line"><span class="ruby">    </span><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/js/jquery-3.5.1.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;APP_PATH&#125;/static/bootstrap-3.3.7-dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 员工添加的模态框 --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"empAddModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-label</span>=<span class="string">"Close"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>员工添加<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"empName_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"empName"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email_add_input"</span> <span class="attr">placeholder</span>=<span class="string">"email@qq.com"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender1_add_input"</span> <span class="attr">value</span>=<span class="string">"M"</span> <span class="attr">checked</span>=<span class="string">"checked"</span>&gt;</span> 男</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">id</span>=<span class="string">"gender2_add_input"</span> <span class="attr">value</span>=<span class="string">"F"</span>&gt;</span> 女</span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                            部门提交部门id即可-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"dId"</span> <span class="attr">id</span>=<span class="string">"dept_add_select"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                                部门名称-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-标题-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>SSM-CRUD<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-按钮-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4 col-md-offset-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">id</span>=<span class="string">"emp_add_modal_btn"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示表格数据-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover"</span> <span class="attr">id</span>=<span class="string">"emps_table"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>#<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>empName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>deptName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-                    员工数据等-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-显示分页信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页文字信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_info_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示页码等信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-6"</span> <span class="attr">id</span>=<span class="string">"page_nav_area"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-            显示分页条信息-</span><span class="xml"><span class="tag"><span class="attr">-</span>%&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    //1.页面加载完成以后，直接去发送一个ajax请求，要到分页数据</span></span><br><span class="line"><span class="xml">    $(function ()&#123;</span></span><br><span class="line"><span class="xml">        //去首页</span></span><br><span class="line"><span class="xml">        to_page(1);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    function to_page(pn) &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">            url:"$&#123;APP_PATH&#125;/emps",</span></span><br><span class="line"><span class="xml">            data:"pn="+pn,</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result)&#123;</span></span><br><span class="line"><span class="xml">                // console.log(result);</span></span><br><span class="line"><span class="xml">                //1.解析并显示员工数据</span></span><br><span class="line"><span class="xml">                build_emps_tables(result);</span></span><br><span class="line"><span class="xml">                //2.解析并显示分页信息</span></span><br><span class="line"><span class="xml">                build_page_info(result);</span></span><br><span class="line"><span class="xml">                //3.解析并显示分页条数据</span></span><br><span class="line"><span class="xml">                build_page_nav(result);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    function build_emps_tables(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空table</span></span><br><span class="line"><span class="xml">        $("#emps_table tbody").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        var emps=result.extend.pageInfo.list;</span></span><br><span class="line"><span class="xml">        $.each(emps,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var empIdTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empId);</span></span><br><span class="line"><span class="xml">            var empNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.empName);</span></span><br><span class="line"><span class="xml">            var genderTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.gender=='M'?"男":"女");</span></span><br><span class="line"><span class="xml">            var emailTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.email);</span></span><br><span class="line"><span class="xml">            var deptNameTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(item.department.deptName);</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-pencil"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             编辑</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var editBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-primary btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-pencil")).append("编辑");</span></span><br><span class="line"><span class="xml">            /**</span></span><br><span class="line"><span class="xml">             * <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-danger btn-sm"</span>&gt;</span></span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-trash"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">             删除</span></span><br><span class="line"><span class="xml">             <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">             */</span></span><br><span class="line"><span class="xml">            var delBtn = $("<span class="tag">&lt;<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span>").addClass("btn btn-danger btn-sm")</span></span><br><span class="line"><span class="xml">                .append($("<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>").addClass("glyphicon glyphicon-trash")).append("删除");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            var btnTd = $("<span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>").append(editBtn).append(" ").append(delBtn);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            //append方法执行完成之后还是返回原来的元素</span></span><br><span class="line"><span class="xml">            $("<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>").append(empIdTd)</span></span><br><span class="line"><span class="xml">                .append(empNameTd)</span></span><br><span class="line"><span class="xml">                .append(genderTd)</span></span><br><span class="line"><span class="xml">                .append(emailTd)</span></span><br><span class="line"><span class="xml">                .append(deptNameTd)</span></span><br><span class="line"><span class="xml">                .append(btnTd)</span></span><br><span class="line"><span class="xml">                .appendTo("#emps_table tbody")</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页信息</span></span><br><span class="line"><span class="xml">    function build_page_info(result)&#123;</span></span><br><span class="line"><span class="xml">        //清空分页信息</span></span><br><span class="line"><span class="xml">        $("#page_info_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        $("#page_info_area").append("当前"+result.extend.pageInfo.pageNum+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.pages+"页,总"</span></span><br><span class="line"><span class="xml">            +result.extend.pageInfo.total+"条记录");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    //解析显示分页条,点击分页要能去下一页等等....</span></span><br><span class="line"><span class="xml">    function build_page_nav(result) &#123;</span></span><br><span class="line"><span class="xml">        //清空</span></span><br><span class="line"><span class="xml">        $("#page_nav_area").empty();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //page_nav_area</span></span><br><span class="line"><span class="xml">        var ul = $("<span class="tag">&lt;<span class="name">ul</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span>").addClass("pagination");</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var firstPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("首页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        var prePageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;laquo;"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasPreviousPage == false)&#123;</span></span><br><span class="line"><span class="xml">            firstPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            prePageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            firstPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            prePageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum-1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //构建元素</span></span><br><span class="line"><span class="xml">        var nextPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("&amp;raquo;"));</span></span><br><span class="line"><span class="xml">        var lastPageLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append("末页").attr("href","#"));</span></span><br><span class="line"><span class="xml">        if(result.extend.pageInfo.hasNextPage == false)&#123;</span></span><br><span class="line"><span class="xml">            nextPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">            lastPageLi.addClass("disabled");</span></span><br><span class="line"><span class="xml">        &#125;else&#123;</span></span><br><span class="line"><span class="xml">            //为元素添加点击翻页的事件</span></span><br><span class="line"><span class="xml">            nextPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pageNum+1);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            lastPageLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(result.extend.pageInfo.pages);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //添加首页和前一页的提示</span></span><br><span class="line"><span class="xml">        ul.append(firstPageLi).append(prePageLi);</span></span><br><span class="line"><span class="xml">        //1,2,3....遍历给ul中添加页码提示</span></span><br><span class="line"><span class="xml">        $.each(result.extend.pageInfo.navigatepageNums,function (index,item) &#123;</span></span><br><span class="line"><span class="xml">            var numLi = $("<span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>").append($("<span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>").append(item));</span></span><br><span class="line"><span class="xml">            if(result.extend.pageInfo.pageNum == item)&#123;</span></span><br><span class="line"><span class="xml">                numLi.addClass("active");</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            numLi.click(function () &#123;</span></span><br><span class="line"><span class="xml">                to_page(item);</span></span><br><span class="line"><span class="xml">            &#125;);</span></span><br><span class="line"><span class="xml">            ul.append(numLi);</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">        //添加后一页和末页的提示</span></span><br><span class="line"><span class="xml">        ul.append(nextPageLi).append(lastPageLi);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //把ul加入到nav元素中</span></span><br><span class="line"><span class="xml">        var navEle = $("<span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span>").append(ul);</span></span><br><span class="line"><span class="xml">        navEle.appendTo("#page_nav_area");</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //点击新增按钮弹出模态框</span></span><br><span class="line"><span class="xml">    $("#emp_add_modal_btn").click(function () &#123;</span></span><br><span class="line"><span class="xml">        //发送ajax请求，查出部门信息，显示在下拉列表</span></span><br><span class="line"><span class="xml">        getDepts();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        //弹出模态框</span></span><br><span class="line"><span class="xml">        $("#empAddModal").modal(&#123;</span></span><br><span class="line"><span class="xml">            backdrop:"static"</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    //查出所有的部门信息并显示在下拉列表中</span></span><br><span class="line"><span class="xml">    function getDepts() &#123;</span></span><br><span class="line"><span class="xml">        $.ajax(&#123;</span></span><br><span class="line"><span class="xml">           url:"$&#123;APP_PATH&#125;/depts",</span></span><br><span class="line"><span class="xml">            type:"GET",</span></span><br><span class="line"><span class="xml">            success:function (result) &#123;</span></span><br><span class="line"><span class="xml">                // console.log(result)</span></span><br><span class="line"><span class="xml">                //显示部门信息在下拉列表中</span></span><br><span class="line"><span class="xml">                // $("#dept_add_select").append("")</span></span><br><span class="line"><span class="xml">                $.each(result.extend.depts,function () &#123;</span></span><br><span class="line"><span class="xml">                    var optionEle = $("<span class="tag">&lt;<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span>").append(this.deptName).attr("value",this.deptId);</span></span><br><span class="line"><span class="xml">                    optionEle.appendTo("#dept_add_select")</span></span><br><span class="line"><span class="xml">                &#125;);</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125;);</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>这样一个模态框的新建功能就做好了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端页面&quot;&gt;&lt;a href=&quot;#前端页面&quot; class=&quot;headerlink&quot; title=&quot;前端页面&quot;&gt;&lt;/a&gt;前端页面&lt;/h1&gt;&lt;p&gt;根据前面的效果图做一个前端页面&lt;br&gt;list.jsp:&lt;br&gt;&lt;figure class=&quot;highlight dust&quot;
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/10/5-员工管理系统-1</title>
    <link href="http://yoursite.com/2020/10/05/SSM-2020-10-5-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/10/05/SSM-2020-10-5-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-10-05T06:08:00.000Z</published>
    <updated>2021-02-21T04:58:00.409Z</updated>
    
    <content type="html"><![CDATA[<h1 id="功能一：查询员工数据"><a href="#功能一：查询员工数据" class="headerlink" title="功能一：查询员工数据"></a>功能一：查询员工数据</h1><ol><li><p>访问index.jsp页面</p></li><li><p>index.jsp页面发送出查询员工列表请求</p></li><li><p>EmployeeController来接受请求，查出员工数据</p></li><li><p>来到list.jsp页面进行展示</p></li></ol><ul><li>URI: /emps</li></ul><p>效果图：<br><img src="/img/JavaWeb/10-5学习日记/0.png" alt="avatar"></p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>首先分析一下，这个页面一页有5条数据，规定了URI为/emps，可以分页查询到所有数据</p><p>那么首先就在index.jsp中编写<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jsp:forward</span> <span class="attr">page</span>=<span class="string">"//emps"</span>&gt;</span><span class="tag">&lt;/<span class="name">jsp:forward</span>&gt;</span></span><br></pre></td></tr></table></figure><br>访问首页时就会转到/emps</p><p>跟随逻辑，index.jsp发送列表请求被Controller接受并查出员工数据</p><p>EmployeeController<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.crud.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理员工CRUD请求</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@<span class="type">Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    @<span class="type">Autowired</span></span><br><span class="line">    <span class="type">EmployeeService</span> employeeService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询员工数据(分页查询)</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    @<span class="type">RequestMapping</span>(<span class="string">"/emps"</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> getEmps(@<span class="type">RequestParam</span>(value = <span class="string">"pn"</span>,defaultValue = <span class="string">"1"</span>)<span class="type">Integer</span> pn, <span class="type">Model</span> model)&#123;</span><br><span class="line">        <span class="comment">//这不是一个分页查询</span></span><br><span class="line">        <span class="comment">//引入PageHelper分页插件</span></span><br><span class="line">        <span class="comment">//在查询之前只需要调用,传入页码以及每页的个数</span></span><br><span class="line">        <span class="type">PageHelper</span>.startPage(pn,<span class="number">5</span>);</span><br><span class="line">        <span class="comment">//startPage后面紧跟的这个查询就是一个分页查询</span></span><br><span class="line">        <span class="type">List</span>&lt;<span class="type">Employee</span>&gt; emps = employeeService.getAll();</span><br><span class="line">        <span class="comment">//使用PageInfo包装查询后的结果，只需要将PageInfo交给页面就行了</span></span><br><span class="line">        <span class="comment">//封装了详细的分页信息，包括有我们查询出来的数据,连续显示的页数</span></span><br><span class="line">        <span class="type">PageInfo</span> page= new <span class="type">PageInfo</span>(emps,<span class="number">5</span>);</span><br><span class="line">        model.addAttribute(<span class="string">"pageInfo"</span>,page);</span><br><span class="line">        page.getNavigatepageNums();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这里使用了PageHelper分页插件来进行分页，具体百度就行</p><p>pn就是页码，默认值为1</p><p>先暂时不放在页面上，所以对其进行一下单元测试</p><p>在test包下新建一个MvcTest<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">package com.ceit.crud.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mock.web.MockHttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.web.WebAppConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvcBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MvcResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.setup.MockMvcBuilders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.WebApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用Spring测试模块提供的测试请求功能，测试crud请求的正确性</span></span><br><span class="line"><span class="comment"> * Spring4测试的时候，需要servlet3的支持</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@<span class="type">RunWith</span>(<span class="type">SpringJUnit4ClassRunner</span><span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">WebAppConfiguration</span></span></span><br><span class="line"><span class="class">@<span class="title">ContextConfiguration</span>(<span class="title">locations</span>=</span>&#123;<span class="string">"classpath:applicationContext.xml"</span>,<span class="string">"file:src/main/webapp/WEB-INF/dispatcherServlet-servlet.xml"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MVCTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">//传入Springmvc的ioc</span></span><br><span class="line">    @<span class="type">Autowired</span></span><br><span class="line">    <span class="type">WebApplicationContext</span> context;</span><br><span class="line">    <span class="comment">//虚拟mvc请求，获取到处理结果</span></span><br><span class="line">    <span class="type">MockMvc</span> mockMvc;</span><br><span class="line"></span><br><span class="line">    @<span class="type">Before</span></span><br><span class="line">    <span class="keyword">public</span> void initMokcMvc()&#123;</span><br><span class="line">        mockMvc = <span class="type">MockMvcBuilders</span>.webAppContextSetup(context).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="type">Test</span></span><br><span class="line">    <span class="keyword">public</span> void testPage() <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">        <span class="comment">//模拟请求拿到返回值</span></span><br><span class="line">        <span class="type">MvcResult</span> result = mockMvc.perform(<span class="type">MockMvcRequestBuilders</span>.<span class="keyword">get</span>(<span class="string">"/emps"</span>).param(<span class="string">"pn"</span>, <span class="string">"5"</span>)).andReturn();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//请求成功以后，请求域中会有PageInfo,我们可以取出PageInfo进行验证</span></span><br><span class="line">        <span class="type">MockHttpServletRequest</span> request = result.getRequest();</span><br><span class="line">        <span class="type">PageInfo</span> pi = (<span class="type">PageInfo</span>) request.getAttribute(<span class="string">"pageInfo"</span>);</span><br><span class="line">        <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"当前页码："</span>+pi.getPageNum());</span><br><span class="line">        <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"总页码:"</span>+pi.getPages());</span><br><span class="line">        <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"总记录数"</span>+pi.getTotal());</span><br><span class="line">        <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"在页面需要连续显示的页码"</span>);</span><br><span class="line">        int[] nums = pi.getNavigatepageNums();</span><br><span class="line">        <span class="keyword">for</span>(int i:nums)&#123;</span><br><span class="line">            <span class="type">System</span>.out.<span class="built_in">print</span>(<span class="string">" "</span>+i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">System</span>.out.<span class="built_in">println</span>();</span><br><span class="line">        <span class="comment">//获取员工数据</span></span><br><span class="line">        <span class="type">List</span>&lt;<span class="type">Employee</span>&gt; list = pi.getList();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">Employee</span> employee : list)&#123;</span><br><span class="line">            <span class="type">System</span>.out.<span class="built_in">println</span>(<span class="string">"ID"</span>+employee.getEmpId()+<span class="string">"==&gt;Name"</span>+employee.getEmpName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这里踩了个坑，要注意的是pom.xml中的c3p0可能会因为版本问题报错，修改成<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">type</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><br>重启加载依赖即可</p><p>运行结果<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当前页码：5</span><br><span class="line"><span class="section">总页码:250</span></span><br><span class="line">总记录数1248</span><br><span class="line">在页面需要连续显示的页码</span><br><span class="line"> 3 4 5 6 7</span><br><span class="line">ID21==&gt;Namedffa319</span><br><span class="line">ID22==&gt;Name31b4020</span><br><span class="line">ID23==&gt;Name4fc7c21</span><br><span class="line">ID24==&gt;Name9b3c422</span><br><span class="line">ID25==&gt;Namef878c23</span><br></pre></td></tr></table></figure><br>这里看到当前页码，总页码，总记录数，需要连续显示的页码以及数据都已经能成功捕获到了，那么接下来只需要写页面进行展示即可</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;功能一：查询员工数据&quot;&gt;&lt;a href=&quot;#功能一：查询员工数据&quot; class=&quot;headerlink&quot; title=&quot;功能一：查询员工数据&quot;&gt;&lt;/a&gt;功能一：查询员工数据&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;访问index.jsp页面&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/9/21-Mybatis</title>
    <link href="http://yoursite.com/2020/09/21/SSM-2020-9-21-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/09/21/SSM-2020-9-21-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-09-21T11:14:51.000Z</published>
    <updated>2021-02-21T04:58:02.312Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Mybatis运行"><a href="#Mybatis运行" class="headerlink" title="Mybatis运行"></a>Mybatis运行</h1><p>首先运行一下MyBatis生成一下mapper文件<br>建一个java文件<br>MBGTest.java<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.crud.test;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.exception.InvalidConfigurationException;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.exception.XMLParserException;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MBGTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> void main(<span class="keyword">String</span>[] args) throws IOException, XMLParserException, InvalidConfigurationException, SQLException, InterruptedException &#123;</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; warnings = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;<span class="keyword">String</span>&gt;();</span><br><span class="line">        boolean overwrite = <span class="literal">true</span>;</span><br><span class="line">        File configFile = <span class="keyword">new</span> <span class="type">File</span>(<span class="string">"F:\\default\\SSM\\src\\main\\resources\\generatorConfig.xml"</span>);</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> <span class="type">ConfigurationParser</span>(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> <span class="type">DefaultShellCallback</span>(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> <span class="type">MyBatisGenerator</span>(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>注意要修改路径</p><p>运行之后，mapper和dao中就会出现两个文件</p><p>bean下也会出现相应的文件</p><h1 id="实现多表联合查询"><a href="#实现多表联合查询" class="headerlink" title="实现多表联合查询"></a>实现多表联合查询</h1><p>生成之后的文件以及查询方法，不太能满足我们的需要，所以需要进行一些更改，来满足通过部门信息就能查询出来，实现一个多表联合查询</p><p>在dao包下的EmployeeMapper.java中<br>添加上:<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; selectByExampleWithDept(<span class="name">EmployeeExample</span> example)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">Employee selectByPrimaryKeyWithDept(<span class="name">Integer</span> empId)<span class="comment">;</span></span><br></pre></td></tr></table></figure><br>并在bean包下的Emplotee.java员工信息中添加<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private Department  department<span class="comment">;</span></span><br></pre></td></tr></table></figure><br>并加上getter和setter</p><p>在EmployeeMapper.xml 添加sql标签<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;sql id=<span class="string">"WithDept_Column_List"</span>&gt;</span><br><span class="line">  e<span class="selector-class">.emp_id</span>, e<span class="selector-class">.emp_name</span>, e<span class="selector-class">.gender</span>, e<span class="selector-class">.email</span>, e<span class="selector-class">.d_id</span>, d<span class="selector-class">.dept_id</span>, d.dept_name</span><br><span class="line">&lt;/sql&gt;</span><br></pre></td></tr></table></figure></p><p>接着添加查询方法<br><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">select</span> id=<span class="string">"selectByExampleWithDept"</span> &gt;</span><br><span class="line"> <span class="keyword">select</span></span><br><span class="line">  &lt;<span class="keyword">if</span> test=<span class="string">"distinct"</span>&gt;</span><br><span class="line">    <span class="keyword">distinct</span></span><br><span class="line">  &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">  &lt;<span class="keyword">include</span> refid=<span class="string">"WithDept_Column_List"</span> /&gt;</span><br><span class="line">  <span class="keyword">from</span> tbl_emp <span class="built_in">e</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tbl_dept d <span class="keyword">ON</span> <span class="built_in">e</span>.<span class="symbol">`d_id`</span>=d.<span class="symbol">`dept_id`</span></span><br><span class="line">  &lt;<span class="keyword">if</span> test=<span class="string">"_parameter != null"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">include</span> refid=<span class="string">"Example_Where_Clause"</span> /&gt;</span><br><span class="line">  &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">  &lt;<span class="keyword">if</span> test=<span class="string">"orderByClause != null"</span>&gt;</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> $&#123;orderByClause&#125;</span><br><span class="line">  &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure></p><p>在EmployeeMapper.xml下添加resultMap<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap <span class="built_in">id</span>=<span class="string">"WithDeptResultMap"</span> type=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">id</span> column=<span class="string">"emp_id"</span> jdbcType=<span class="string">"INTEGER"</span> <span class="keyword">property</span>=<span class="string">"empId"</span> /&gt;</span><br><span class="line">  &lt;<span class="literal">result</span> column=<span class="string">"emp_name"</span> jdbcType=<span class="string">"VARCHAR"</span> <span class="keyword">property</span>=<span class="string">"empName"</span> /&gt;</span><br><span class="line">  &lt;<span class="literal">result</span> column=<span class="string">"gender"</span> jdbcType=<span class="string">"CHAR"</span> <span class="keyword">property</span>=<span class="string">"gender"</span> /&gt;</span><br><span class="line">  &lt;<span class="literal">result</span> column=<span class="string">"email"</span> jdbcType=<span class="string">"VARCHAR"</span> <span class="keyword">property</span>=<span class="string">"email"</span> /&gt;</span><br><span class="line">  &lt;<span class="literal">result</span> column=<span class="string">"d_id"</span> jdbcType=<span class="string">"INTEGER"</span> <span class="keyword">property</span>=<span class="string">"dId"</span> /&gt;</span><br><span class="line">  &lt;association <span class="keyword">property</span>=<span class="string">"department"</span> javaType=<span class="string">"com.ceit.crud.bean.Department"</span> &gt;</span><br><span class="line">      &lt;<span class="built_in">id</span> column=<span class="string">"dept_id"</span> <span class="keyword">property</span>=<span class="string">"deptId"</span> /&gt;</span><br><span class="line">      &lt;<span class="literal">result</span> column=<span class="string">"dept_name"</span> <span class="keyword">property</span>=<span class="string">"deptName"</span>/&gt;</span><br><span class="line">  &lt;/association&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br></pre></td></tr></table></figure></p><p>并修改selectByExampleWithDept为<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByExampleWithDept"</span> <span class="attr">resultMap</span>=<span class="string">"WithDeptResultMap"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  select</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"distinct"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    distinct</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"WithDept_Column_List"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  from tbl_emp e</span></span><br><span class="line"><span class="xml">  LEFT JOIN tbl_dept d ON e.`d_id`=d.`dept_id`</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"orderByClause != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    order by $</span><span class="template-variable">&#123;orderByClause&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>部门的查询就完成了</p><p>接着同理写一个主键的sql标签<br><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">select</span> id=<span class="string">"selectByPrimaryKeyWithDept"</span> resultMap=<span class="string">"WithDeptResultMap"</span>&gt;</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">  &lt;<span class="keyword">include</span> refid=<span class="string">"WithDept_Column_List"</span> /&gt;</span><br><span class="line">  <span class="keyword">from</span> tbl_emp <span class="built_in">e</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tbl_dept d <span class="keyword">ON</span> <span class="built_in">e</span>.<span class="symbol">`d_id`</span>=d.<span class="symbol">`dept_id`</span></span><br><span class="line">  <span class="keyword">where</span> emp_id = #&#123;empId,jdbcType=INTEGER&#125;</span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure></p><p>最终的EmployeeMapper.xml<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ceit.crud.dao.EmployeeMapper"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"emp_id"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"empId"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"emp_name"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"empName"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">jdbcType</span>=<span class="string">"CHAR"</span> <span class="attr">property</span>=<span class="string">"gender"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"email"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"d_id"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"dId"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"WithDeptResultMap"</span> <span class="attr">type</span>=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"emp_id"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"empId"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"emp_name"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"empName"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"gender"</span> <span class="attr">jdbcType</span>=<span class="string">"CHAR"</span> <span class="attr">property</span>=<span class="string">"gender"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"email"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"email"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"d_id"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"dId"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--    指定联合查询出的部门字段的封装--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"department"</span> <span class="attr">javaType</span>=<span class="string">"com.ceit.crud.bean.Department"</span> &gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"dept_id"</span> <span class="attr">property</span>=<span class="string">"deptId"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dept_name"</span> <span class="attr">property</span>=<span class="string">"deptName"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"Example_Where_Clause"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"oredCriteria"</span> <span class="attr">item</span>=<span class="string">"criteria"</span> <span class="attr">separator</span>=<span class="string">"or"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"criteria.valid"</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"("</span> <span class="attr">prefixOverrides</span>=<span class="string">"and"</span> <span class="attr">suffix</span>=<span class="string">")"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"criteria.criteria"</span> <span class="attr">item</span>=<span class="string">"criterion"</span>&gt;</span></span></span><br><span class="line"><span class="xml">              <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.noValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.singleValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span><span class="xml"> #</span><span class="template-variable">&#123;criterion.value&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.betweenValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span><span class="xml"> #</span><span class="template-variable">&#123;criterion.value&#125;</span><span class="xml"> and #</span><span class="template-variable">&#123;criterion.secondValue&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.listValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span></span><br><span class="line"><span class="xml">                  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">collection</span>=<span class="string">"criterion.value"</span> <span class="attr">item</span>=<span class="string">"listItem"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    #</span><span class="template-variable">&#123;listItem&#125;</span></span><br><span class="line"><span class="xml">                  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">              <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"Update_By_Example_Where_Clause"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"example.oredCriteria"</span> <span class="attr">item</span>=<span class="string">"criteria"</span> <span class="attr">separator</span>=<span class="string">"or"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"criteria.valid"</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"("</span> <span class="attr">prefixOverrides</span>=<span class="string">"and"</span> <span class="attr">suffix</span>=<span class="string">")"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"criteria.criteria"</span> <span class="attr">item</span>=<span class="string">"criterion"</span>&gt;</span></span></span><br><span class="line"><span class="xml">              <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.noValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.singleValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span><span class="xml"> #</span><span class="template-variable">&#123;criterion.value&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.betweenValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span><span class="xml"> #</span><span class="template-variable">&#123;criterion.value&#125;</span><span class="xml"> and #</span><span class="template-variable">&#123;criterion.secondValue&#125;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"criterion.listValue"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                  and $</span><span class="template-variable">&#123;criterion.condition&#125;</span></span><br><span class="line"><span class="xml">                  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">collection</span>=<span class="string">"criterion.value"</span> <span class="attr">item</span>=<span class="string">"listItem"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    #</span><span class="template-variable">&#123;listItem&#125;</span></span><br><span class="line"><span class="xml">                  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span></span><br><span class="line"><span class="xml">              <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"Base_Column_List"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    emp_id, emp_name, gender, email, d_id</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"WithDept_Column_List"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    e.emp_id, e.emp_name, e.gender, e.email, e.d_id, d.dept_id, d.dept_name</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--      List&lt;Employee&gt; selectByExampleWithDept(EmployeeExample example);</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    Employee selectByPrimaryKeyWithDept(Integer empId);</span></span><br><span class="line"><span class="xml">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--  查询员工同时带部门--&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByExampleWithDept"</span> <span class="attr">resultMap</span>=<span class="string">"WithDeptResultMap"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    select</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"distinct"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      distinct</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"WithDept_Column_List"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    from tbl_emp e</span></span><br><span class="line"><span class="xml">    LEFT JOIN tbl_dept d ON e.`d_id`=d.`dept_id`</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"orderByClause != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      order by $</span><span class="template-variable">&#123;orderByClause&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByPrimaryKeyWithDept"</span> <span class="attr">resultMap</span>=<span class="string">"WithDeptResultMap"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    select</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"WithDept_Column_List"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    from tbl_emp e</span></span><br><span class="line"><span class="xml">    LEFT JOIN tbl_dept d ON e.`d_id`=d.`dept_id`</span></span><br><span class="line"><span class="xml">    where emp_id = #</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 查询员工不带部门--&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByExample"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.EmployeeExample"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    select</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"distinct"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      distinct</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    from tbl_emp</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"orderByClause != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      order by $</span><span class="template-variable">&#123;orderByClause&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByPrimaryKey"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Integer"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    select </span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    from tbl_emp</span></span><br><span class="line"><span class="xml">    where emp_id = #</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteByPrimaryKey"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    delete from tbl_emp</span></span><br><span class="line"><span class="xml">    where emp_id = #</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteByExample"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.EmployeeExample"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    delete from tbl_emp</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insert"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    insert into tbl_emp (emp_id, emp_name, gender, </span></span><br><span class="line"><span class="xml">      email, d_id)</span></span><br><span class="line"><span class="xml">    values (#</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span><span class="xml">, #</span><span class="template-variable">&#123;empName,jdbcType=VARCHAR&#125;</span><span class="xml">, #</span><span class="template-variable">&#123;gender,jdbcType=CHAR&#125;</span><span class="xml">, </span></span><br><span class="line"><span class="xml">      #</span><span class="template-variable">&#123;email,jdbcType=VARCHAR&#125;</span><span class="xml">, #</span><span class="template-variable">&#123;dId,jdbcType=INTEGER&#125;</span><span class="xml">)</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertSelective"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    insert into tbl_emp</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"("</span> <span class="attr">suffix</span>=<span class="string">")"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        emp_id,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empName != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        emp_name,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        gender,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        email,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"dId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        d_id,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"values ("</span> <span class="attr">suffix</span>=<span class="string">")"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        #</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empName != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        #</span><span class="template-variable">&#123;empName,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        #</span><span class="template-variable">&#123;gender,jdbcType=CHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        #</span><span class="template-variable">&#123;email,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"dId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        #</span><span class="template-variable">&#123;dId,jdbcType=INTEGER&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"countByExample"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.EmployeeExample"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Long"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    select count(*) from tbl_emp</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateByExampleSelective"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    update tbl_emp</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"record.empId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        emp_id = #</span><span class="template-variable">&#123;record.empId,jdbcType=INTEGER&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"record.empName != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        emp_name = #</span><span class="template-variable">&#123;record.empName,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"record.gender != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        gender = #</span><span class="template-variable">&#123;record.gender,jdbcType=CHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"record.email != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        email = #</span><span class="template-variable">&#123;record.email,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"record.dId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        d_id = #</span><span class="template-variable">&#123;record.dId,jdbcType=INTEGER&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Update_By_Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateByExample"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    update tbl_emp</span></span><br><span class="line"><span class="xml">    set emp_id = #</span><span class="template-variable">&#123;record.empId,jdbcType=INTEGER&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      emp_name = #</span><span class="template-variable">&#123;record.empName,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      gender = #</span><span class="template-variable">&#123;record.gender,jdbcType=CHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      email = #</span><span class="template-variable">&#123;record.email,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      d_id = #</span><span class="template-variable">&#123;record.dId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"_parameter != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Update_By_Example_Where_Clause"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateByPrimaryKeySelective"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    update tbl_emp</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empName != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        emp_name = #</span><span class="template-variable">&#123;empName,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"gender != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        gender = #</span><span class="template-variable">&#123;gender,jdbcType=CHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        email = #</span><span class="template-variable">&#123;email,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"dId != null"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        d_id = #</span><span class="template-variable">&#123;dId,jdbcType=INTEGER&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span></span><br><span class="line"><span class="xml">    where emp_id = #</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateByPrimaryKey"</span> <span class="attr">parameterType</span>=<span class="string">"com.ceit.crud.bean.Employee"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    update tbl_emp</span></span><br><span class="line"><span class="xml">    set emp_name = #</span><span class="template-variable">&#123;empName,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      gender = #</span><span class="template-variable">&#123;gender,jdbcType=CHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      email = #</span><span class="template-variable">&#123;email,jdbcType=VARCHAR&#125;</span><span class="xml">,</span></span><br><span class="line"><span class="xml">      d_id = #</span><span class="template-variable">&#123;dId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">    where emp_id = #</span><span class="template-variable">&#123;empId,jdbcType=INTEGER&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><h2 id="测试过程"><a href="#测试过程" class="headerlink" title="测试过程"></a>测试过程</h2><p>接下来就创建一个MapperTest.java来简单测试一下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ceit.crud.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.Department;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.bean.DepartmentExample;</span><br><span class="line"><span class="keyword">import</span> com.ceit.crud.dao.DepartmentMapper;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试DepartmentMapper</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCRUD</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.创建SpringIOC容器</span></span><br><span class="line">        ApplicationContext ioc=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">        <span class="comment">//2.从容器中获取mapper</span></span><br><span class="line">        DepartmentMapper bean = ioc.getBean(DepartmentMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(bean);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.插入几个部门</span></span><br><span class="line">        bean.insertSelective(<span class="keyword">new</span> Department(<span class="keyword">null</span>,<span class="string">"开发部"</span>));</span><br><span class="line">        bean.insertSelective(<span class="keyword">new</span> Department(<span class="keyword">null</span>,<span class="string">"测试部"</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>运行完成后，查看数据库已经发生变化，插入成功</p><p>剩下的基本上就是基本操作了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Mybatis运行&quot;&gt;&lt;a href=&quot;#Mybatis运行&quot; class=&quot;headerlink&quot; title=&quot;Mybatis运行&quot;&gt;&lt;/a&gt;Mybatis运行&lt;/h1&gt;&lt;p&gt;首先运行一下MyBatis生成一下mapper文件&lt;br&gt;建一个java文件&lt;br&gt;
      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>SSM-2020/9/17-环境搭建</title>
    <link href="http://yoursite.com/2020/09/17/SSM-2020-9-17-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/09/17/SSM-2020-9-17-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-09-17T08:00:44.000Z</published>
    <updated>2021-02-21T04:58:04.225Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础环境搭建"><a href="#基础环境搭建" class="headerlink" title="基础环境搭建"></a>基础环境搭建</h1><ol><li><p>创建一个maven工程</p></li><li><p>引入项目依赖的jar包</p><ul><li>spring</li><li>springmvc</li><li>mybatis</li><li>数据库连接池，驱动包</li><li>其他(jstl,servlet-api,junit)</li></ul></li><li><p>引入bootstrap前端框架</p></li><li><p>编写ssm整合的关键配置文件</p><ul><li>web.xml,spring,springmvc,mybatis,使用mybatis的逆向工程生成对应的bean以及mapper</li></ul></li></ol><h2 id="jar包导入"><a href="#jar包导入" class="headerlink" title="jar包导入"></a>jar包导入</h2><p>在pom.xml文件中加载依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 引入项目依赖的jar包--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SpringMVC Spring Mybatis   --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--spring mvc--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--spring jdbc--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- spring面向切面编程--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--MyBatis--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--MyBatis整合Spring的适配包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--数据库连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--MySQL的驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--JSTL--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--servlet-api--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><br>注意：servlet-api服务器中是存在的，但是一般都写上该依赖，并且使用<code>&lt;scope&gt;provided&lt;/scope&gt;</code>这样在服务器中的时候，该jar包就会被自动剔除掉</p><h2 id="引入bootstarp"><a href="#引入bootstarp" class="headerlink" title="引入bootstarp"></a>引入bootstarp</h2><p>下载好bootstarp后，在webapp下创建一个文件夹名为static,并将解压好的bootstarp文件放进去<br><img src="/img/JavaWeb/9-17学习日记/0.png" alt="avatar"></p><p>引入bootstarp样式：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link <span class="attribute">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"</span> <span class="attribute">rel</span>=<span class="string">"stylesheet"</span>&gt;</span><br></pre></td></tr></table></figure><br>同时别忘了根据自己的目录结构修改地址</p><p>引入js文件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br>同样根据自己的目录结构修改地址</p><p>引入Jquery文件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br>由于bootstarp是基于Jquery的，所以必须引入，官网下载之后，根据目录修改地址</p><p><img src="/img/JavaWeb/9-17学习日记/1.png" alt="avatar"></p><p>在引入bootstarp后，可以很快速和很美观的做出一个页面，例如按钮<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-info"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><br><img src="/img/JavaWeb/9-17学习日记/2.png" alt="avatar"></p><p>就可以做出一个美观大气的按钮，更多具体样式可以参考bootstarp的全局样式文档<br><a href="https://v3.bootcss.com/css/" target="_blank" rel="noopener">https://v3.bootcss.com/css/</a></p><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><h3 id="web-xml文件"><a href="#web-xml文件" class="headerlink" title="web.xml文件"></a>web.xml文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Archetype Created Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--1.启动Spring的容器  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2.spring mvc的前端控制器，拦截所有请求--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--  3.字符编码过滤器  一定要放在所有过滤器之前--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 4.使用Rest风格的URI  将页面普通的POST请求转为指定的delete或put请求 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Springmvc配置文件"><a href="#Springmvc配置文件" class="headerlink" title="Springmvc配置文件"></a>Springmvc配置文件</h3><p>dispatcherServlet-servlet.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    SpringMVC的配置文件，包含网站跳转逻辑的控制，配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.ceit"</span> <span class="attr">use-default-filters</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  只扫描控制器      --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  配置视图解析器，方便页面返回      --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/views/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 两个标准配置   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 将springmvc不能处理的请求交给tomcat   --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 能支持springmvc更高级的一些功能，快捷的ajax...映射动态请求   --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="Spring配置文件"><a href="#Spring配置文件" class="headerlink" title="Spring配置文件"></a>Spring配置文件</h3><p>applicationContext.xml<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span></span><br><span class="line"><span class="xml">       xmlns:context="http://www.springframework.org/schema/context"</span></span><br><span class="line"><span class="xml">       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line"><span class="xml">       xmlns:aop="http://www.springframework.org/schema/aop"</span></span><br><span class="line"><span class="xml">       xmlns:tx="http://www.springframework.org/schema/tx"</span></span><br><span class="line"><span class="xml">       xmlns:p="http://www.springframework.org/schema/p"</span></span><br><span class="line"><span class="xml">       xsi:schemaLocation="</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/tx</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/tx/spring-tx.xsd</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/aop</span></span><br><span class="line"><span class="xml">                    http://www.springframework.org/schema/aop/spring-aop.xsd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.ceit"</span> &gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- Spring的配置文件，主要配置与业务逻辑有关的   --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--数据源，事务控制 ...--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:dbconfig.properties"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"pooleDataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span>  <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.jdbcUrl&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span>  <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.driverClass&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span>  <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.user&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;jdbc.password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 配置MyBatis的整合   --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"SqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- 指定mybatis全局配置文件的位置 --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"pooleDataSource"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--  指定mybatis.mapper文件位置      --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:mapper/*.xml"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="xml">    </span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 配置扫描器，将mybatis接口的实现加入到ioc容器中   --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span> &gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!--   扫描所有dao接口的实现，加入到ioc容器中     --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.ceit.crud.dao"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--  事务控制  --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span> &gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 控制住数据源   --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"pooleDataSource"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 开启基于注解的事务，使用xml配置形式的事务(必要主要的都是使用配置式)   --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- 切入点表达式--&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"txPoint"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.ceit.crud.service..*(..))"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- 配置事务增强   --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span>  <span class="attr">pointcut-ref</span>=<span class="string">"txPoint"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--  配置事务增强，事务如何切入  --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="comment">&lt;!--  所有方法都是事务方法  --&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="comment">&lt;!--   get开始的所有方法   --&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--  Spring配置文件的核心点(数据源，与mybatis的整合，事务控制)  --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br><img src="/img/JavaWeb/9-17学习日记/3.png" alt="avatar"></p><h3 id="MyBatis及逆向工程配置文件"><a href="#MyBatis及逆向工程配置文件" class="headerlink" title="MyBatis及逆向工程配置文件"></a>MyBatis及逆向工程配置文件</h3><p>首先配置mybatis-config.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.ceit.crud.bean"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>接着在maven中添加插件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  mybatis      --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">verbose</span>&gt;</span>true<span class="tag">&lt;/<span class="name">verbose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">id</span>&gt;</span>Generate MyBatis Artifacts<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>generate<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><br>还需要添加mybatis的依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mybatis generator   --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>接着创建generatorConfig.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class="line"><span class="meta">        PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span><br><span class="line"><span class="meta">        "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 数据库驱动:选择你的本地硬盘上面的数据库驱动包--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">classPathEntry</span> <span class="attr">location</span>=<span class="string">"C:\Users\songf\.m2\repository\mysql\mysql-connector-java\8.0.11\mysql-connector-java-8.0.11.jar"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressDate"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--数据库链接URL，用户名、密码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://localhost:3306/ssm_crud?useSSL=false&amp;amp;serverTimezone=UTC"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 生成模型的包名和位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.ceit.crud.bean"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 生成映射文件的包名和位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/resources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 生成DAO的包名和位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>=<span class="string">"com.ceit.crud.dao"</span> <span class="attr">targetProject</span>=<span class="string">"src/main/java"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 要生成的表 tableName是数据库中的表名或视图名 domainObjectName是实体类名--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;table tableName="dicom_file" domainObjectName="DicomFile" enableCountByExample="false" enableUpdateByExample="false" enableDeleteByExample="false" enableSelectByExample="false" selectByExampleQueryId="false"/&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"tbl_emp"</span> <span class="attr">domainObjectName</span>=<span class="string">"Employee"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"tbl_dept"</span> <span class="attr">domainObjectName</span>=<span class="string">"Department"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><br>刷新maven启动就行</p><p>注意：generatorConfig.xml在IDEA环境中必须放在resources中</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;基础环境搭建&quot;&gt;&lt;a href=&quot;#基础环境搭建&quot; class=&quot;headerlink&quot; title=&quot;基础环境搭建&quot;&gt;&lt;/a&gt;基础环境搭建&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;创建一个maven工程&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;引入项目依赖的jar包&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="日常学习" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="JavaWeb" scheme="http://yoursite.com/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/JavaWeb/"/>
    
    
      <category term="开发" scheme="http://yoursite.com/tags/%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
</feed>
